<?xml version="1.0" encoding="UTF-8"?>
<!-- This DocBook file was created by LyX 2.4.3
  See https://www.lyx.org/ for more information -->
<article xml:lang="en-US" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:xi="http://www.w3.org/2001/XInclude" version="5.2">
<title>The ipv6calc Homepage</title>
<address role='right-address'>pb at bieringer dot de</address>
<info><author><firstname>Peter</firstname><surname>Bieringer</surname><affiliation><address>pb at bieringer dot de</address></affiliation></author><revhistory><revision> <revnumber>12.0.1</revnumber> <date>2025-05-11</date> <authorinitials>PB</authorinitials></revision></revhistory></info><section>
<title>General</title>
<para>ipv6calc is a small utility written in programming language C to manipulate (not only) IPv6 addresses and is able to do other tricky things. Intentions were convering a given IPv6 address into compressed format, convering a given IPv6 address into the same format like shown in <emphasis>/proc/net/if_inet6 and (because it was not difficulty) migrating the Perl program <emphasis>ip6_int into. Now only one utility is needed to do a lot.</emphasis></emphasis></para>
<para>This utility was also used in the past to extend features on network-functions-ipv6 library, used by initscripts-ipv6.</para>
<para>Note: this tool got also its <link xlink:href="http://freecode.com/projects/ipv6calc/">freecode.com (former freshmeat, now also EOL) / ipv6calc</link> page (but this is not maintained by the author)</para>
<section>
<title>Latest version</title>
<para>Latest version since last update of this page is 4.3.1</para>
</section>
<section>
<title>Included programs</title>
<itemizedlist>
<listitem>
<para>&#8220;ipv6calc&#8221;: the main utility</para>
</listitem>
<listitem>
<para>&#8220;ipv6calcweb&#8221;: CGI wrapper for ipv6calc&#8217;s address information output</para>
</listitem>
<listitem>
<para>&#8220;ipv6logconv&#8221;: log converter (IPv4/IPv6)</para>
</listitem>
<listitem>
<para>&#8220;ipv6loganon&#8221;: log anonymizer (IPv4/IPv6)</para>
</listitem>
<listitem>
<para>&#8220;ipv6logstats&#8221;: log statistic generator (IPv4/IPv6)</para>
</listitem>
<listitem>
<para>&#8220;mod_ipv6calc&#8221;: Apache module</para>
</listitem>
</itemizedlist>
</section>
<section>
<title>Included databases</title>
<para>If not disabled during compiling of the tool, following databases are statically included, since version 0.95.0 internally mentioned as &#8220;BuiltIn&#8221;:</para>
<itemizedlist>
<listitem>
<para>IEEE IAB, OUI, OUI-28, OUI-36 databases (for decoding vendor part of MAC/EUI-48/EUI-64)</para>
</listitem>
<listitem>
<para>IPv4 assignment databases from IANA, ARIN, RIPENCC, APNIC, LACNIC, AFRINIC (for selecting proper registry in ipv6calcweb.cgi and IPv4 anonymization)</para>
</listitem>
<listitem>
<para>IPv6 assignment databases from IANA, ARIN, RIPENCC, APNIC, LACNIC, AFRINIC (for selecting proper registry in ipv6calcweb.cgi and IPv6 anonymization)</para>
</listitem>
<listitem>
<para>ASN assignment databases from IANA, ARIN, RIPENCC, APNIC, LACNIC, AFRINIC (for IPv4/IPv6 anonymization)</para>
</listitem>
<listitem>
<para>LISP assignment database for supplying extra info</para>
</listitem>
</itemizedlist>
</section>
<section>
<title>Possible external databases</title>
<para>If enabled during compiling the tool, following external (but local stored) databases can be used</para>
<itemizedlist>
<listitem>
<para><link xlink:href="http://www.maxmind.com/">GeoIP</link>
</para>
<itemizedlist>
<listitem>
<para>IPv4 &#8220;legacy&#8221; (since 0.61.0, released 2006 until 3.0.0 released 2020)</para>
</listitem>
<listitem>
<para>IPv6 &#8220;legacy&#8221; (since 0.90.0, released 2011, req. GeoIP &gt;= 1.4.5 until 3.0.0 released 2020)</para>
</listitem>
<listitem>
<para>GeoIP2 (native MaxMindDB file support since 2.0.0, release 2019)</para>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<para><link xlink:href="http://www.ip2location.com/">IP2Location</link>
</para>
<itemizedlist>
<listitem>
<para>IPv4 (since 0.60.0, released 2006)</para>
</listitem>
<listitem>
<para>IPv6 (since 0.70.0, released 2007, <link xlink:href="http://lite.ip2location.com/">IP2Location LITE IPv6 Databases</link> since 0.99.0, released 2015)</para>
</listitem>
<listitem>
<para>release 0.99.0 is tested against IP2Location &gt;= 4.0.2</para>
</listitem>
<listitem>
<para>release &gt;= 2.0.0 &amp;&amp; &lt; 3.0.0 is only working with IP2Location &gt;= 7.0.1</para>
</listitem>
<listitem>
<para>release &gt;= 3.0.0 is only working with IP2Location &gt;= 8.2.0</para>
</listitem>
<listitem>
<para>native MaxMindDB files (support since 4.3.0, released 2025)</para>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<para><link xlink:href="http://www.db-ip.com/">DB-IP.com</link></para>
<itemizedlist>
<listitem>
<para>(since 0.98.0, released 2015 until 3.0.0 released 2020) based on local Berkeley DB files generated from downloaded CSV files</para>
</listitem>
<listitem>
<para>native MaxMindDB files (support since 2.0.0, released 2019)</para>
</listitem>
<listitem>
<para>MaxMindDB file &#8220;IP to ASN-Lite&#8221; (support since 4.3.1, released 2025)</para>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<para>&#8220;External&#8221; (since 0.98.0, released 2015), based on local Berkeley DB files, generated from downloaded TXT/XML files (registries assignment databases). Supporting IPv4/IPv6 to Registries and IPv4/IPv6 to CountryCode. If newer, overruling the related included databases.</para>
</listitem>
</itemizedlist>
<para>Since version 0.95.0 the tool can be compiled to use dynamically loading of library, means the binaries can be also used on systems where IP2Location or GeoIP libraries are not existing. On such system, the support is simply disabled then and some capabilities/features which requires the databases are disabled.</para>
<para>Since version 0.97.4 also fallback code for GeoIP and IP2Location is included in the source package, means that support of dynamically loading of library can be included during compilation without having related development sources on the system.</para>
<para>Since version 2.0.0 MaxMindDB is supported (linked or dynamically loaded)</para>
<para>Since version 3.0.0 GeoIP(legacy) and db-ip.com(BerkeleyDB) is removed</para>
</section>
</section>
<section>
<title>License</title>
<para>The program is published under the GNU GPL version 2.</para>
</section>
<section>
<title>Copyright</title>
<para>(C) 2001 - 2024 by Dr. Peter Bieringer</para>
</section>
<section>
<title>Author</title>
<para>The author of ipv6calc is</para>
<itemizedlist>
<listitem>
<para><link xlink:href="mailto:pb@bieringer.de">Dr. Peter Bieringer</link> with some minor contribution by others</para>
</listitem>
</itemizedlist>
</section>
<section>
<title>Where to get sources or binaries</title>
<section>
<title>Latest version of sources</title>
<itemizedlist>
<listitem>
<para>Via GitHub (since 2016-09-05) at <link xlink:href="https://github.com/pbiering/ipv6calc">GitHub / ipv6calc</link></para>
</listitem>
</itemizedlist>
</section>
<section>
<title>Releases</title>
<section>
<title>as tar.gz or zip</title>
<itemizedlist>
<listitem>
<para>via HTTPS at <link xlink:href="https://github.com/pbiering/ipv6calc/releases">GitHub / ipv6calc / releases</link> </para>
</listitem>
</itemizedlist>
</section>
<section>
<title>as tar.gz (signed)</title>
<itemizedlist>
<listitem>
<para>from <link xlink:href="http://www.deepspace6.net/">DeepSpace6</link> via FTP <link xlink:href="ftp://ftp.deepspace6.net/pub/ds6/sources/ipv6calc/">DeepSpace6 / anonymous FTP</link> or HTTP <link xlink:href="http://www.deepspace6.net/ftp/pub/ds6/sources/ipv6calc/">www.deepspace6.net mapped FTP</link></para>
</listitem>
<listitem>
<para>via <link xlink:href="ftp://ftp.bieringer.de/pub/linux/IPv6/ipv6calc/">ftp.bieringer.de / anonymous FTP</link> or HTTP at <link xlink:href="http://www.bieringer.de/ftp/pub/linux/IPv6/ipv6calc/">www.bieringer.de mapped FTP</link></para>
</listitem>
</itemizedlist>
<para>Since version 0.95.0 packages are signed with new GPG key, also available here: <link xlink:href="ftp://ftp.bieringer.de/pub/linux/IPv6/ipv6calc/CODE-GPG-KEY-bieringer.de-2013">CODE-GPG-KEY-bieringer.de-2013 @ftp.bieringer.de</link> or <link xlink:href="ftp://ftp.deepspace6.net/pub/ds6/sources/ipv6calc/CODE-GPG-KEY-bieringer.de-2013">CODE-GPG-KEY-bieringer.de-2013 @ftp.deepspace6.net</link></para>
<programlisting language='lyx'>Key fingerprint: AAB3 8CB7 97C7 50C7 78C6 08C6 DDEB 141D F738 0F61</programlisting>
<programlisting language='lyx'>uid: Peter Bieringer (Code Signing Key 2013) &lt;code@bieringer.de&gt;</programlisting>
<para>A SPEC file is included, so you can build a RPM from tar.gz using</para>
<programlisting language='lyx'>$ rpmbuild -ta path/to/ipv6calc-$version.tar.gz</programlisting>
<para>In addition, conditional build options are available (see related configure options below):</para>
<programlisting language='lyx'>--without ip2location</programlisting>
<programlisting language='lyx'>--without mmdb (which disables GeoIP v2 and db-ip.com v2)</programlisting>
<programlisting language='lyx'>--without external</programlisting>
<programlisting language='lyx'>--without shared</programlisting>
<programlisting language='lyx'>--without mod_ipv6calc</programlisting>
</section>
<section>
<title>as RPM</title>
<para>Can be searched via <link xlink:href="http://www.rpmfind.net/linux/rpm2html/search.php?query=ipv6calc">rpmfind / ipv6calc</link>.</para>
</section>
</section>
<section>
<title>Ready to use packages for several operating systems:</title>
<section>
<title>Fedora Linux</title>
<para>Fedora 29 is the current developing platform, so use given hints above to create a RPM. Since Fedora 7 this package is included by default.</para>
<para>See also <link xlink:href="https://src.fedoraproject.org/rpms/ipv6calc">FedoraProject / Packages / ipv6calc</link></para>
</section>
<section>
<title>Red Hat Enterprise Linux and clones</title>
<para>It&#8217;s tested by the developer that creation of the RPM is working fine starting with RHEL 4.</para>
<itemizedlist>
<listitem>
<para>Major version 5 has the package included by default (but a rather old version)
</para>
<itemizedlist>
<listitem>
<para>RPMs of newer releases are available as test builds on koji, see related URL in announcements <link xlink:href="https://lists.deepspace6.net/pipermail/ipv6calc-announce/">ipv6calc-announce / list archive</link></para>
</listitem>
<listitem>
<para>*** Untested since version 2.0.0 because OS is out of support ***</para>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<para>Major version 6: available since September 2014 on <link xlink:href="https://fedoraproject.org/wiki/EPEL">FedoraProject / EPEL</link>, see also <link xlink:href="https://src.fedoraproject.org/rpms/ipv6calc">FedoraProject / Packages / ipv6calc</link></para>
<itemizedlist>
<listitem>
<para>*** Untested since version 3.0.1 because OS is out of support ***</para>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<para>Major version 7: available since Decenber 2016 on <link xlink:href="https://fedoraproject.org/wiki/EPEL">FedoraProject / EPEL</link>, see also <link xlink:href="https://src.fedoraproject.org/rpms/ipv6calc">FedoraProject / Packages / ipv6calc</link></para>
<itemizedlist>
<listitem>
<para>*** Untested since version 4.2.1 because OS is out of support ***</para>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<para>Major version 8: available since September 2019 on <link xlink:href="https://fedoraproject.org/wiki/EPEL">FedoraProject / EPEL</link>, see also <link xlink:href="https://src.fedoraproject.org/rpms/ipv6calc">FedoraProject / Packages / ipv6calc</link></para>
</listitem>
<listitem>
<para>Major version 9: available since December 2021 on <link xlink:href="https://fedoraproject.org/wiki/EPEL">FedoraProject / EPEL</link>, see also <link xlink:href="https://src.fedoraproject.org/rpms/ipv6calc">FedoraProject / Packages / ipv6calc</link></para>
</listitem>
<listitem>
<para>Major version 10: available since January 2025 on <link xlink:href="https://fedoraproject.org/wiki/EPEL">FedoraProject / EPEL</link>, see also <link xlink:href="https://src.fedoraproject.org/rpms/ipv6calc">FedoraProject / Packages / ipv6calc</link></para>
</listitem>
</itemizedlist>
<para>AlmaLinux 8+9+10 are also platforms for regression tests.</para>
</section>
<section>
<title>Gentoo/Funtoo</title>
<para>Package is maintained, nevertheless, Funtoo is used as platform for regression tests.</para>
</section>
<section>
<title>Ubuntu</title>
<para>Package is maintained, more information can be found at <link xlink:href="https://packages.ubuntu.com/ipv6calc">https://packages.ubuntu.com/ipv6calc</link></para>
</section>
<section>
<title>Debian GNU/Linux</title>
<para>Package is maintained, more information can be found at <link xlink:href="http://packages.debian.org/ipv6calc">http://packages.debian.org/ipv6calc</link></para>
</section>
<section>
<title>openSUSE</title>
<para>Package is maintained, more information can be found at <link xlink:href="http://download.opensuse.org/repositories/home:/uebelhacker/">http://download.opensuse.org/repositories/home:/uebelhacker/</link></para>
</section>
<section>
<title>NetBSD</title>
<para>See here for more: <link xlink:href="ftp://ftp.netbsd.org/pub/pkgsrc/current/pkgsrc/net/ipv6calc/README.html">ftp://ftp.netbsd.org/pub/pkgsrc/current/pkgsrc/net/ipv6calc/README.html</link></para>
</section>
<section>
<title>FreeBSD</title>
<para>See here for more: <link xlink:href="http://www.freshports.org/net-mgmt/ipv6calc/">http://www.freshports.org/net-mgmt/ipv6calc/</link> (<link xlink:href="http://www.freebsd.org/cgi/query-pr.cgi?pr=34441">http://www.freebsd.org/cgi/query-pr.cgi?pr=34441</link>)</para>
</section>
<section>
<title>OpenBSD</title>
<para>See here for more: <link xlink:href="http://www.openbsd.org/cgi-bin/cvsweb/ports/net/ipv6calc/">http://www.openbsd.org/cgi-bin/cvsweb/ports/net/ipv6calc/</link></para>
</section>
</section>
</section>
<section>
<title>Configuring &amp; Compiling</title>
<section>
<title>Configuring</title>
<para>Following &#8220;ipc6calc&#8221; related configure options are currently supported (note: disabling the internal databases reduces the size of the resulting binaries/shared library a lot):</para>
<programlisting language='lyx'>--disable-dynamic-load  Disable dynamic load of libraries (default: enabled)</programlisting>
<programlisting language='lyx'>--disable-db-ieee        Disable build-in IEEE database (default: enabled)</programlisting>
<programlisting language='lyx'>--disable-db-ipv4        Disable build-in IPv4 database (default: enabled)</programlisting>
<programlisting language='lyx'>--disable-db-ipv6        Disable build-in IPv6 database (default: enabled)</programlisting>
<programlisting language='lyx'>--disable-db-as-registry Disable built-in AS-to-Registry database (default: enabled)</programlisting>
<programlisting language='lyx'>--disable-db-cc-registry Disable built-in CountryCode-to-Registry database (default: enabled) </programlisting>
<programlisting language='lyx'>--disable-geoip2         Disable MaxMindDB support for GeoIP (default: enabled)</programlisting>
<programlisting language='lyx'>--disable-dbip2          Disable MaxMindDB support for db-ip.com (default: enabled) </programlisting>
<programlisting language='lyx'>--disable-ip2location2   Disable MaxMindDB support for IP2Location (default: enabled) </programlisting>
<programlisting language='lyx'>--enable-mmdb            Enable MaxMindDB support (GeoIP/db-ip.com) (default: disabled) </programlisting>
<programlisting language='lyx'>--enable-external        Enable external db support (default: disabled) </programlisting>
<programlisting language='lyx'>--enable-ip2location     Enable IP2Location support (default: disabled)</programlisting>
<programlisting language='lyx'>--enable-mod_ipv6calc    Enable build of mod_ipv6calc for Apache (default: disabled) </programlisting>
<programlisting language='lyx'>--with-mmdb-dynamic     Enable use of dynamic loading of MaxMindDB library (default=no)</programlisting>
<programlisting language='lyx'>--with-mmdb-headers=DIR MaxMindDB include files location</programlisting>
<programlisting language='lyx'>--with-mmdb-lib=DIR     MaxMindDB library location</programlisting>
<programlisting language='lyx'>--with-mmdb-dyn-lib=NAME Use specified MaxMindDB dynamic library, default: libmaxminddb.so.0 </programlisting>
<programlisting language='lyx'>--with-ip2location-headers=DIR      IP2Location include files location</programlisting>
<programlisting language='lyx'>--with-ip2location-headers-fallback IP2Location include files from internal fallback location (only usable with dynamic load option)                          </programlisting>
<programlisting language='lyx'>--with-ip2location-lib=FILE         IP2Location library location</programlisting>
<programlisting language='lyx'>--with-ip2location-static           Explicitly link IP2Location statically (default=no)</programlisting>
<programlisting language='lyx'>--with-ip2location-dynamic          Enable use of dynamic loading of IP2Location library (default=no)</programlisting>
<programlisting language='lyx'>--with-ip2location-db=DIR           Use specified IP2Location database directory, default: /usr/share/IP2Location</programlisting>
<programlisting language='lyx'>--with-ip2location-dyn-lib=NAME     Use specified IP2Location dynamic library, default: libIP2Location.so</programlisting>
<programlisting language='lyx'>--with-geoip-db=DIR             Use specified GeoIP database directory, default: /usr/share/GeoIP</programlisting>
<programlisting language='lyx'>--with-dbip-db=DIR      Use specified db-ip.com database directory, default: /usr/share/DBIP</programlisting>
<programlisting language='lyx'>--with-external-db=DIR  Use specified external database directory, default: /usr/share/ipv6calc/db </programlisting>
<programlisting language='lyx'>--with-apxs=NAME        name of the apxs executable (apxs) </programlisting>
<programlisting language='lyx'>--enable-shared                 Enable shared library build (default: disabled)</programlisting>
<programlisting language='lyx'>--enable-bundled-getopt         Enable bundled getopt library (default: autoselected)</programlisting>
<programlisting language='lyx'>--enable-bundled-md5            Enable bundled MD5 library (default: autoselected)</programlisting>
<programlisting language='lyx'>--enable-libmd-md5              Enforce use of libmd MD5 implementation (default: autoselected)</programlisting>
<programlisting language='lyx'>--enable-openssl-evp-md5        Enforce use of OpenSSL EVP MD5 implementation (default: autoselected)</programlisting>
<programlisting language='lyx'>--enable-openssl-md5            Enforce use of OpenSSL legacy MD5 implementation (default: autoselected) </programlisting>
</section>
<section>
<title>Compiling</title>
<para>As usual, use</para>
<programlisting language='lyx'>$ make</programlisting>
<para>and run tests afterwards using</para>
<programlisting language='lyx'>$ make test</programlisting>
<para>or at least (e.g. if external databases are not available)</para>
<programlisting language='lyx'>$ make test-minimal</programlisting>
</section>
<section>
<title>Configuring &amp; Compiling with Presets</title>
<para>A shell script is included which can configure and compile with standard presets (also used during regression tests):</para>
<programlisting language='lyx'>$ ./autogen.sh -h</programlisting>
<programlisting language='lyx'>Supported options:</programlisting>
<programlisting language='lyx'>   -?|-h|--help          : this help</programlisting>
<programlisting language='lyx'>   -n|--no-make          : stop before running 'make'</programlisting>
<programlisting language='lyx'>   -a|--all              : enable GeoIP/IP2Location/db-ip.com/External/mod_ipv6calc support</programlisting>
<programlisting language='lyx'>   -A|--ALL              : enable GeoIP/IP2Location/db-ip.com/External/mod_ipv6calc support with dynamic library support</programlisting>
<programlisting language='lyx'>   -m|--mmdb             : enable MaxMindDB support (GeoIP/db-ip.com)</programlisting>
<programlisting language='lyx'>   --mmdb-dyn|-M         : switch to dynamic library loading of MaxMindDB</programlisting>
<programlisting language='lyx'>   --disable-geoip2      : disable MaxMindDB support for GeoIP</programlisting>
<programlisting language='lyx'>   --disable-dbip2       : disable MaxMindDB support for db-ip.com</programlisting>
<programlisting language='lyx'>   --disable-ip2location2: disable MaxMindDB support for IP2Location</programlisting>
<programlisting language='lyx'>   -i|--ip2location      : enable IP2Location support</programlisting>
<programlisting language='lyx'>   --ip2location-dyn|-I  : switch to dynamic library loading of IP2Location</programlisting>
<programlisting language='lyx'>   -e|--external         : enable external database support</programlisting>
<programlisting language='lyx'>   --disable-db-ieee     : disable built-in IEEE database</programlisting>
<programlisting language='lyx'>   --disable-db-ipv4     : disable built-in IPv4 database</programlisting>
<programlisting language='lyx'>   --disable-db-ipv6     : disable built-in IPv6 database</programlisting>
<programlisting language='lyx'>   --disable-builtin     : disable all internal databases</programlisting>
<programlisting language='lyx'>   -S                    : enable shared library mode</programlisting>
<programlisting language='lyx'>   --no-static-build     : skip static build</programlisting>
<programlisting language='lyx'>   --no-test             : skip 'make test'</programlisting>
<programlisting language='lyx'>   --clang               : use 'clang' instead of default (usually 'gcc')</programlisting>
<programlisting language='lyx'>                            if used before '-a|-A' mod_ipv6calc support will be excluded (incompatible linker issue)</programlisting>
<programlisting language='lyx'>   --m32                 : compile for 32-bit</programlisting>
<programlisting language='lyx'>   --enable-openssl-md5  : use legacy OpenSSL MD5 implementation</programlisting>
<programlisting language='lyx'>   --enable-libmd-md5    : use libmd MD5 implementation</programlisting>
<programlisting language='lyx'>   --relax               : don't stop on compiler warnings</programlisting>
</section>
</section>
<section>
<title>Mailing Lists</title>
<section>
<title>ipv6calc-announce</title>
<variablelist>
<varlistentry>
<term>Reason:</term>
<listitem>
<para>sending announcements of new versions</para>
</listitem>
</varlistentry>
<varlistentry>
<term>Traffic:</term>
<listitem>
<para>very low</para>
</listitem>
</varlistentry>
<varlistentry>
<term>Postings:</term>
<listitem>
<para>only moderators are allowed to post</para>
</listitem>
</varlistentry>
<varlistentry>
<term>Information:</term>
<listitem>
<para><link xlink:href="https://lists.deepspace6.net/postorius/lists/ipv6calc-announce.lists.deepspace6.net/">DeepSpace6 / maillist ipv6calc-announce</link></para>
</listitem>
</varlistentry>
</variablelist>
</section>
<section>
<title>ipv6calc</title>
<variablelist>
<varlistentry>
<term>Reason:</term>
<listitem>
<para>discussions</para>
</listitem>
</varlistentry>
<varlistentry>
<term>Traffic:</term>
<listitem>
<para>low</para>
</listitem>
</varlistentry>
<varlistentry>
<term>Postings:</term>
<listitem>
<para>subscribers</para>
</listitem>
</varlistentry>
<varlistentry>
<term>Information:</term>
<listitem>
<para><link xlink:href="https://lists.deepspace6.net/postorius/lists/ipv6calc.lists.deepspace6.net/">DeepSpace6 / maillist ipv6calc</link></para>
</listitem>
</varlistentry>
</variablelist>
</section>
</section>
<section>
<title>Bug Reports</title>
<para>You can send bug reports to the author himself or subscribe to maillist &#8220;ipv6calc&#8221; and send it to the list.</para>
</section>
<section>
<title>Features of ipv6calc</title>
<section>
<title>Description</title>
<para>The main program named &#8220;ipv6calc&#8221; is able to recognize many (not only) IPv6 address formats and depending on a selectable action (not required) a selectable output format can be specified. Also it has the capability to show detailed information of an IPv4/IPv6 address or anonymize it.</para>
</section>
<section>
<title>List of built-in features</title>
<para>Option &#8220;-v&#8221; shows built-in features, depending on configuration before compiling:</para>
<programlisting language='lyx'>$ ipv6calc -v</programlisting>
<programlisting language='lyx'>ipv6calc: version 4.3.0 GeoIP GeoIPv6 IP2Location IP2Location6 IP2Location2 IP2Location2v6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID DB_IPV4_DUMP_CC DB_IPV6_DUMP_CC ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID</programlisting>
<para>Option &#8220;-v -v&#8221; (since 0.91.0) shows built-in features and capabilities in detail, depending on configuration before compiling (EXAMPLE):</para>
<programlisting language='lyx'>$ ipv6calc -vv</programlisting>
<programlisting language='lyx'>ipv6calc: version 4.3.1 GeoIP GeoIPv6 IP2Location IP2Location6 IP2Location2 IP2Location2v6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID DB_IPV4_DUMP_CC DB_IPV6_DUMP_CC ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID</programlisting>
<programlisting language='lyx'>Capabilities: GeoIP2(linked/MMDB) IP2Location(linked/BIN) DBIP2(linked/MMDB) IP2Location2(linked/MMDB) ExternalDatabase DB_AS_REG(BuiltIn) DB_CC_REG(BuiltIn) DB_IPV4_REG(BuiltIn) DB_IPV6_REG(BuiltIn) DB_IEEE(BuiltIn)</programlisting>
<programlisting language='lyx'>Internal main     library version: 4.3.1  API: 4.3.0  (built-in)</programlisting>
<programlisting language='lyx'>Internal database library version: 4.3.1  API: 4.3.0  (built-in)</programlisting>
<programlisting language='lyx'>Linked MD5 implementation: OpenSSL EVP MD5</programlisting>
<programlisting language='lyx'>MaxMindDB for GeoIP2/DBIP2/IP2Location2 support enabled</programlisting>
<programlisting language='lyx'>MaxMindDB dynamic library version (on this system): 1.12.2</programlisting>
<programlisting language='lyx'>GeoIP2(MaxMindDB) support enabled</programlisting>
<programlisting language='lyx'>GeoIP(MMDB) database support: Country4=1 Country6=1 City4=1 City6=1 ASN4=1 ASN6=1 GeonameID4=1 GeonameID6=1</programlisting>
<programlisting language='lyx'>IP2Location support enabled, compiled with API version: 8.6.1, dynamically linked with version: API=8.6.1 Major=8 MajorMinor=806</programlisting>
<programlisting language='lyx'>IP2Location(BIN) database support: Country4=1 Country6=1 City4=1 City6=1 ASN4=1 ASN6=1 GeonameID4=0 GeonameID6=0</programlisting>
<programlisting language='lyx'>DBIP(MaxMindDB) support enabled</programlisting>
<programlisting language='lyx'>db-ip.com(MMDB) database support: Country4=1 Country6=1 City4=1 City6=1 ASN4=1 ASN6=1 GeonameID4=1 GeonameID6=1</programlisting>
<programlisting language='lyx'>IP2Location(MaxMindDB) support enabled</programlisting>
<programlisting language='lyx'>IP2Location(MMDB) database support: Country4=1 Country6=1 City4=0 City6=0 ASN4=0 ASN6=0 GeonameID4=1 GeonameID6=1</programlisting>
<programlisting language='lyx'>External(BDB) available databases: Country4=1 Country6=1 IPV4_REG=1 IPV6_REG=1</programlisting>
<programlisting language='lyx'>BuiltIn databases available: ASN_REG=1 IPV4_REG=1 IPV6_REG=1 IEEE=1 CC_REG=1</programlisting>
<programlisting language='lyx'>DB features: 0xffdfffff</programlisting>
<programlisting language='lyx'>GeoIP(MMDB): features available/implemented: 0x03063ff0/0x03063ff0 (100%)</programlisting>
<programlisting language='lyx'>GeoIP(MMDB): info of available databases in directory: /var/local/share/GeoIP</programlisting>
<programlisting language='lyx'>GeoIP(MMDB): IPv4/v6 CountryCode (LITE)    : [1] GeoLite2-Country.mmdb          (GeoLite2-Country Copyright (c) 2025 MaxMind All Rights Reserved, created: 20250121-103200 UTC)</programlisting>
<programlisting language='lyx'>GeoIP(MMDB): IPv4/v6 City (LITE)           : [2] GeoLite2-City.mmdb             (GeoLite2-City Copyright (c) 2025 MaxMind All Rights Reserved, created: 20250121-102358 UTC)</programlisting>
<programlisting language='lyx'>GeoIP(MMDB): IPv4/v6 ASN (LITE)            : [3] GeoLite2-ASN.mmdb              (GeoLite2-ASN Copyright (c) 2025 MaxMind All Rights Reserved, created: 20250121-081512 UTC)</programlisting>
<programlisting language='lyx'>GeoIP(MMDB): detected best databases LITE   : Country4=2  Country6=2  City4=2  City6=2  ASN4=3  ASN6=3  GeonameID4=2  GeonameID6=2</programlisting>
<programlisting language='lyx'>GeoIP(MMDB): detected best databases COMM   : Country4=-  Country6=-  City4=-  City6=-  ASN4=-  ASN6=-  GeonameID4=-  GeonameID6=-</programlisting>
<programlisting language='lyx'>GeoIP(MMDB): selected best databases normal : Country4=2  Country6=2  City4=2  City6=2  ASN4=3  ASN6=3  GeonameID4=2  GeonameID6=2</programlisting>
<programlisting language='lyx'>GeoIP(MMDB): selected best databases method : COMM older than 12 months are deselected in case of LITE is available</programlisting>
<programlisting language='lyx'>GeoIP(MMDB): selected best databases method : COMM/LITE with more features are only selected in case not older than 1 months of already found COMM/LITE</programlisting>
<programlisting language='lyx'>IP2Location(BIN): features available/implemented: 0x0c003ff0/0x0c003ff0 (100%)</programlisting>
<programlisting language='lyx'>IP2Location(BIN): info of available databases in directory: /var/local/share/IP2Location</programlisting>
<programlisting language='lyx'>IP2Location(BIN): Copyright (c) IP2Location All Rights Reserved</programlisting>
<programlisting language='lyx'>IP2Location(BIN): IPv4 Co/Re/Ci/LaLo/ZI/TZ/IS/Do/Ne/Ar/We/Mo/El/Us/Ad/Ca/Di/AS:[226] IP-COUNTRY-REGION-CITY-LATITUDE-LONGITUDE-ZIPCODE-TIMEZONE-ISP-DOMAIN-NETSPEED-AREACODE-WEATHER-MOBILE-ELEVATION-USAGETYPE-ADDRESSTYPE-CATEGORY-DISTRICT-ASN-SAMPLE.BIN (IP2L-DB26 IPv4 IPv6 SAMPLE 20202502)</programlisting>
<programlisting language='lyx'>IP2Location(BIN): IPv6 Co/Re/Ci/LaLo/ZI/TZ/IS/Do/Ne/Ar/We/Mo/El/Us/Ad/Ca/Di/AS:[326] IPV6-COUNTRY-REGION-CITY-LATITUDE-LONGITUDE-ZIPCODE-TIMEZONE-ISP-DOMAIN-NETSPEED-AREACODE-WEATHER-MOBILE-ELEVATION-USAGETYPE-ADDRESSTYPE-CATEGORY-DISTRICT-ASN.SAMPLE.BIN (IP2L-DB26 IPv4 IPv6 SAMPLE 20202502)</programlisting>
<programlisting language='lyx'>IP2Location(BIN): IPv4 Country                                    :[401] IP2LOCATION-LITE-DB1.BIN            (IP2L-DB1 IPv4 IPv6 LITE 20250101)</programlisting>
<programlisting language='lyx'>IP2Location(BIN): IPvx Country                                    :[501] IP2LOCATION-LITE-DB1.IPV6.BIN       (IP2L-DB1 IPv4 IPv6 LITE 20250101)</programlisting>
<programlisting language='lyx'>IP2Location(BIN): IPvx Co/Re/Ci/LattLong/ZIP/TZ                   :[111] IPV6-COUNTRY-REGION-CITY-LATITUDE-LONGITUDE-ZIPCODE-TIMEZONE.BIN (IP2L-DB11 IPv4 IPv6 20250115)</programlisting>
<programlisting language='lyx'>IP2Location(BIN): detected best databases SAMPLE : Country4=226  Country6=326  City4=226  City6=326  ASN4=226  ASN6=326  GeonameID4=-    GeonameID6=-  </programlisting>
<programlisting language='lyx'>IP2Location(BIN): detected best databases LITE   : Country4=501  Country6=501  City4=-    City6=-    ASN4=-    ASN6=-    GeonameID4=-    GeonameID6=-  </programlisting>
<programlisting language='lyx'>IP2Location(BIN): detected best databases COMM   : Country4=111  Country6=111  City4=111  City6=111  ASN4=-    ASN6=-    GeonameID4=-    GeonameID6=-  </programlisting>
<programlisting language='lyx'>IP2Location(BIN): selected best databases LI-&gt;SA*: Country4=-    Country6=-    City4=-    City6=-    ASN4=-    ASN6=-    GeonameID4=-    GeonameID6=-  </programlisting>
<programlisting language='lyx'>IP2Location(BIN): selected best databases normal : Country4=111  Country6=111  City4=111  City6=111  ASN4=226  ASN6=326  GeonameID4=-    GeonameID6=-  </programlisting>
<programlisting language='lyx'>IP2Location(BIN): selected best databases method : * = autoswitch from LITE to SAMPLE enabled in case not older than 12 months and having more features</programlisting>
<programlisting language='lyx'>IP2Location(BIN): selected best databases method : COMM older than 12 months are deselected in case of LITE is available</programlisting>
<programlisting language='lyx'>IP2Location(BIN): selected best databases method : COMM/LITE/SAMPLE with more features are only selected in case not older than 1 months of already found COMM/LITE/SAMPLE</programlisting>
<programlisting language='lyx'>IP2Location(BIN): selected best databases method : softlinks skipped-by-default</programlisting>
<programlisting language='lyx'>db-ip.com(MMDB): features available/implemented: 0x30063ff0/0x30063ff0 (100%)</programlisting>
<programlisting language='lyx'>db-ip.com(MMDB): info of available databases in directory: /var/local/share/DBIP</programlisting>
<programlisting language='lyx'>db-ip.com(MMDB): IPv4/v6 CountryCode (LITE)    : [1] dbip-country-lite.mmdb         (DBIP-Country-Lite Copyright (c) 2025 db-ip.com All Rights Reserved, created: 20250201-021656 UTC)</programlisting>
<programlisting language='lyx'>db-ip.com(MMDB): IPv4/v6 City (LITE)           : [2] dbip-city-lite.mmdb            (DBIP-City-Lite Copyright (c) 2025 db-ip.com All Rights Reserved, created: 20250201-022127 UTC)</programlisting>
<programlisting language='lyx'>db-ip.com(MMDB): IPv4/v6 ASN (LITE)            : [3] dbip-asn-lite.mmdb             (DBIP-ASN-Lite (compat=GeoLite2-ASN) Copyright (c) 2025 db-ip.com All Rights Reserved, created: 20250201-022141 UTC)</programlisting>
<programlisting language='lyx'>db-ip.com(MMDB): detected best databases LITE   : Country4=2  Country6=2  City4=2  City6=2  ASN4=3  ASN6=3  GeonameID4=2  GeonameID6=2</programlisting>
<programlisting language='lyx'>db-ip.com(MMDB): detected best databases COMM   : Country4=-  Country6=-  City4=-  City6=-  ASN4=-  ASN6=-  GeonameID4=-  GeonameID6=-</programlisting>
<programlisting language='lyx'>db-ip.com(MMDB): selected best databases normal : Country4=2  Country6=2  City4=2  City6=2  ASN4=3  ASN6=3  GeonameID4=2  GeonameID6=2</programlisting>
<programlisting language='lyx'>db-ip.com(MMDB): selected best databases method: COMM older than 12 months are deselected in case of LITE is available</programlisting>
<programlisting language='lyx'>db-ip.com(MMDB): selected best databases method: COMM/LITE with more features are only selected in case not older than 1 months of already found COMM/LITE</programlisting>
<programlisting language='lyx'>IP2Location(MMDB): features available/implemented: 0x00c603c0/0x00c63ff0 (57%)</programlisting>
<programlisting language='lyx'>IP2Location(MMDB): info of available databases in directory: /var/local/share/IP2Location</programlisting>
<programlisting language='lyx'>IP2Location(MMDB): Copyright (c) IP2Location All Rights Reserved</programlisting>
<programlisting language='lyx'>IP2Location(MMDB): IPvx Country                                    :[401] IP2LOCATION-LITE-DB1.MMDB           (GeoLite2Country database, created: 20241228-235320 UTC)</programlisting>
<programlisting language='lyx'>IP2Location(MMDB): detected best databases SAMPLE : Country4=-    Country6=-    City4=-    City6=-    ASN4=-    ASN6=-    GeonameID4=-    GeonameID6=-  </programlisting>
<programlisting language='lyx'>IP2Location(MMDB): detected best databases LITE   : Country4=401  Country6=401  City4=-    City6=-    ASN4=-    ASN6=-    GeonameID4=401  GeonameID6=401</programlisting>
<programlisting language='lyx'>IP2Location(MMDB): detected best databases COMM   : Country4=-    Country6=-    City4=-    City6=-    ASN4=-    ASN6=-    GeonameID4=-    GeonameID6=-  </programlisting>
<programlisting language='lyx'>IP2Location(MMDB): selected best databases LI-&gt;SA*: Country4=-    Country6=-    City4=-    City6=-    ASN4=-    ASN6=-    GeonameID4=-    GeonameID6=-  </programlisting>
<programlisting language='lyx'>IP2Location(MMDB): selected best databases normal : Country4=401  Country6=401  City4=-    City6=-    ASN4=-    ASN6=-    GeonameID4=401  GeonameID6=401</programlisting>
<programlisting language='lyx'>IP2Location(MMDB): selected best databases method : * = autoswitch from LITE to SAMPLE enabled in case not older than 12 months and having more features</programlisting>
<programlisting language='lyx'>IP2Location(MMDB): selected best databases method : COMM older than 12 months are deselected in case of LITE is available</programlisting>
<programlisting language='lyx'>IP2Location(MMDB): selected best databases method : COMM/LITE/SAMPLE with more features are only selected in case not older than 1 months of already found COMM/LITE/SAMPLE</programlisting>
<programlisting language='lyx'>IP2Location(MMDB): selected best databases method : softlinks skipped-by-default</programlisting>
<programlisting language='lyx'>External(BDB): features available/implemented: 0xc01980cc/0xc01980cc (100%)</programlisting>
<programlisting language='lyx'>External(BDB): info of available databases in directory: /var/local/share/ipv6calc</programlisting>
<programlisting language='lyx'>External(BDB): IPv4 Registry       : ipv6calc-external-ipv4-registry.db       (EXTDB-1/AFRINIC/20250128 APNIC/20250127 ARIN/20250127 IANA/20231218 LACNIC/20250127 LISP/20200318 RIPENCC/20250127, created: 20250128-070630 UTC)</programlisting>
<programlisting language='lyx'>External(BDB): IPv6 Registry       : ipv6calc-external-ipv6-registry.db       (EXTDB-2/AFRINIC/20250128 APNIC/20250127 ARIN/20250127 IANA/20241104 LACNIC/20250127 LISP/20200318 RIPENCC/20250127, created: 20250128-071031 UTC)</programlisting>
<programlisting language='lyx'>External(BDB): IPv4 CountryCode    : ipv6calc-external-ipv4-countrycode.db    (EXTDB-3/AFRINIC/20250128 APNIC/20250127 ARIN/20250127 IANA/20231218 LACNIC/20250127 LISP/20200318 RIPENCC/20250127, created: 20250128-070630 UTC)</programlisting>
<programlisting language='lyx'>External(BDB): IPv6 CountryCode    : ipv6calc-external-ipv6-countrycode.db    (EXTDB-4/AFRINIC/20250128 APNIC/20250127 ARIN/20250127 IANA/20241104 LACNIC/20250127 LISP/20200318 RIPENCC/20250127, created: 20250128-071031 UTC)</programlisting>
<programlisting language='lyx'>BuiltIn: features available/implemented: 0x0001c00f/0x0001c00f (100%)</programlisting>
<programlisting language='lyx'>BuiltIn: info of available databases</programlisting>
<programlisting language='lyx'>BuiltIn: ASN  : IANA/20250117</programlisting>
<programlisting language='lyx'>BuiltIn: CC   : AFRINIC/20250510 APNIC/20250509 ARIN/20250510 LACNIC/20250509 RIPENCC/20250509</programlisting>
<programlisting language='lyx'>BuiltIn: IPv4 : AFRINIC/20250510 APNIC/20250509 ARIN/20250510 IANA/20231218 LACNIC/20250509 LISP/20200318 RIPENCC/20250509 (created: 20250510-135700 UTC)</programlisting>
<programlisting language='lyx'>BuiltIn: IPv6 : AFRINIC/20250510 APNIC/20250509 ARIN/20250510 IANA/20241104 LACNIC/20250509 LISP/20200318 RIPENCC/20250509 (created: 20250510-140120 UTC)</programlisting>
<programlisting language='lyx'>BuiltIn: IEEE : IAB/20250510 OUI/20250510 OUI28/20250510 OUI36/20250510</programlisting>
<programlisting language='lyx'>Database selection or priorization ('-&gt;': subsequential calls)</programlisting>
<programlisting language='lyx'>Database priorization default: GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;IP2Location(MMDB)-&gt;db-ip.com(MMDB)-&gt;External(BDB)-&gt;BuiltIn</programlisting>
<programlisting language='lyx'>DB_AS_REG (AS-Number to Registry database): BuiltIn</programlisting>
<programlisting language='lyx'>DB_CC_REG (CountryCode to Registry database): BuiltIn</programlisting>
<programlisting language='lyx'>DB_IPV4_REG (IPv4 to Registry database): BuiltIn</programlisting>
<programlisting language='lyx'>DB_IPV6_REG (IPv6 to Registry database): BuiltIn</programlisting>
<programlisting language='lyx'>DB_IPV4_AS (IPv4 to AS database): GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;db-ip.com(MMDB)</programlisting>
<programlisting language='lyx'>DB_IPV6_AS (IPv6 to AS database): GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;db-ip.com(MMDB)</programlisting>
<programlisting language='lyx'>DB_IPV4_CC (IPv4 to CountryCode database): GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;IP2Location(MMDB)-&gt;db-ip.com(MMDB)-&gt;External(BDB)</programlisting>
<programlisting language='lyx'>DB_IPV6_CC (IPv6 to CountryCode database): GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;IP2Location(MMDB)-&gt;db-ip.com(MMDB)-&gt;External(BDB)</programlisting>
<programlisting language='lyx'>DB_IPV4_COUNTRY (IPv4 to Country database): GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;IP2Location(MMDB)-&gt;db-ip.com(MMDB)</programlisting>
<programlisting language='lyx'>DB_IPV6_COUNTRY (IPv6 to Country database): GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;IP2Location(MMDB)-&gt;db-ip.com(MMDB)</programlisting>
<programlisting language='lyx'>DB_IPV4_CITY (IPv4 to City database): GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;db-ip.com(MMDB)</programlisting>
<programlisting language='lyx'>DB_IPV6_CITY (IPv6 to City database): GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;db-ip.com(MMDB)</programlisting>
<programlisting language='lyx'>DB_IPV4_REGION (IPv4 to Region database): GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;db-ip.com(MMDB)</programlisting>
<programlisting language='lyx'>DB_IPV6_REGION (IPv6 to Region database): GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;db-ip.com(MMDB)</programlisting>
<programlisting language='lyx'>DB_IEEE (IEEE/OUI/OUI28/OUI36 Vendor database): BuiltIn</programlisting>
<programlisting language='lyx'>DB_IPV4_INFO (IPv4 additional information): External(BDB)-&gt;BuiltIn</programlisting>
<programlisting language='lyx'>DB_IPV6_INFO (IPv6 additional information): External(BDB)-&gt;BuiltIn</programlisting>
<programlisting language='lyx'>DB_IPV4_GEONAMEID (IPv4 GeonameID): GeoIP(MMDB)-&gt;IP2Location(MMDB)-&gt;db-ip.com(MMDB)</programlisting>
<programlisting language='lyx'>DB_IPV6_GEONAMEID (IPv6 GeonameID): GeoIP(MMDB)-&gt;IP2Location(MMDB)-&gt;db-ip.com(MMDB)</programlisting>
<programlisting language='lyx'>DB_IPV4_DUMP_CC (IPv4 Database Dump by CountryCode): External(BDB)</programlisting>
<programlisting language='lyx'>DB_IPV6_DUMP_CC (IPv6 Database Dump by CountryCode): External(BDB)</programlisting>
<para>Option &#8220;-v -h&#8221; (since 0.97.4) shows explanation of feature tokens</para>
<programlisting language='lyx'>$ ipv6calc -v -h</programlisting>
<programlisting language='lyx'>ipv6calc: version 4.3.1 GeoIP GeoIPv6 IP2Location IP2Location6 IP2Location2 IP2Location2v6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID DB_IPV4_DUMP_CC DB_IPV6_DUMP_CC ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID</programlisting>
<programlisting language='lyx'>Explanation of available(x)/possible(o) feature tokens</programlisting>
<programlisting language='lyx'>GeoIP                    x GeoIP(MMDB) IPv4 database (provided by GeoIP(MMDB))</programlisting>
<programlisting language='lyx'>GeoIPv6                  x GeoIP(MMDB) IPv6 database (provided by GeoIP(MMDB))</programlisting>
<programlisting language='lyx'>IP2Location              x IP2Location(BIN) IPv4 database (provided by IP2Location(BIN))</programlisting>
<programlisting language='lyx'>IP2Location6             x IP2Location(BIN) IPv6 database (provided by IP2Location(BIN))</programlisting>
<programlisting language='lyx'>IP2Location2             x IP2Location(MMDB) IPv4 database (provided by IP2Location(MMDB))</programlisting>
<programlisting language='lyx'>IP2Location2v6           x IP2Location(MMDB) IPv6 database (provided by IP2Location(MMDB))</programlisting>
<programlisting language='lyx'>DBIPv4                   x db-ip.com(MMDB) IPv4 database (provided by db-ip.com(MMDB))</programlisting>
<programlisting language='lyx'>DBIPv6                   x db-ip.com(MMDB) IPv6 database (provided by db-ip.com(MMDB))</programlisting>
<programlisting language='lyx'>DB_AS_REG                x AS-Number to Registry database (provided by BuiltIn)</programlisting>
<programlisting language='lyx'>DB_IPV4_REG              x IPv4 to Registry database (provided by External(BDB),BuiltIn)</programlisting>
<programlisting language='lyx'>DB_IPV6_REG              x IPv6 to Registry database (provided by External(BDB),BuiltIn)</programlisting>
<programlisting language='lyx'>DB_IPV4_AS               x IPv4 to AS database (provided by GeoIP(MMDB),IP2Location(BIN),IP2Location(MMDB),db-ip.com(MMDB))</programlisting>
<programlisting language='lyx'>DB_IPV6_AS               x IPv6 to AS database (provided by GeoIP(MMDB),IP2Location(BIN),IP2Location(MMDB),db-ip.com(MMDB))</programlisting>
<programlisting language='lyx'>DB_IPV4_CC               x IPv4 to CountryCode database (provided by GeoIP(MMDB),IP2Location(BIN),IP2Location(MMDB),db-ip.com(MMDB),External(BDB))</programlisting>
<programlisting language='lyx'>DB_IPV6_CC               x IPv6 to CountryCode database (provided by GeoIP(MMDB),IP2Location(BIN),IP2Location(MMDB),db-ip.com(MMDB),External(BDB))</programlisting>
<programlisting language='lyx'>DB_IPV4_COUNTRY          x IPv4 to Country database (provided by GeoIP(MMDB),IP2Location(BIN),IP2Location(MMDB),db-ip.com(MMDB))</programlisting>
<programlisting language='lyx'>DB_IPV6_COUNTRY          x IPv6 to Country database (provided by GeoIP(MMDB),IP2Location(BIN),IP2Location(MMDB),db-ip.com(MMDB))</programlisting>
<programlisting language='lyx'>DB_IPV4_CITY             x IPv4 to City database (provided by GeoIP(MMDB),IP2Location(BIN),IP2Location(MMDB),db-ip.com(MMDB))</programlisting>
<programlisting language='lyx'>DB_IPV6_CITY             x IPv6 to City database (provided by GeoIP(MMDB),IP2Location(BIN),IP2Location(MMDB),db-ip.com(MMDB))</programlisting>
<programlisting language='lyx'>DB_IPV4_REGION           x IPv4 to Region database (provided by GeoIP(MMDB),IP2Location(BIN),IP2Location(MMDB),db-ip.com(MMDB))</programlisting>
<programlisting language='lyx'>DB_IPV6_REGION           x IPv6 to Region database (provided by GeoIP(MMDB),IP2Location(BIN),IP2Location(MMDB),db-ip.com(MMDB))</programlisting>
<programlisting language='lyx'>DB_CC_REG                x CountryCode to Registry database (provided by BuiltIn)</programlisting>
<programlisting language='lyx'>DB_IEEE                  x IEEE/OUI/OUI28/OUI36 Vendor database (provided by BuiltIn)</programlisting>
<programlisting language='lyx'>DB_IPV4_INFO             x IPv4 additional information (provided by External(BDB),BuiltIn)</programlisting>
<programlisting language='lyx'>DB_IPV6_INFO             x IPv6 additional information (provided by External(BDB),BuiltIn)</programlisting>
<programlisting language='lyx'>DB_IPV4_GEONAMEID        x IPv4 GeonameID (provided by GeoIP(MMDB),IP2Location(MMDB),db-ip.com(MMDB))</programlisting>
<programlisting language='lyx'>DB_IPV6_GEONAMEID        x IPv6 GeonameID (provided by GeoIP(MMDB),IP2Location(MMDB),db-ip.com(MMDB))</programlisting>
<programlisting language='lyx'>DB_IPV4_DUMP_CC          x IPv4 Database Dump by CountryCode (provided by External(BDB))</programlisting>
<programlisting language='lyx'>DB_IPV6_DUMP_CC          x IPv6 Database Dump by CountryCode (provided by External(BDB))</programlisting>
<programlisting language='lyx'>ANON_ZEROISE             x Anonymization method 'zeroize'</programlisting>
<programlisting language='lyx'>ANON_ANONYMIZE           x Anonymization method 'anonymize'</programlisting>
<programlisting language='lyx'>ANON_KEEP-TYPE-ASN-CC    x Anonymization method 'keep-type-asn-cc'</programlisting>
<programlisting language='lyx'>ANON_KEEP-TYPE-GEONAMEID x Anonymization method 'keep-type-geonameid'</programlisting>
<para>Note: since version 0.95.0 the internal layer for database usage was abstracted and each database &#8220;plugin&#8221; is initialized reporting then its supporting features in binary representation. This makes implementation of other external databases easier in the future. Partially internal (built-in) databases can be overlayed by generated external databases replacing the need of recompilation for updated built-in databases.</para>
</section>
<section>
<title>Examples</title>
<section>
<title>Conversion</title>
<para>A simple example is the conversion of an IPv6 address to a DNS PTR query string:</para>
<programlisting language='lyx'>$ ipv6calc --out revnibbles.arpa 2001:db8::1</programlisting>
<programlisting language='lyx'>No input type specified, try autodetection...found type: ipv6addr</programlisting>
<programlisting language='lyx'>1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.8.b.d.0.1.0.0.2.ip6.arpa.</programlisting>
<para>Like you see, input format was autodetected. And the given example can be extended because ipv6calc also understands netmask / prefix length values:</para>
<programlisting language='lyx'>$ ipv6calc -q --out revnibbles.arpa 2001:db8::1/64</programlisting>
<programlisting language='lyx'>0.0.0.0.0.0.0.0.8.b.d.0.1.0.0.2.ip6.arpa.</programlisting>
<para>Also you&#8217;ve also learnt now that switch &#8217;-q&#8217; (quiet) suppresses informational messages. You can use this now to start a DNS PTR query using:</para>
<programlisting language='lyx'>$ dig PTR `./ipv6calc -q --out revnibbles.arpa 2001:db8::1/64`</programlisting>
<para>But ipv6calc can do many more for you! Next example shows you the extraction of the IPv4 address contained in a 6to4 IPv6 address:</para>
<programlisting language='lyx'>$ ipv6calc -q --action conv6to4 --in ipv6 2002:c0a8:fb61::1 --out ipv4</programlisting>
<programlisting language='lyx'>192.168.251.97</programlisting>
<para>This also works vice-versa:</para>
<programlisting language='lyx'>$ ipv6calc -q --action conv6to4 --in ipv4 192.168.251.97 --out ipv6</programlisting>
<programlisting language='lyx'>2002:c0a8:fb61::</programlisting>
<para>There are many more features already implemented, if you miss one, send a note.</para>
</section>
<section>
<title>Information</title>
<para>Depending on available databases output can vary.</para>
<section>
<title>Information about a simple IPv6 address:</title>
<programlisting language='lyx'>$ ipv6calc -q -i 3ffe:ffff::210:a4ff:fe01:2345</programlisting>
<programlisting language='lyx'>Address type: unicast, 6bone, global-unicast, productive</programlisting>
<programlisting language='lyx'>Address type has SLA: 0000</programlisting>
<programlisting language='lyx'>Registry for address: reserved</programlisting>
<programlisting language='lyx'>Interface identifier: 0210:a4ff:fe01:2345</programlisting>
<programlisting language='lyx'>EUI-48/MAC address: 00:10:a4:01:23:45</programlisting>
<programlisting language='lyx'>MAC is a global unique one</programlisting>
<programlisting language='lyx'>MAC is an unicast one</programlisting>
<programlisting language='lyx'>OUI is: XIRCOM</programlisting>
</section>
<section>
<title>Information about a Teredo IPv6 address:</title>
<programlisting language='lyx'>$ ipv6calc -q -i 3ffe:831f:ce49:7601:8000:efff:af4a:86BF</programlisting>
<programlisting language='lyx'>Address type: unicast, 6bone, global-unicast, teredo</programlisting>
<programlisting language='lyx'>Country Code: IT</programlisting>
<programlisting language='lyx'>Registry for address: 6BONE</programlisting>
<programlisting language='lyx'>IPv4 address: 80.181.121.64 (TEREDO-CLIENT)</programlisting>
<programlisting language='lyx'>IPv4 address type: unicast, global</programlisting>
<programlisting language='lyx'>Autonomous System Information for [80.181.121.64]: AS3269 ASN-IBSNAZ</programlisting>
<programlisting language='lyx'>Country Code for [80.181.121.64]: IT </programlisting>
<programlisting language='lyx'>...</programlisting>
</section>
<section>
<title>Information about a LISP address</title>
<programlisting language='lyx'>$ ipv6calc -q -i 153.16.26.80</programlisting>
<programlisting language='lyx'>IPv4 address: 153.16.26.80</programlisting>
<programlisting language='lyx'>IPv4 address type: unicast, global, lisp</programlisting>
<programlisting language='lyx'>...</programlisting>
<programlisting language='lyx'>IPv4 registry: ARIN(LISP#cbc-xtr) </programlisting>
<programlisting language='lyx'>...</programlisting>
</section>
<section>
<title>Machine readable output</title>
<para>There exists also a machine readable output (e.g. used by &#8217;ipv6calcweb.cgi&#8217;) - in addition, database related information can be displayed, if databases are located on the system and supported.</para>
<programlisting language='lyx'>$ ipv6calc -q -i -m 2a01:238:423d:8800:85b3:9e6b:3019:8909  </programlisting>
<programlisting language='lyx'>IPV6=2a01:0238:423d:8800:85b3:9e6b:3019:8909</programlisting>
<programlisting language='lyx'>IPV6_ANON=a909:16fa:9091:a448:a909:4941:0000:0007</programlisting>
<programlisting language='lyx'>IPV6_TYPE=ipv6,unicast,global-unicast,productive,iid-random,iid,iid-local</programlisting>
<programlisting language='lyx'>IPV6_COUNTRYCODE=DE</programlisting>
<programlisting language='lyx'>IPV6_COUNTRYCODE_SOURCE=GeoIP(MMDB)</programlisting>
<programlisting language='lyx'>IPV6_AS_NUM=6724</programlisting>
<programlisting language='lyx'>IPV6_AS_ORGNAME=Strato GmbH</programlisting>
<programlisting language='lyx'>IPV6_AS_SOURCE=GeoIP(MMDB)</programlisting>
<programlisting language='lyx'>IPV6_GEONAME_ID=2921044</programlisting>
<programlisting language='lyx'>IPV6_GEONAME_ID_SOURCE=GeoIP(MMDB)</programlisting>
<programlisting language='lyx'>IPV6_GEONAME_ID_TYPE=Country</programlisting>
<programlisting language='lyx'>IPV6_REGISTRY=RIPENCC</programlisting>
<programlisting language='lyx'>SLA=8800</programlisting>
<programlisting language='lyx'>IID=85b3:9e6b:3019:8909</programlisting>
<programlisting language='lyx'>EUI64_SCOPE=local-random</programlisting>
<programlisting language='lyx'>IP2LOCATION_COUNTRY_SHORT=DE</programlisting>
<programlisting language='lyx'>IP2LOCATION_COUNTRY_LONG=Germany</programlisting>
<programlisting language='lyx'>IP2LOCATION_REGION=Berlin</programlisting>
<programlisting language='lyx'>IP2LOCATION_CITY=Berlin</programlisting>
<programlisting language='lyx'>IP2LOCATION_ZIPCODE=10178</programlisting>
<programlisting language='lyx'>IP2LOCATION_LATITUDE=52.524525</programlisting>
<programlisting language='lyx'>IP2LOCATION_LONGITUDE=13.410037</programlisting>
<programlisting language='lyx'>IP2LOCATION_TIMEZONE=+01:00</programlisting>
<programlisting language='lyx'>IP2LOCATION2_CONTINENT_SHORT=EU</programlisting>
<programlisting language='lyx'>IP2LOCATION2_CONTINENT_LONG=Europe</programlisting>
<programlisting language='lyx'>IP2LOCATION2_COUNTRY_SHORT=DE</programlisting>
<programlisting language='lyx'>IP2LOCATION2_COUNTRY_LONG=Germany</programlisting>
<programlisting language='lyx'>IP2LOCATION2_GEONAME_ID_COUNTRY=2921044</programlisting>
<programlisting language='lyx'>IP2LOCATION2_GEONAME_ID_CONTINENT=6255148</programlisting>
<programlisting language='lyx'>GEOIP2_CONTINENT_SHORT=EU</programlisting>
<programlisting language='lyx'>GEOIP2_CONTINENT_LONG=Europe</programlisting>
<programlisting language='lyx'>GEOIP2_COUNTRY_SHORT=DE</programlisting>
<programlisting language='lyx'>GEOIP2_COUNTRY_LONG=Germany</programlisting>
<programlisting language='lyx'>GEOIP2_LATITUDE=51.299300</programlisting>
<programlisting language='lyx'>GEOIP2_LONGITUDE=9.491000</programlisting>
<programlisting language='lyx'>GEOIP2_RADIUS=200</programlisting>
<programlisting language='lyx'>GEOIP2_TIMEZONE_NAME=Europe/Berlin</programlisting>
<programlisting language='lyx'>GEOIP2_AS_NUM=6724</programlisting>
<programlisting language='lyx'>GEOIP2_AS_ORGNAME=Strato GmbH</programlisting>
<programlisting language='lyx'>GEOIP2_GEONAME_ID_COUNTRY=2921044</programlisting>
<programlisting language='lyx'>GEOIP2_GEONAME_ID_CONTINENT=6255148</programlisting>
<programlisting language='lyx'>DBIP2_CONTINENT_SHORT=EU</programlisting>
<programlisting language='lyx'>DBIP2_CONTINENT_LONG=Europe</programlisting>
<programlisting language='lyx'>DBIP2_COUNTRY_SHORT=DE</programlisting>
<programlisting language='lyx'>DBIP2_COUNTRY_LONG=Germany</programlisting>
<programlisting language='lyx'>DBIP2_REGION=Berlin</programlisting>
<programlisting language='lyx'>DBIP2_CITY=Berlin (Charlottenburg-Wilmersdorf)</programlisting>
<programlisting language='lyx'>DBIP2_LATITUDE=52.523400</programlisting>
<programlisting language='lyx'>DBIP2_LONGITUDE=13.322400</programlisting>
<programlisting language='lyx'>DBIP2_AS_NUM=6724</programlisting>
<programlisting language='lyx'>DBIP2_AS_ORGNAME=Strato AG</programlisting>
<programlisting language='lyx'>DBIP2_GEONAME_ID_COUNTRY=2921044</programlisting>
<programlisting language='lyx'>DBIP2_GEONAME_ID_CONTINENT=6255148</programlisting>
<programlisting language='lyx'>EXTERNAL_COUNTRY_SHORT=DE</programlisting>
<programlisting language='lyx'>IP2LOCATION_DATABASE_INFO=IP2L-DB11 IPv4 IPv6 20250115 Copyright (c) 2025 IP2Location All Rights Reserved</programlisting>
<programlisting language='lyx'>IP2LOCATION2_DATABASE_INFO=GeoLite2Country database Copyright (c) 2024 IP2Location All Rights Reserved, created: 20241228-235320 UTC / This site or product includes IP2Location LITE data available from https://lite.ip2location.com</programlisting>
<programlisting language='lyx'>GEOIP2_DATABASE_INFO=GeoLite2-City Copyright (c) 2025 MaxMind All Rights Reserved, created: 20250121-102358 UTC / GeoLite2-ASN Copyright (c) 2025 MaxMind All Rights Reserved, created: 20250121-081512 UTC</programlisting>
<programlisting language='lyx'>DBIP2_DATABASE_INFO=DBIP-City-Lite Copyright (c) 2025 db-ip.com All Rights Reserved, created: 20250201-022127 UTC / DBIP-ASN-Lite (compat=GeoLite2-ASN) Copyright (c) 2025 db-ip.com All Rights Reserved, created: 20250201-022141 UTC</programlisting>
<programlisting language='lyx'>EXTERNAL_DATABASE_INFO=EXTDB-4/AFRINIC/20250128 APNIC/20250127 ARIN/20250127 IANA/20241104 LACNIC/20250127 LISP/20200318 RIPENCC/20250127, created: 20250128-071031 UTC</programlisting>
<programlisting language='lyx'>BUILTIN_DATABASE_INFO=IPv6-REG:AFRINIC/20250510 APNIC/20250509 ARIN/20250510 IANA/20241104 LACNIC/20250509 LISP/20200318 RIPENCC/20250509</programlisting>
<programlisting language='lyx'>IPV6CALC_NAME=ipv6calc</programlisting>
<programlisting language='lyx'>IPV6CALC_VERSION=4.3.1</programlisting>
<programlisting language='lyx'>IPV6CALC_COPYRIGHT="(P) &amp; (C) 2001-2025 by Peter Bieringer &lt;pb (at) bieringer.de&gt;"</programlisting>
<programlisting language='lyx'>IPV6CALC_OUTPUT_VERSION=23</programlisting>
<programlisting language='lyx'>IPV6CALC_SETTINGS_ANON="set=keep-type-asn-cc,mask-ipv6=56,mask-ipv4=24,mask-eui64=40,mask-mac=24,method=keep-type-asn-cc"</programlisting>
<programlisting language='lyx'>IPV6CALC_FEATURES="GeoIP GeoIPv6 IP2Location IP2Location6 IP2Location2 IP2Location2v6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID DB_IPV4_DUMP_CC DB_IPV6_DUMP_CC ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID"</programlisting>
<programlisting language='lyx'>IPV6CALC_CAPABILITIES="GeoIP2(linked/MMDB) IP2Location(linked/BIN) DBIP2(linked/MMDB) IP2Location2(linked/MMDB) ExternalDatabase DB_AS_REG(BuiltIn) DB_CC_REG(BuiltIn) DB_IPV4_REG(BuiltIn) DB_IPV6_REG(BuiltIn) DB_IEEE(BuiltIn)"</programlisting>
<bridgehead renderas='sect4'>Special machine readable output options (&gt;= 0.99.0)</bridgehead>
<section>
<title>Output filter by selecting a token (&gt;= 0.99.0)</title>
<para>Using option --mrst &lt;TOKEN&gt; (Machine Readable Select Token) can be used to display only a selected token</para>
<programlisting language='lyx'>$ ipv6calc -q -i --mrst IPV6_TYPE 2a01:238:423d:8800:85b3:9e6b:3019:8909 </programlisting>
<programlisting language='lyx'>IPV6_TYPE=unicast,global-unicast,productive,iid-random,iid,iid-local</programlisting>
</section>
<section>
<title>Output filter by matching token (&gt;= 0.99.0)</title>
<para>Using option --mrmt &lt;TOKEN&gt; (Machine Readable Match Token) can be used to display only matching tokens</para>
<programlisting language='lyx'>$ ipv6calc -q -i --mrmt IP2LOCATION 2a01:238:423d:8800:85b3:9e6b:3019:8909 </programlisting>
<programlisting language='lyx'>IP2LOCATION_COUNTRY_SHORT=DE</programlisting>
<programlisting language='lyx'>IP2LOCATION_COUNTRY_LONG=Germany</programlisting>
<programlisting language='lyx'>IP2LOCATION_REGION=Berlin</programlisting>
<programlisting language='lyx'>IP2LOCATION_CITY=Berlin</programlisting>
<programlisting language='lyx'>IP2LOCATION_ZIPCODE=10178</programlisting>
<programlisting language='lyx'>IP2LOCATION_LATITUDE=52.524368</programlisting>
<programlisting language='lyx'>IP2LOCATION_LONGITUDE=13.410530</programlisting>
<programlisting language='lyx'>IP2LOCATION_TIMEZONE_NAME=+01:00</programlisting>
<programlisting language='lyx'>IP2LOCATION_DATABASE_INFO=IP2L-DB11 IPv6 20181226 Copyright (c) 2018 IP2Location All Rights Reserved</programlisting>
</section>
<section>
<title>Output filter by selecting a value of a token token (&gt;= 0.99.0)</title>
<para>Using option --mrtvo &lt;TOKEN&gt; (Machine Readable Token Value Only) can be used to display only thevalue of a selected token</para>
<programlisting language='lyx'>$ ipv6calc -q -i --mrtvo IPV6_TYPE 2a01:238:423d:8800:85b3:9e6b:3019:8909 </programlisting>
<programlisting language='lyx'>unicast,global-unicast,productive,iid-random,iid,iid-local</programlisting>
</section>
<section>
<title>Output adjustment by unconditional quoting of values (&gt;= 0.99.0)</title>
<para>Using option --mrqva (Machine Readable Quote Values Always) can be used to quote values always of a selected token</para>
<programlisting language='lyx'>$ ipv6calc -q -i --mrqva --mrtvo IPV6_TYPE 2a01:238:423d:8800:85b3:9e6b:3019:8909 </programlisting>
<programlisting language='lyx'>"unicast,global-unicast,productive,iid-random,iid,iid-local"</programlisting>
</section>
<section>
<title>Output adjustment by unconditional disabling quoted values (&gt;= 0.99.0)</title>
<para>Using option --mrqvn (Machine Readable Quote Values Never) can be used to never quote values of a selected token</para>
<programlisting language='lyx'>$ ipv6calc -q -i --mrqvn --mrst IPV6_AS_TEXT 2a01:238:423d:8800:85b3:9e6b:3019:8909 </programlisting>
<programlisting language='lyx'>IPV6_AS_TEXT=AS6724 STRATO AG</programlisting>
</section>
<section>
<title>Output adjustment by unconditional print token in case of empty value (&gt;= 0.99.0)</title>
<para>Using option --mrstpq (Machine Readable Select Token Print Always) can be used to print always token/value regardless it&#8217;s contained</para>
<programlisting language='lyx'>$ ipv6calc -q -i --mrqva --mrstpa IPV4 2a01:238:423d:8800:85b3:9e6b:3019:8909 </programlisting>
<programlisting language='lyx'>IPV4=""</programlisting>
<programlisting language='lyx'>$ ipv6calc -q -i --mrqva --mrst IPV4 2a01:238:423d:8800:85b3:9e6b:3019:8909 </programlisting>
<programlisting language='lyx'>(no output)</programlisting>
</section>
</section>
</section>
<section>
<title>Filter mode</title>
<para>&#8220;ipv6calc&#8221; can run in filter mode to be able to extract from a huge list of IPv4/IPv6 addresses ones which are interesting or ones which are not interesting (see printout of online help below).</para>
<para>Filter tokens are the ones which are listed on &#8220;TYPE&#8221; lines shown in &#8220;-m -i&#8221; information mode.</para>
<para>Example for searching for Teredo addresses:</para>
<programlisting language='lyx'>$ cat ip.bieringer.de-log.201310 | awk '{ print $1 }' | sort | uniq | ipv6calc -A filter -E teredo</programlisting>
<programlisting language='lyx'>2001:0:9d38:90d7:34f7:1a26:8599:e079</programlisting>
<para>For more information see below</para>
<para>Note: since version 0.95.0 &#8217;-A filter&#8217; is optional if option &#8217;-E &lt;filter expression&gt;&#8217; is given (autoselected action).</para>
</section>
<section>
<title>Test mode</title>
<para>Since 0.99.2 a test mode (&#8217;-A test&#8217;, autoselected in case &#8217;test_*&#8217; options are given) is implemented for address prefix or range</para>
<para>For more information see below</para>
</section>
</section>
<section>
<title>Option style</title>
<para>Since version 0.40 new-style option handling was introduced, using</para>
<itemizedlist>
<listitem>
<para>--in &lt;inputtype&gt;</para>
</listitem>
<listitem>
<para>--out &lt;outputtype&gt;</para>
</listitem>
<listitem>
<para>--action &lt;actiontype&gt;</para>
</listitem>
</itemizedlist>
<para>and many more conversions were added. A built-in check matrix should prevent misconversions.</para>
<para>Up to version 0.39, only old-style options (aka &#8220;shortcut&#8221; options). They are one-in-all options, specifying input/action/output in one token. Internally this options will be converted into new-style options.</para>
</section>
<section>
<title>Online help</title>
<para>Online help always shows the currently implemented features.</para>
<section>
<title>Main online help:</title>
<para>External database options only appear if compiled with related support.</para>
<programlisting language='lyx'>$ ipv6calc -h</programlisting>
<programlisting language='lyx'>ipv6calc: version 4.3.0 GeoIP GeoIPv6 IP2Location IP2Location6 IP2Location2 IP2Location2v6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID DB_IPV4_DUMP_CC DB_IPV6_DUMP_CC ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID</programlisting>
<programlisting language='lyx'>(P) &amp; (C) 2001-2025 by Peter Bieringer &lt;pb (at) bieringer.de&gt;</programlisting>
<programlisting language='lyx'>This program formats and calculates IPv6/IPv4/MAC addresses and can do many more tricky things</programlisting>
<programlisting language='lyx'>  [-d|--debug &lt;debug value&gt;] : debug value (bitwise like)</programlisting>
<programlisting language='lyx'>                                can also be set by IPV6CALC_DEBUG environment value</programlisting>
<programlisting language='lyx'>  [-v|--version [-v [-v]]]   : version information (2 optional detail levels)</programlisting>
<programlisting language='lyx'>  [-v|--version -h]          : explanation of feature tokens</programlisting>
<programlisting language='lyx'>  [-V|--verbose]             : be more verbose</programlisting>
<programlisting language='lyx'>  [-h|--help|-?]             : this online help</programlisting>
<programlisting language='lyx'>  [--disable-ip2location           ] : IP2Location(BIN) support disabled</programlisting>
<programlisting language='lyx'>  [--db-ip2location-disable        ] : IP2Location(BIN) support disabled</programlisting>
<programlisting language='lyx'>  [--db-ip2location-dir &lt;directory&gt;] : IP2Location(BIN) database directory (default: /var/local/share/IP2Location)</programlisting>
<programlisting language='lyx'>  [--db-ip2location-only-type &lt;TYPE&gt;]: IP2Location(BIN) database only selected type (1-666)</programlisting>
<programlisting language='lyx'>  [--db-ip2location-allow-softlinks] : IP2Location(BIN) database softlinks allowed</programlisting>
<programlisting language='lyx'>     by default they are ignored because it is hard to autodetect COMM/LITE/SAMPLE</programlisting>
<programlisting language='lyx'>  [--db-ip2location-lite-to-sample-autoswitch-max-delta-months &lt;MONTHS&gt;]:</programlisting>
<programlisting language='lyx'>     autoswitch from LITE to SAMPLE databases if possible and delta is not more than 12 months (0=disabled)</programlisting>
<programlisting language='lyx'>  [--db-ip2location-comm-to-lite-switch-min-delta-months &lt;MONTHS&gt;]:</programlisting>
<programlisting language='lyx'>     switch from COMM to LITE databases if possible and delta more than 12 months (0=disabled)</programlisting>
<programlisting language='lyx'>  [--disable-ip2location2           ] : IP2Location(MMDB) support disabled</programlisting>
<programlisting language='lyx'>  [--db-ip2location2-disable        ] : IP2Location(MMDB) support disabled</programlisting>
<programlisting language='lyx'>  [--db-ip2location2-dir &lt;directory&gt;] : IP2Location(MMDB) database directory (default: /var/local/share/IP2Location)</programlisting>
<programlisting language='lyx'>  [--db-ip2location2-only-type &lt;TYPE&gt;]: IP2Location(MMDB) database only selected type (1-666)</programlisting>
<programlisting language='lyx'>  [--db-ip2location2-allow-softlinks] : IP2Location(MMDB) database softlinks allowed</programlisting>
<programlisting language='lyx'>     by default they are ignored because it is hard to autodetect COMM/LITE/SAMPLE</programlisting>
<programlisting language='lyx'>  [--db-ip2location2-lite-to-sample-autoswitch-max-delta-months &lt;MONTHS&gt;]:</programlisting>
<programlisting language='lyx'>     autoswitch from LITE to SAMPLE databases if possible and delta is not more than 12 months (0=disabled)</programlisting>
<programlisting language='lyx'>  [--db-ip2location-comm-to-lite-switch-min-delta-months &lt;MONTHS&gt;]:</programlisting>
<programlisting language='lyx'>     switch from COMM to LITE databases if possible and delta more than 12 months (0=disabled)</programlisting>
<programlisting language='lyx'>  [--disable-geoip2                ] : GeoIP(MaxMindDB) support disabled</programlisting>
<programlisting language='lyx'>  [--db-geoip2-disable             ] : GeoIP(MaxMindDB) support disabled</programlisting>
<programlisting language='lyx'>  [--db-geoip2-dir      &lt;directory&gt;] : GeoIP(MaxMindDB) database directory (default: /var/local/share/GeoIP)</programlisting>
<programlisting language='lyx'>  [--disable-dbip2                 ] : db-ip.com(MaxMindDB) support disabled</programlisting>
<programlisting language='lyx'>  [--db-dbip2-disable              ] : db-ip.com(MaxMindDB) support disabled</programlisting>
<programlisting language='lyx'>  [--db-dbip2-dir       &lt;directory&gt;] : db-ip.com(MaxMindDB) database directory (default: /var/local/share/DBIP)</programlisting>
<programlisting language='lyx'>  [--db-dbip2-only-type &lt;TYPE&gt;]      : db-ip.com(MaxMindDB) database only selected type (1-6)</programlisting>
<programlisting language='lyx'>  [--db-dbip2-comm-to-free-switch-min-delta-months &lt;MONTHS&gt;]:</programlisting>
<programlisting language='lyx'>     switch from COMM to FREE databases if possible and delta more than 12 months (0=disabled)</programlisting>
<programlisting language='lyx'>  [--disable-external              ] : External support disabled</programlisting>
<programlisting language='lyx'>  [--db-external-disable           ] : External support disabled</programlisting>
<programlisting language='lyx'>  [--db-external-dir    &lt;directory&gt;] : External database directory (default: /var/local/share/ipv6calc)</programlisting>
<programlisting language='lyx'>  [--disable-builtin               ] : BuiltIn support disabled</programlisting>
<programlisting language='lyx'>  [--db-builtin-disable            ] : BuiltIn support disabled</programlisting>
<programlisting language='lyx'>  [--db-priorization &lt;entry1&gt;[:...]] : Database priorization order list (overwrites default)</programlisting>
<programlisting language='lyx'>                                         colon separated: GeoIP2 IP2Location DBIP2 External BuiltIn IP2Location2</programlisting>
<programlisting language='lyx'> Hint: all long options can be predefined from environment by using</programlisting>
<programlisting language='lyx'>  prefix: IPV6CALC_ and  conversion: '-' -&gt; '_' and lowercase -&gt; uppercase</programlisting>
<programlisting language='lyx'>  example for options with values   : --db-dbip2-dir=&lt;DIR&gt;  -&gt;  environment: IPV6CALC_DB_DBIP2_DIR=&lt;DIR&gt;</programlisting>
<programlisting language='lyx'>  example for options without values: --db-dbip2-disable    -&gt;  environment: IPV6CALC_DB_DBIP2_DISABLE=1</programlisting>
<programlisting language='lyx'>                                                                              on|off|0|1 is supported</programlisting>
<programlisting language='lyx'>  [-q|--quiet]               : be more quiet (auto-enabled in pipe mode)</programlisting>
<programlisting language='lyx'>  [-f|--flush]               : flush each line in pipe mode</programlisting>
<programlisting language='lyx'> Usage with new style options:</programlisting>
<programlisting language='lyx'>  [--in|-I &lt;input type&gt;]   : specify input  type</programlisting>
<programlisting language='lyx'>                             (default: autodetect)</programlisting>
<programlisting language='lyx'>  [--out|-O &lt;output type&gt;] : specify output type</programlisting>
<programlisting language='lyx'>                             (sometimes: autodetect)</programlisting>
<programlisting language='lyx'>  [--action|-A &lt;action&gt;]   : specify action</programlisting>
<programlisting language='lyx'>                             (default: format conversion, sometimes: autodetect)</programlisting>
<programlisting language='lyx'>  [&lt;format option&gt; ...] : specify format options</programlisting>
<programlisting language='lyx'>  &lt;input data&gt; [...]    : input data</programlisting>
<programlisting language='lyx'>  Available input  types:  [-m] -I|--in     -?|-h|--help</programlisting>
<programlisting language='lyx'>  Available output types:  [-m] -O|--out    -?|-h|--help</programlisting>
<programlisting language='lyx'>  Available action types:  [-m] -A|--action -?|-h|--help</programlisting>
<programlisting language='lyx'>  Special filter action :  -E -?|-h|--help</programlisting>
<programlisting language='lyx'> Other usage:</programlisting>
<programlisting language='lyx'>  --showinfo|-i [--machine_readable|-m] : show information about input data</programlisting>
<programlisting language='lyx'>  --showinfo|-i --mrqva                 : Machine Readable Quote Values Always</programlisting>
<programlisting language='lyx'>  --showinfo|-i --mrqvn                 : Machine Readable Quote Values Never</programlisting>
<programlisting language='lyx'>  --showinfo|-i --mrst &lt;TOKEN&gt;          : Machine Readable Select Token</programlisting>
<programlisting language='lyx'>  --showinfo|-i --mrstpa &lt;TOKEN&gt;        : Machine Readable Select Token Print Always</programlisting>
<programlisting language='lyx'>  --showinfo|-i --mrmt &lt;TOKENPREFIX&gt;    : Machine Readable Match Token Prefix</programlisting>
<programlisting language='lyx'>  --showinfo|-i --mrmts &lt;TOKENSUFFIX&gt;   : Machine Readable Match Token Suffix</programlisting>
<programlisting language='lyx'>  --showinfo|-i --mrtvo &lt;TOKEN&gt;         : Machine Readable Token Value Only</programlisting>
<programlisting language='lyx'>  --showinfo|-i --show-tokens           : show available tokens (aka types) on '-m'</programlisting>
<programlisting language='lyx'> Usage with shortcut options: &lt;shortcut option&gt; [&lt;format option&gt; ...] &lt;input data&gt;</programlisting>
<programlisting language='lyx'>  for more information and available format options use: &lt;shortcut option&gt; -?|-h|--help</programlisting>
<programlisting language='lyx'>  -r|--addr2ip6_int (-O revnibbles.int)</programlisting>
<programlisting language='lyx'>  -r|--addr_to_ip6int (-O revnibbles.int)</programlisting>
<programlisting language='lyx'>  -a|--addr2ip6_arpa (-O revnibbles.arpa)</programlisting>
<programlisting language='lyx'>  -a|--addr_to_ip6arpa (-O revnibbles.arpa)</programlisting>
<programlisting language='lyx'>  -b|--addr_to_bitstring (-O bitstring)</programlisting>
<programlisting language='lyx'>     --addr2compaddr (--printcompressed)</programlisting>
<programlisting language='lyx'>     --addr_to_compressed (--printcompressed)</programlisting>
<programlisting language='lyx'>     --addr2uncompaddr (--printuncompressed)</programlisting>
<programlisting language='lyx'>     --addr_to_uncompressed (--printuncompressed)</programlisting>
<programlisting language='lyx'>     --addr_to_base85 (-I ipv6addr -O base85)</programlisting>
<programlisting language='lyx'>     --base85_to_addr (-I base85 -O ipv6addr)</programlisting>
<programlisting language='lyx'>     --mac_to_eui64 (-I mac -O eui64)</programlisting>
<programlisting language='lyx'>     --addr2fulluncompaddr (--printfulluncompressed)</programlisting>
<programlisting language='lyx'>     --addr_to_fulluncompressed (--printfulluncompressed)</programlisting>
<programlisting language='lyx'>     --addr2if_inet6 (-I ipv6addr -O ifinet6)</programlisting>
<programlisting language='lyx'>     --addr_to_ifinet6 (-I ipv6addr -O ifinet6)</programlisting>
<programlisting language='lyx'>     --if_inet62addr (-I ifinet6 -O ipv6addr --printcompressed)</programlisting>
<programlisting language='lyx'>     --ifinet6_to_compressed (-I ifinet6 -O ipv6addr --printcompressed)</programlisting>
<programlisting language='lyx'>     --eui64_to_privacy (-I iid_token -O iid_token -A genprivacyiid)</programlisting>
<programlisting language='lyx'>     --ipv4_to_6to4addr (-I ipv4 -O ipv6addr -A conv6to4)</programlisting>
<programlisting language='lyx'>     --addr2cc (-A addr2cc)</programlisting>
</section>
<section>
<title>Database options</title>
<itemizedlist>
<listitem>
<para>each internal/external database can be disabled by option</para>
</listitem>
<listitem>
<para>directory of database files can be given via related option</para>
</listitem>
<listitem>
<para>databases requiring external library the library file can be given in case of dynamic load and linking</para>
</listitem>
<listitem>
<para>for geolocation databases specific file can be selected (see --db-&lt;PROVIDER&gt;-only-type &lt;TYPE&gt;)</para>
</listitem>
</itemizedlist>
<section>
<title>IP2Location(BIN)</title>
<para>IP2location database directory can contain a bunch of files, the best ones are selected automatically (since 0.99.0). &#8220;Best&#8221; can be controlled via two options:</para>
<itemizedlist>
<listitem>
<para>--db-ip2location-lite-to-sample-autoswitch-max-delta-months &lt;MONTHS&gt;: switches from LITE to SAMPLE databases in case of</para>
</listitem>
<listitem>
<para>--db-ip2location2-lite-to-sample-autoswitch-max-delta-months &lt;MONTHS&gt;: switches from LITE to SAMPLE databases in case of</para>
<itemizedlist>
<listitem>
<para>existing SAMPLE database</para>
</listitem>
<listitem>
<para>SAMPLE database not older than default/given MONTHS than the LITE database</para>
</listitem>
<listitem>
<para>IP address is in range of SAMPLE database (IPv4: 0.0.0.0-99.255.255.255, IPv6: 2a04::/16)</para>
</listitem>
<listitem>
<para>autoswitch can be disabled by using MONTHS=0</para>
</listitem>
<listitem>
<para>reason for implementation: show maximum possible IP2Location features</para>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<para>--db-ip2location-comm-to-lite-switch-min-delta-months &lt;MONTHS&gt;: switches from COMMercial to LITE databases in case of</para>
</listitem>
<listitem>
<para>--db-ip2location2-comm-to-lite-switch-min-delta-months &lt;MONTHS&gt;: switches from COMMercial to LITE databases in case of</para>
<itemizedlist>
<listitem>
<para>existing LITE database</para>
</listitem>
<listitem>
<para>COMMercial database is default/given MONTHS older than the LITE database</para>
</listitem>
<listitem>
<para>switch can be disabled by using MONTHS=0</para>
</listitem>
<listitem>
<para>reason for implementation: avoid using old COMMercial databases</para>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<para>--db-ip2location-only-type &lt;TYPE&gt;: only selects databases of given type</para>
</listitem>
<listitem>
<para>--db-ip2location2-only-type &lt;TYPE&gt;: only selects databases of given type</para>
<itemizedlist>
<listitem>
<para>reason for implementation: be able to select a specific database type</para>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<para>--db-ip2location-allow-softlinks: allow softlinked IP2Location database files</para>
</listitem>
<listitem>
<para>--db-ip2location-allow-softlinks: allow softlinked IP2Location database files</para>
<itemizedlist>
<listitem>
<para>by default, softlinked database files are skipped, because it&#8217;s hard to detect whether one is COMMercial, LITE or SAMPLE</para>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
<para>use &#8220;ipv6calc -vv&#8221; or &#8220;ipv6calc -vvv&#8221; for verification, which databases are selected finally.</para>
</section>
</section>
<section>
<title>Input-type options</title>
<programlisting language='lyx'>$ ipv6calc --in -?</programlisting>
<programlisting language='lyx'>ipv6calc: version 4.2.0 GeoIP GeoIPv6 IP2Location IP2Location6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID DB_IPV4_DUMP_CC ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID</programlisting>
<programlisting language='lyx'>(P) &amp; (C) 2001-2023 by Peter Bieringer &lt;pb (at) bieringer.de&gt;</programlisting>
<programlisting language='lyx'> Available input types:</programlisting>
<programlisting language='lyx'>  auto            : automatic detection</programlisting>
<programlisting language='lyx'>  revnibbles.int  : dot separated nibbles reverse, ending with ip6.int.</programlisting>
<programlisting language='lyx'>  revnibbles.arpa : dot separated nibbles reverse, ending with ip6.arpa.</programlisting>
<programlisting language='lyx'>  bitstring       : bitstring labes, ending with ip6.arpa.</programlisting>
<programlisting language='lyx'>  ipv6addr        : IPv6 address</programlisting>
<programlisting language='lyx'>  ipv6literal     : IPv6 address in literal</programlisting>
<programlisting language='lyx'>  ipv4addr        : IPv4 address</programlisting>
<programlisting language='lyx'>  ipv4hex         : IPv4 in hexadecimal format</programlisting>
<programlisting language='lyx'>  ipv4revhex      : IPv4 in byte-reversed hexadecimal format</programlisting>
<programlisting language='lyx'>  mac             : MAC address (48 bits)</programlisting>
<programlisting language='lyx'>  eui64           : EUI-64 identifier (64 bits)</programlisting>
<programlisting language='lyx'>  base85          : Base-85 string</programlisting>
<programlisting language='lyx'>  ifinet6         : Like line in /proc/net/if_inet6</programlisting>
<programlisting language='lyx'>  iid+token       : Interface identifier and token</programlisting>
<programlisting language='lyx'>  ipv6logconv     : ipv6logconv (currently not supported)</programlisting>
<programlisting language='lyx'>  prefix+mac      : IPv6 prefix and a MAC address</programlisting>
<programlisting language='lyx'>  asn             : Autonomous System Number</programlisting>
</section>
<section>
<title>Output-type options:</title>
<programlisting language='lyx'>$ ipv6calc --out -?</programlisting>
<programlisting language='lyx'>ipv6calc: version 4.2.0 GeoIP GeoIPv6 IP2Location IP2Location6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID DB_IPV4_DUMP_CC ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID</programlisting>
<programlisting language='lyx'>(P) &amp; (C) 2001-2023 by Peter Bieringer &lt;pb (at) bieringer.de&gt;</programlisting>
<programlisting language='lyx'> Available output types:</programlisting>
<programlisting language='lyx'>  revnibbles.int  : dot separated nibbles reverse, ending with ip6.int.</programlisting>
<programlisting language='lyx'>  revnibbles.arpa : dot separated nibbles reverse, ending with ip6.arpa.</programlisting>
<programlisting language='lyx'>  bitstring       : bitstring labes, ending with ip6.arpa.</programlisting>
<programlisting language='lyx'>  ipv6addr        : IPv6 address</programlisting>
<programlisting language='lyx'>  ipv4addr        : IPv4 address</programlisting>
<programlisting language='lyx'>  mac             : MAC address (48 bits)</programlisting>
<programlisting language='lyx'>  eui64           : EUI-64 identifier (64 bits)</programlisting>
<programlisting language='lyx'>  base85          : Base-85 string</programlisting>
<programlisting language='lyx'>  ifinet6         : Like line in /proc/net/if_inet6</programlisting>
<programlisting language='lyx'>  iid             : Interface identifier</programlisting>
<programlisting language='lyx'>  iid+token       : Interface identifier and token</programlisting>
<programlisting language='lyx'>  addrtype        : Address type</programlisting>
<programlisting language='lyx'>  ouitype         : OUI (IEEE) type</programlisting>
<programlisting language='lyx'>  ipv6addrtype    : IPv6 address type</programlisting>
<programlisting language='lyx'>  any             : any type (currently not supported)</programlisting>
<programlisting language='lyx'>  revipv4         : reverse IPv4, ending with in-addr.arpa</programlisting>
<programlisting language='lyx'>  ipv4hex         : IPv4 in hexadecimal format</programlisting>
<programlisting language='lyx'>  octal           : IP address in escaped octal format</programlisting>
<programlisting language='lyx'>  hex             : IP address in hexadecimal format</programlisting>
<programlisting language='lyx'>  ipv6literal     : IPv6 address in literal</programlisting>
<programlisting language='lyx'>  ipv6to4         : IPv6 address based on 6to4 converted IPv4 address</programlisting>
<programlisting language='lyx'>For examples and available format options use:</programlisting>
<programlisting language='lyx'>    -O|--out &lt;type&gt; --examples</programlisting>
</section>
<section>
<title>Action-type options: </title>
<programlisting language='lyx'>$ ipv6calc --action -?</programlisting>
<programlisting language='lyx'>ipv6calc: version 4.2.0 GeoIP GeoIPv6 IP2Location IP2Location6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID DB_IPV4_DUMP_CC ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID</programlisting>
<programlisting language='lyx'>(P) &amp; (C) 2001-2023 by Peter Bieringer &lt;pb (at) bieringer.de&gt;</programlisting>
<programlisting language='lyx'> Available action types:</programlisting>
<programlisting language='lyx'>  auto             : Automatic selection of action (default)</programlisting>
<programlisting language='lyx'>  geneui64         : Converts a MAC address to an EUI-64 address</programlisting>
<programlisting language='lyx'>  conv6to4         : Converts IPv4 address &lt;-&gt; 6to4 IPv6 address (prefix)</programlisting>
<programlisting language='lyx'>  convnat64        : Converts IPv4 address &lt;-&gt; NAT64 IPv6 address</programlisting>
<programlisting language='lyx'>  ipv6tomac        : Extracts MAC of an IPv6 address (if detected)</programlisting>
<programlisting language='lyx'>  ipv6toeui64      : Extracts EUI64 of an IPv6 address (if detected)</programlisting>
<programlisting language='lyx'>  genprivacyiid    : Generates a privacy interface ID out of a given one (arg1) and a token (arg2)</programlisting>
<programlisting language='lyx'>  prefixmac2ipv6   : Generates an IPv6 address out of a prefix and a MAC address</programlisting>
<programlisting language='lyx'>  anonymize        : Anonymize IPv4/IPv6 address without loosing much information</programlisting>
<programlisting language='lyx'>  6rd_local_prefix : Calculate the 6rd prefix from given IPv6 prefix (&amp; relay prefix) and IPv4</programlisting>
<programlisting language='lyx'>                      Options:</programlisting>
<programlisting language='lyx'>                       --6rd_prefix ... (required)</programlisting>
<programlisting language='lyx'>                       --6rd_relay_prefix ... (optional)</programlisting>
<programlisting language='lyx'>  6rd_extract_ipv4 : Extract from 6rd address the include IPv4 address</programlisting>
<programlisting language='lyx'>                      Options:</programlisting>
<programlisting language='lyx'>                       --6rd_prefixlength ... (required)</programlisting>
<programlisting language='lyx'>  filter           : Filter addresses related to filter options</programlisting>
<programlisting language='lyx'>  test             : Test address against given prefix or address</programlisting>
<programlisting language='lyx'>                      Options:</programlisting>
<programlisting language='lyx'>                       --test_prefix ... (optional)</programlisting>
<programlisting language='lyx'>                       --test_gt ... (optional)</programlisting>
<programlisting language='lyx'>                       --test_ge ... (optional)</programlisting>
<programlisting language='lyx'>                       --test_lt ... (optional)</programlisting>
<programlisting language='lyx'>                       --test_le ... (optional)</programlisting>
<programlisting language='lyx'>  addr2cc          : Converts IPv4/IPv6 address into Country Code</programlisting>
<programlisting language='lyx'>  dbdump           : Dump Database</programlisting>
</section>
<section>
<title>Special action &#8220;filter&#8221;:</title>
<para>Special action &#8220;filter&#8221; can be used especially in pipe mode to filter IP addresses related to their type and since 0.99.0 also related to database results (CountryCode, ASN or Registry).</para>
<programlisting language='lyx'>$ ipv6calc --action filter -h</programlisting>
<programlisting language='lyx'>ipv6calc: version 4.2.0 GeoIP GeoIPv6 IP2Location IP2Location6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID DB_IPV4_DUMP_CC ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID</programlisting>
<programlisting language='lyx'> Filter given addresses from stdin by filter expression, e.g.</programlisting>
<programlisting language='lyx'>  echo '2001:db8::1' | ipv6calc [-A filter] -E iid-local</programlisting>
<programlisting language='lyx'>  echo '2001:db8::1' | ipv6calc [-A filter] -E iid-local,global-unicast</programlisting>
<programlisting language='lyx'>  echo '2001:db8::1' | ipv6calc [-A filter] -E ^iid-random</programlisting>
<programlisting language='lyx'> (note: since version 0.95.0 '-A filter' is autoselected if option '-E &lt;filter expression&gt;' is given)</programlisting>
<programlisting language='lyx'> negation of filter expression with prefix: ^</programlisting>
<programlisting language='lyx'>  IPv6 address filter tokens:</programlisting>
<programlisting language='lyx'>   ipv6  unknown unicast multicast anycast loopback link-local site-local compat-v4 mapped reserved unique-local-unicast anonymized-iid anonymized-prefix 6to4 6bone global-unicast unspecified solicited-node productive 6to4-microsoft teredo orchid link-local-teredo nat64 iid-random iid iid-local iid-global iid-teredo iid-eui48 iid-eui64 iid-isatap iid-includes-ipv4</programlisting>
<programlisting language='lyx'>  IPv4 address filter tokens:</programlisting>
<programlisting language='lyx'>   ipv4  any unicast multicast anycast broadcast loopback unspecified unknown reserved zeroconf site-local anonymized anonymized-geonameid global 6to4relay lisp lisp-proxyegresstunnelrouter-anycast lisp-mapresolver-anycast</programlisting>
<programlisting language='lyx'>  IPv4/v6 address filter tokens based on databases:</programlisting>
<programlisting language='lyx'>   [^][ipv4.|ipv6.]db.cc=&lt;CC&gt;|unknown (Country Code [2 chars])</programlisting>
<programlisting language='lyx'>   [^][ipv4.|ipv6.]db.asn=&lt;ASN&gt;|unknown (Autonomous System Number)</programlisting>
<programlisting language='lyx'>   [^][ipv4.|ipv6.]db.reg=&lt;REGISTRY&gt;</programlisting>
<programlisting language='lyx'>    Registry tokens: 6BONE IANA APNIC ARIN RIPENCC LACNIC AFRINIC 6TO4 reserved unknown</programlisting>
<programlisting language='lyx'>  IPv4/v6 address filter tokens based on address/mask:</programlisting>
<programlisting language='lyx'>   [^]ipv4.addr=&lt;IPV4-ADDRESS&gt;[&lt;PREFIX-LENGTH&gt;]</programlisting>
<programlisting language='lyx'>   [^]ipv6.addr=&lt;IPV6-ADDRESS&gt;[&lt;PREFIX-LENGTH&gt;]</programlisting>
<programlisting language='lyx'>  IPv4/v6 address filter tokens based on address ranges (&lt;=|&lt;|&gt;|&gt;=):</programlisting>
<programlisting language='lyx'>   [^]ipv4.addr(&lt;=|&lt;|&gt;|&gt;=)&lt;IPV4-ADDRESS&gt;</programlisting>
<programlisting language='lyx'>   [^]ipv6.addr(&lt;=|&lt;|&gt;|&gt;=)&lt;IPV6-ADDRESS&gt;</programlisting>
<programlisting language='lyx'>   as alternative in case &lt;|&gt; creating problems also supported: =(le|lt|gt|ge)=:</programlisting>
<programlisting language='lyx'>   [^]ipv4.addr=(le|lt|gt|ge)=&lt;IPV4-ADDRESS&gt;</programlisting>
<programlisting language='lyx'>   [^]ipv6.addr=(le|lt|gt|ge)=&lt;IPV6-ADDRESS&gt;</programlisting>
<programlisting language='lyx'>  EUI-48/MAC address filter tokens:</programlisting>
<programlisting language='lyx'>    IMPLEMENTATION MISSING</programlisting>
<programlisting language='lyx'>  EUI-64 address filter tokens:</programlisting>
<programlisting language='lyx'>    IMPLEMENTATION MISSING</programlisting>
<para>Example for some filter expressions:</para>
<programlisting language='lyx'>$ cat ip.bieringer.de-log.201504 | ipv6calc -E ipv6.db.cc=DE | wc -l</programlisting>
<programlisting language='lyx'>5068</programlisting>
<programlisting language='lyx'>$ cat ip.bieringer.de-log.201504 | ipv6calc -E ipv6.db.cc=US | wc -l</programlisting>
<programlisting language='lyx'>305</programlisting>
<programlisting language='lyx'>$ cat ip.bieringer.de-log.201504 | ipv6calc -E ipv6.db.reg=ARIN | wc -l</programlisting>
<programlisting language='lyx'>306</programlisting>
<programlisting language='lyx'>$ cat ip.bieringer.de-log.201504 | ipv6calc -E iid-random | wc -l</programlisting>
<programlisting language='lyx'>4806</programlisting>
<programlisting language='lyx'>$ cat ip.bieringer.de-log.201504 | ipv6calc -E ipv6.db.cc=US,iid-random | wc -l</programlisting>
<programlisting language='lyx'>16</programlisting>
<programlisting language='lyx'>$ cat ip.bieringer.de-log.201504 | ipv6calc -A filter -E ipv6.db.cc=US,iid-random,ipv4.db.cc=US | wc -l</programlisting>
<programlisting language='lyx'>1842</programlisting>
<programlisting language='lyx'>$ cat ip.bieringer.de-log.201504 | ipv6calc -A filter -E db.asn=8767 | wc -l</programlisting>
<programlisting language='lyx'>2363</programlisting>
<programlisting language='lyx'>$ cat ip.bieringer.de-log.201504 | ipv6calc -A filter -E ipv6.db.asn=8767 | wc -l</programlisting>
<programlisting language='lyx'>1452</programlisting>
<programlisting language='lyx'>$ cat ip.bieringer.de-log.201504 | ipv6calc -A filter -E ipv4.db.asn=8767 | wc -l</programlisting>
<programlisting language='lyx'>911</programlisting>
<para>Example for searching for addresses in a specific range (supported since 0.99.2):</para>
<programlisting language='lyx'>$ cat ip.bieringer.de-log.201609 | awk '{ print $1 }' | sort | uniq | ipv6calc -E ipv6.addr=ge=2002::,ipv6.addr=lt=2003::</programlisting>
<programlisting language='lyx'>2002:2518:0:1:2:3:4:5</programlisting>
<programlisting language='lyx'>...</programlisting>
<programlisting language='lyx'>2002:d950:0:1:2:3:4:5</programlisting>
</section>
<section>
<title>Special action &#8220;test&#8221;:</title>
<para>Special action &#8220;test&#8221; (since 0.99.2) can be used in command line or pipe mode (single address only) to test IP addresses related to a given prefix or range .</para>
<programlisting language='lyx'>$ ipv6calc -A test -?</programlisting>
<programlisting language='lyx'>ipv6calc: version 2.1.1 GeoIP GeoIPv6 IP2Location IP2Location6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID</programlisting>
<programlisting language='lyx'> Test given address(es) against supported tests:</programlisting>
<programlisting language='lyx'>  --test_prefix &lt;PREFIX&gt;       : inside a prefix</programlisting>
<programlisting language='lyx'>  --test_gt|--test_ge &lt;ADDRESS&gt;: greater(/equal) than an address</programlisting>
<programlisting language='lyx'>  --test_lt|--test_le &lt;ADDRESS&gt;: less(/equal) than an address</programlisting>
<programlisting language='lyx'> Test given address(es) from stdin, e.g.</programlisting>
<programlisting language='lyx'>  echo '2001:db8::1' | ipv6calc [-A test] --test_prefix 2001:db8::/32</programlisting>
<programlisting language='lyx'>  echo '2001:db8::1' | ipv6calc [-A test] --test_prefix 2001:db9::/32</programlisting>
<programlisting language='lyx'> Single address test, return code: 0=inside/matching 1=outside/not-matching 2=uncomparable</programlisting>
<programlisting language='lyx'>  ipv6calc [-A test] --test_prefix 2001:db8::/32 2001:db8::1</programlisting>
<programlisting language='lyx'>  ipv6calc [-A test] --test_prefix 2001:db9::/32 2001:db8::1</programlisting>
<programlisting language='lyx'>  ipv6calc [-A test] --test_ge 2001:db8:: --test_le 2001:db8:ffff:ffff:ffff:ffff:ffff:ffff 2001:db8::1</programlisting>
<programlisting language='lyx'>  ipv6calc [-A test] --test_ge 2001:db9:: --test_le 2001:db9:ffff:ffff:ffff:ffff:ffff:ffff 2001:db8::1</programlisting>
<programlisting language='lyx'>  ipv6calc [-A test] --test_ge 2001:db9:: --test_lt 2001:dba:: 2001:db8::1</programlisting>
<programlisting language='lyx'>  ipv6calc [-A test] --test_ge 2001:db8:: --test_lt 2001:db9:: 2001:db8::1</programlisting>
<para>Example for command line mode:</para>
<programlisting language='lyx'>$ ipv6calc --test_ge 2001:db8:: --test_le 2001:db8:ffff:ffff:ffff:ffff:ffff:ffff 2001:db8::1; echo $?</programlisting>
<programlisting language='lyx'>no input type specified, try autodetection...found type: ipv6addr</programlisting>
<programlisting language='lyx'>no output type specified, try autodetection...found type: ipv6addr</programlisting>
<programlisting language='lyx'>2001:db8::1   greater/equal than 2001:db8::  less/equal than 2001:db8:ffff:ffff:ffff:ffff:ffff:ffff</programlisting>
<programlisting language='lyx'>0</programlisting>
<para>Example for command line mode (quiet):</para>
<programlisting language='lyx'>$ ipv6calc -q --test_ge 2001:db8:: --test_le 2001:db8:ffff:ffff:ffff:ffff:ffff:ffff 2001:db8::1; echo $?</programlisting>
<programlisting language='lyx'>2001:db8::1   greater/equal than 2001:db8::  less/equal than 2001:db8:ffff:ffff:ffff:ffff:ffff:ffff</programlisting>
<programlisting language='lyx'>0</programlisting>
<para>Example for pipe mode:</para>
<programlisting language='lyx'>$ echo -e "1.2.3.4\n1.2.4.4" | ipv6calc --test_prefix 1.2.3.0/24</programlisting>
<programlisting language='lyx'>1.2.3.4   inside 1.2.3.0/24</programlisting>
<programlisting language='lyx'>1.2.4.4   NOT inside 1.2.3.0/24</programlisting>
</section>
<section>
<title>Special action &#8220;conv6to4&#8221;:</title>
<para>Special action &#8220;conv6to4&#8221; (since at least 0.99.1) can be used in command line or pipe mode to convert 6to4-IPv6 in IPv4 addresses and vice versa.</para>
<programlisting language='lyx'>$ ipv6calc: version 3.2.1 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO ANON_ZEROISE ANON_ANONYMIZE</programlisting>
<programlisting language='lyx'>  Convert IPv4 to 6to4 prefix / extract IPv4 from 6to4 prefix</programlisting>
<programlisting language='lyx'>   ipv6calc -A conv6to4 192.0.2.1          -&gt; 2002:c000:201::</programlisting>
<programlisting language='lyx'>   ipv6calc -A conv6to4 192.0.2.1/24       -&gt; 2002:c000:200::/40</programlisting>
<programlisting language='lyx'>   ipv6calc -A conv6to4 192.0.2.0/24       -&gt; 2002:c000:200::/40</programlisting>
<programlisting language='lyx'>   ipv6calc -A conv6to4 2002:c000:201::    -&gt; 192.0.2.1</programlisting>
<programlisting language='lyx'>   ipv6calc -A conv6to4 2002:c000:201::/40 -&gt; 192.0.2.0/24</programlisting>
<programlisting language='lyx'>  See '-O ipv4 -h' or '-O ipv6 -h' for optional output modifications</programlisting>
<programlisting language='lyx'>  Can also be used in PIPE mode to convert a list of IP addresses/networks</programlisting>
<para>Example for command line mode:</para>
<programlisting language='lyx'>$ ipv6calc -q -A conv6to4 192.0.2.1</programlisting>
<programlisting language='lyx'>2002:c000:201::</programlisting>
<para>Example for pipe mode:</para>
<programlisting language='lyx'>echo -e "1.2.3.4\n1.2.4.4" | ipv6calc -A conv6to4</programlisting>
<programlisting language='lyx'>2002:102:304::</programlisting>
<programlisting language='lyx'>2002:102:404::</programlisting>
<programlisting language='lyx'>$ echo -e "1.2.3.0/24\n1.2.4.0/24" | ipv6calc -A conv6to4</programlisting>
<programlisting language='lyx'>2002:102:300::/40</programlisting>
<programlisting language='lyx'>2002:102:400::/40</programlisting>
</section>
<section>
<title>Special action &#8220;dbdump&#8221;:</title>
<para>Since version 3.3.0, action &#8220;dbdump&#8221; is provided</para>
<itemizedlist>
<listitem>
<para>Version &gt;= 3.3.0: database &#8220;External&#8221;, type: IPv4/IPv6 addresses, suppported filter: CountryCode</para>
</listitem>
</itemizedlist>
<para>Precondition: created/updated &#8220;External&#8221; database</para>
<programlisting language='lyx'>$ /usr/share/ipv6calc/tools/ipv6calc-db-update.sh</programlisting>
<programlisting language='lyx'>...</programlisting>
<para>Precondition: active &#8220;database dump&#8221; support</para>
<programlisting language='lyx'>$ ipv6calc -vv 2&gt;&amp;1 | grep -E '(DB_IPV4_DUMP_CC|DB_IPV6_DUMP_CC)'</programlisting>
<programlisting language='lyx'>ipv6calc: version 3.3.0 GeoIP GeoIPv6 IP2Location IP2Location6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID DB_IPV4_DUMP_CC DB_IPV6_DUMP_CC ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID </programlisting>
<programlisting language='lyx'>DB_IPV4_DUMP_CC (IPv4 Database Dump by CountryCode): External</programlisting>
<programlisting language='lyx'>DB_IPV6_DUMP_CC (IPv6 Database Dump by CountryCode): External </programlisting>
<para>Precondition: recognized &#8220;External&#8221; database</para>
<programlisting language='lyx'>$ ipv6calc -vv 2&gt;&amp;1 | grep -E '(External: IPv. CountryCode)'</programlisting>
<programlisting language='lyx'>External: IPv4 CountryCode    : ipv6calc-external-ipv4-countrycode.db    (EXTDB-3/AFRINIC/20210919 APNIC/20210917 ARIN/20210919 IANA/20210205 LACNIC/20210918 LISP/20200318 RIPENCC/20210918, created: 20210919-152957 UTC)</programlisting>
<programlisting language='lyx'>External: IPv6 CountryCode    : ipv6calc-external-ipv6-countrycode.db    (EXTDB-4/AFRINIC/20210919 APNIC/20210917 ARIN/20210919 IANA/20191106 LACNIC/20210918 LISP/20200318 RIPENCC/20210918, created: 20210919-155049 UTC) </programlisting>
<para>Usage Example: dump all IPv4 networks which have not &#8220;unknown&#8221; CountryCode</para>
<programlisting language='lyx'>$ ipv6calc -A dbdump -E ^ipv4.db.cc=unknown</programlisting>
<programlisting language='lyx'># 'External' database dump (with 121894 entries) start with filter IPv4 &amp;&amp; CountryCode(s): ^unknown (suppress this line with option '-q')</programlisting>
<programlisting language='lyx'>1.0.0.0/24</programlisting>
<programlisting language='lyx'>1.0.1.0/24</programlisting>
<programlisting language='lyx'>...</programlisting>
<programlisting language='lyx'># 'External' database dump finished displaying 121894 entries with filter IPv4 &amp;&amp; CountryCode(s): ^unknown (suppress this line with option '-q') </programlisting>
<para>Usage Example: dump all IPv6 networks of a given CountryCode </para>
<programlisting language='lyx'>$ ipv6calc -A dbdump -E ipv6.db.cc=VN</programlisting>
<programlisting language='lyx'># 'External' database dump (with 56097 entries) start with filter IPv6 &amp;&amp; CountryCode(s): VN (suppress this line with option '-q')</programlisting>
<programlisting language='lyx'>2001:7fa:6::/28</programlisting>
<programlisting language='lyx'>2001:dc8::/28 </programlisting>
<programlisting language='lyx'>...</programlisting>
<programlisting language='lyx'># 'External' database dump finished displaying 344 entries with filter IPv6 &amp;&amp; CountryCode(s): VN (suppress this line with option '-q') </programlisting>
<para>Usage Example: dump all IPv4 networks of two given CountryCodes</para>
<programlisting language='lyx'>$ ipv6calc -A dbdump -E ipv4.db.cc=VN,ipv4.db.cc=CN</programlisting>
<programlisting language='lyx'># 'External' database dump (with 121894 entries) start with filter IPv4 &amp;&amp; CountryCode(s): VN CN (suppress this line with option '-q')</programlisting>
<programlisting language='lyx'>1.0.1.0/24</programlisting>
<programlisting language='lyx'>1.0.2.0/23 </programlisting>
<programlisting language='lyx'>...</programlisting>
<programlisting language='lyx'># 'External' database dump finished displaying 4631 entries with filter IPv4 &amp;&amp; CountryCode(s): VN CN (suppress this line with option '-q') </programlisting>
<para>Usage Example: dump all IPv4 networks of a given CountryCode incl. automatic conversion into 6to4 addresses</para>
<programlisting language='lyx'>$ ipv6calc -A dbdump -E ipv4.db.cc=VN -I ipv4 -O ipv6to4</programlisting>
<programlisting language='lyx'># 'External' database dump (with 121894 entries) start with filter IPv4 &amp;&amp; CountryCode(s): VN (output format: 6to4) (suppress this line with option '-q')</programlisting>
<programlisting language='lyx'>2002:134::/30</programlisting>
<programlisting language='lyx'>2002:e00:1000::/36 </programlisting>
<programlisting language='lyx'>...</programlisting>
<programlisting language='lyx'># 'External' database dump finished displaying 569 entries with filter IPv4 &amp;&amp; CountryCode(s): VN (output format: 6to4) (suppress this line with option '-q') </programlisting>
<para>Usage Example: dump all IPv6to4 networks of a given CountryCode in &#8220;ipset restore&#8221; compatible format and create/update &#8220;ipset&#8221; (related &#8220;sudo&#8221; command whitelist have to be created in advance)</para>
<programlisting language='lyx'>$ ipv6calc -A dbdump -E ipv4.db.cc=VN -I ipv4 -O ipv6to4 -q --print-ipset Net_VN_IPv6to4 &gt;/path/to/ipset-Net_VN_IPv6to4.txt</programlisting>
<programlisting language='lyx'>$ sudo ipset restore -f /path/to/ipset-Net_VN_IPv6to4.txt</programlisting>
<programlisting language='lyx'>$ sudo ipset list Net_VN_IPv6to4 -t</programlisting>
<programlisting language='lyx'>Name: Net_VN_IPv6to4</programlisting>
<programlisting language='lyx'>Type: hash:net</programlisting>
<programlisting language='lyx'>Revision: 7</programlisting>
<programlisting language='lyx'>Header: family inet6 hashsize 1024 maxelem 65536 bucketsize 12 initval 0x30b0bdaf</programlisting>
<programlisting language='lyx'>Size in memory: 41344</programlisting>
<programlisting language='lyx'>References: 0</programlisting>
<programlisting language='lyx'>Number of entries: 723 </programlisting>
<para>Hint: try also helper script for &#8217;ipset&#8217; management</para>
<programlisting language='lyx'>$ tools/ipv6calc-create-update-ipset.sh</programlisting>
</section>
</section>
</section>
<section>
<title>Webserver log conversion helper program "ipv6logconv"</title>
<para>This program parses address tokens of a given webserver logfile and converts them to special strings, useful for statistics (e.g. created by using "analog").</para>
<section>
<title>Supported options</title>
<programlisting language='lyx'>$ ipv6logconv -h</programlisting>
<programlisting language='lyx'>ipv6logconv: version 4.3.0 CONV_REG CONV_IEEE</programlisting>
<programlisting language='lyx'>(P) &amp; (C) 2002-2025 by Peter Bieringer &lt;pb (at) bieringer.de&gt;</programlisting>
<programlisting language='lyx'>This program converts IPv4/IPv6 addresses in HTTP server log files</programlisting>
<programlisting language='lyx'>  [-d|--debug &lt;debug value&gt;] : debug value (bitwise like)</programlisting>
<programlisting language='lyx'>                                can also be set by IPV6CALC_DEBUG environment value</programlisting>
<programlisting language='lyx'>  [-v|--version [-v [-v]]]   : version information (2 optional detail levels)</programlisting>
<programlisting language='lyx'>  [-v|--version -h]          : explanation of feature tokens</programlisting>
<programlisting language='lyx'>  [-V|--verbose]             : be more verbose</programlisting>
<programlisting language='lyx'>  [-h|--help|-?]             : this online help</programlisting>
<programlisting language='lyx'> Hint: all long options can be predefined from environment by using</programlisting>
<programlisting language='lyx'>  prefix: IPV6CALC_ and  conversion: '-' -&gt; '_' and lowercase -&gt; uppercase</programlisting>
<programlisting language='lyx'>  example for options with values   : --db-dbip2-dir=&lt;DIR&gt;  -&gt;  environment: IPV6CALC_DB_DBIP2_DIR=&lt;DIR&gt;</programlisting>
<programlisting language='lyx'>  example for options without values: --db-dbip2-disable    -&gt;  environment: IPV6CALC_DB_DBIP2_DISABLE=1</programlisting>
<programlisting language='lyx'>                                                                              on|off|0|1 is supported</programlisting>
<programlisting language='lyx'> Performance options:</programlisting>
<programlisting language='lyx'>  [-n|--nocache]            : disable caching</programlisting>
<programlisting language='lyx'>  [-c|--cachelimit &lt;value&gt;] : set cache limit</programlisting>
<programlisting language='lyx'>                               default: 20</programlisting>
<programlisting language='lyx'>                               maximum: 200</programlisting>
<programlisting language='lyx'> Output options:</programlisting>
<programlisting language='lyx'>  [--out &lt;output type&gt;] : specify output type</programlisting>
<programlisting language='lyx'>   addrtype       : Address type</programlisting>
<programlisting language='lyx'>   ouitype        : OUI (IEEE) type</programlisting>
<programlisting language='lyx'>   ipv6addrtype   : IPv6 address type</programlisting>
<programlisting language='lyx'>   any            : any type</programlisting>
<programlisting language='lyx'> Takes data from stdin, proceed it to stdout</programlisting>
</section>
<section>
<title>Examples</title>
<para>A demonstration about which kind of statistics are possible to produce is shown at <link xlink:href="http://www.ipv6.bieringer.de/">http://www.ipv6.bieringer.de/</link> (IPv6 only).</para>
</section>
<section>
<title>Usage</title>
<para>Example:</para>
<programlisting language='lyx'>$ echo "2002:50b5:7940:0000:0000:0000:50b5:7940 - -" | ipv6logconv -q --out any</programlisting>
<programlisting language='lyx'>RIPENCC.6to4.global-unicast.ipv6-addr.addrtype.ipv6calc</programlisting>
<para>See more examples inside the package.</para>
</section>
</section>
<section>
<title>Webserver log anonymization helper program "ipv6loganon"</title>
<para>On autoconfiguration, the interface part of an IPv6 address is based on the MAC address of the network interface card (NIC). This address is used for outgoing requests, if privacy option (RFC3041 / RFC4941) is not enabled. This results in many privacy related information on web- or mail-server log files. Administrators, which won&#8217;t (be allowed to) store such information over time, but still do not want to loose information about address type distribution should use &#8217;ipv6loganon&#8217; to anonymize their log files.</para>
<para>Since version 0.94.0 internally also IID anonymization is possible without loosing any information for &#8220;ipv6logstats&#8221;.</para>
<para>Since version 0.95.0 internally also prefix anonymization is possible without loosing any information for &#8220;ipv6logstats&#8221;.</para>
<section>
<title>Anonymization details</title>
<section>
<title>Method &#8220;zeroize&#8221;</title>
<para>The anonymizer would keep as much information as possible for IPv6 address types.</para>
<para>Client-side IID would be anonymized by</para>
<itemizedlist>
<listitem>
<para>EUI-48 based: serial number would be zero&#8217;ed, keeping OID</para>
</listitem>
<listitem>
<para>EUI-64 based: serial number would be zero&#8217;ed, keeping OID</para>
</listitem>
<listitem>
<para>ISATAP: client IPv4 address would be anonymized by given IPv4 mask</para>
</listitem>
<listitem>
<para>TEREDO: client IPv4 address would be anonymized by given IPv4 mask, client port would be zero&#8217;ed</para>
</listitem>
<listitem>
<para>6to4(Microsoft): client IPv4 address would be anonymized by given IPv4 mask</para>
</listitem>
<listitem>
<para>local: whole IID would be zero&#8217;ed</para>
</listitem>
</itemizedlist>
<para>Client-side SLA would be anonymized by </para>
<itemizedlist>
<listitem>
<para>SLA would be zero&#8217;ed</para>
</listitem>
</itemizedlist>
<para>Prefix would be anonymized by</para>
<itemizedlist>
<listitem>
<para>6to4: client IPv4 address would be anonymized by given IPv4 mask</para>
</listitem>
</itemizedlist>
<para>Compat/Mapped IPv4 addresses would be anonymized by</para>
<itemizedlist>
<listitem>
<para>IPv4 address would be anonymized by given IPv4 mask</para>
</listitem>
</itemizedlist>
</section>
<section>
<title>Method &#8220;anonmize&#8221;</title>
<para>The anonymizer would keep as much information as possible for the IID of an IPv6 address.</para>
<para>Description from libipv6addr.h:</para>
<programlisting language='lyx'> * IID anonymization is done by replacing with related information (64-bit)</programlisting>
<programlisting language='lyx'> * xxxx:xxxx:xxxx:xxxC  (C = 4-bit checksum)</programlisting>
<programlisting language='lyx'> *</programlisting>
<programlisting language='lyx'> * a9p9 4941 0000 000C  -&gt; RFC 4941 anonymized privacy extension Interface ID</programlisting>
<programlisting language='lyx'> *</programlisting>
<programlisting language='lyx'> * a9p9 4291 4xxx xxxC  -&gt; RFC 4291 anonymized EUI-48 Interface ID, xxx xxx = converted OUI</programlisting>
<programlisting language='lyx'> * a9p9 4291 5xxx xxxC  -&gt; RFC 4291 anonymized EUI-48 Interface ID, xxx xxx = converted mapped IAB/OUI-36</programlisting>
<programlisting language='lyx'> * a9p9 4291 6xxx xxxC  -&gt; RFC 4291 anonymized EUI-64 Interface ID, xxx xxx = converted OUI</programlisting>
<programlisting language='lyx'> * a9p9 4291 7xxx xxxC  -&gt; RFC 4291 anonymized EUI-64 Interface ID, xxx xxx = converted mapped IAB/OUI-36</programlisting>
<programlisting language='lyx'> * a9p9 4291 8xxx xxxC  -&gt; RFC 4291 embedded anonymized IPv4 address, xxx xxx = first 24 bit of included (anonymized) IPv4 address</programlisting>
<programlisting language='lyx'> * a9p9 4291 c02d 5d1C  -&gt; RFC 4291 Chapter 2.5.1 anonymized static Interface ID</programlisting>
<programlisting language='lyx'> *</programlisting>
<programlisting language='lyx'> * a9p9 5214 4xxx xxxC  -&gt; RFC 5214 anonymized ISATAP Interface ID, xxx xxx = first 24 bit of included (anonymized) IPv4 address (local scope)</programlisting>
<programlisting language='lyx'> * a9p9 5214 5xxx xxxC  -&gt; RFC 5214 anonymized ISATAP Interface ID, xxx xxx = first 24 bit of included (anonymized) IPv4 address (global scope)</programlisting>
<programlisting language='lyx'> * a9p9 5214 cxx0 000C  -&gt; RFC 5214 anonymized ISATAP Interface ID, xx      = first  8 bit of included vendor ID (local scope)</programlisting>
<programlisting language='lyx'> * a9p9 5214 dxx0 000C  -&gt; RFC 5214 anonymized ISATAP Interface ID, xx      = first  8 bit of included vendor ID (global scope)</programlisting>
<programlisting language='lyx'> * a9p9 5214 exxx xxxC  -&gt; RFC 5214 anonymized ISATAP Interface ID, xxx xxx = first 24 bit of included extension ID (local scope)</programlisting>
<programlisting language='lyx'> * a9p9 5214 fxxx xxxC  -&gt; RFC 5214 anonymized ISATAP Interface ID, xxx xxx = first 24 bit of included extension ID (global scope)</programlisting>
<programlisting language='lyx'> *</programlisting>
<programlisting language='lyx'> * a9p9 4843 0000 000C  -&gt; RFC 4843 anonymized ORCHID hash</programlisting>
<para>Depending on given mask, the part of the prefix will be replaced:</para>
<programlisting language='lyx'> * SLA/NLA prefix part anonymization is done by replacing with pattern a909a909</programlisting>
<programlisting language='lyx'> *   p = number of nibbles anonymized</programlisting>
</section>
<section>
<title>Method &#8220;keep-type-asn-cc&#8221;</title>
<para>In addition to &#8220;anonymize&#8221; (of IID) this method anonymizes also the prefix of an IPv6 address or a whole IPv4 address by keeping ASN (Autonomous System Number, Country Code and Type).</para>
<para>Description from libipv6addr.h:</para>
<programlisting language='lyx'> * Prefix anonymization in case of method=kp: p=0x0f</programlisting>
<programlisting language='lyx'> * a909:ccca:aaaa:aaaC  (C = 4-bit checksum)</programlisting>
<programlisting language='lyx'> *                      ccc      -&gt; 10-bit Country Code mapping [A-Z]*[A-Z0-9] (936)</programlisting>
<programlisting language='lyx'> *                                   0x3FD = LISP</programlisting>
<programlisting language='lyx'> *                                   0x3FE = unknown country</programlisting>
<programlisting language='lyx'> *                                   0x3FF - 16 + REGISTRY_6BONE &amp;&amp; ASN=0 = 6bone </programlisting>
<programlisting language='lyx'> *                                   0x000-0x3A7: c1= c / 36, c2 = c % 36</programlisting>
<programlisting language='lyx'> *                      aaaaaaaa -&gt; 32-bit ASN</programlisting>
<para>Description from libipv4addr.h:</para>
<programlisting language='lyx'> *  Global IPv4 addresses are anoymized by storing country code and AS number</programlisting>
<programlisting language='lyx'> *   and using prefix of experimental range (240-255.x.y.z)</programlisting>
<programlisting language='lyx'> *</programlisting>
<programlisting language='lyx'> *  3 3 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1 </programlisting>
<programlisting language='lyx'> *  1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0</programlisting>
<programlisting language='lyx'> *  1 1 1 1</programlisting>
<programlisting language='lyx'> * |p p p p|</programlisting>
<programlisting language='lyx'> *  Prefix                </programlisting>
<programlisting language='lyx'> *    0xF</programlisting>
<programlisting language='lyx'> *</programlisting>
<programlisting language='lyx'> * Pariy Bit (odd parity)</programlisting>
<programlisting language='lyx'> *         |P|</programlisting>
<programlisting language='lyx'> *</programlisting>
<programlisting language='lyx'> * Mapping of Country Code</programlisting>
<programlisting language='lyx'> *           |c c c c c c c c c c|</programlisting>
<programlisting language='lyx'> *            10-bit Country Code mapping [A-Z]*[A-Z0-9] (936)</programlisting>
<programlisting language='lyx'> *            0x3FF = unknown country</programlisting>
<programlisting language='lyx'> *            0x000-0x3A7: c1= c / 36, c2 = c % 36</programlisting>
<programlisting language='lyx'> *</programlisting>
<programlisting language='lyx'> * Mapping of ASN &lt;= 65535</programlisting>
<programlisting language='lyx'> *                                0|a a a a a a a a a a a a a a a a|</programlisting>
<programlisting language='lyx'> *                                    16-bit ASN</programlisting>
<programlisting language='lyx'> *</programlisting>
<programlisting language='lyx'> * Mapping of ASN &gt;= 65536, ASN &amp; 0xE000 == 0 (12-bit LSB is ok) </programlisting>
<programlisting language='lyx'> *                                1|r r r|0|l l l l l l l l l l l l|</programlisting>
<programlisting language='lyx'> *                                           13-bit LSB of ASN</programlisting>
<programlisting language='lyx'> *</programlisting>
<programlisting language='lyx'> * Mapping of ASN &gt;= 65536, ASN &amp; 0xE000 != 0 (12-bit LSB overflow) =&gt; unspecified</programlisting>
<programlisting language='lyx'> *                                1|r r r|1|0 0 0 0 0 0 0 0 0 0 0 0|</programlisting>
<programlisting language='lyx'> *</programlisting>
<programlisting language='lyx'> * Mapping of ASN registry for ASN &gt;= 65536</programlisting>
<programlisting language='lyx'> *                                  0 0 0 = "unknown ASN registry"</programlisting>
<programlisting language='lyx'> *                                  0 1 0 = APNIC</programlisting>
<programlisting language='lyx'> *                                  0 1 1 = RIPE</programlisting>
<programlisting language='lyx'> *                                  1 0 0 = LACNIC</programlisting>
<programlisting language='lyx'> *                                  1 0 1 = AFRINIC</programlisting>
<programlisting language='lyx'> *                                  1 1 0 = ARIN</programlisting>
<programlisting language='lyx'> * Mapping of LISP</programlisting>
<programlisting language='lyx'> *                                1|r r r|1|1|0 0 0 0 0 0 0 0 0 0 0| </programlisting>
</section>
<section>
<title>Method &#8220;keep-type-geonameid&#8221;</title>
<para>In difference to keep-type-asn-cc this method anonymizes the prefix of an IPv6 address or a whole IPv4 address by keeping the GeonameID and Type.</para>
<para>Description from libipv6addr.h:</para>
<programlisting language='lyx'> * a909:sssg:gggg:gggC  (C = 4-bit checksum)</programlisting>
<programlisting language='lyx'> *                      sss      -&gt; 10-bit source mapping</programlisting>
<programlisting language='lyx'> *                                   GeonameID source information</programlisting>
<programlisting language='lyx'> *                                   0x000 = unknown</programlisting>
<programlisting language='lyx'> *                                   0x001 = continent  (prio: lowest)</programlisting>
<programlisting language='lyx'> *                                   0x002 = country</programlisting>
<programlisting language='lyx'> *                                   0x003 = state/prov</programlisting>
<programlisting language='lyx'> *                                   0x004 = district</programlisting>
<programlisting language='lyx'> *                                   0x005 = city       (prio: highest)</programlisting>
<programlisting language='lyx'> *                                   0x006 = (reserved)</programlisting>
<programlisting language='lyx'> *                                   0x007 = LISP</programlisting>
<programlisting language='lyx'> *                                   0x0r. = registry</programlisting>
<programlisting language='lyx'> *                               -&gt; 2 leftmost bit are |0 1|</programlisting>
<programlisting language='lyx'> *                      gggggggg -&gt; 32-bit GeonameID</programlisting>
<programlisting language='lyx'> *                                   0x11800 = LISP</programlisting>
<para>Description from libipv4addr.h:</para>
<programlisting language='lyx'> * IPv4 address anonymization type "keep-type-geonameid"</programlisting>
<programlisting language='lyx'> *  Global IPv4 addresses are anonymized by storing GeonameID</programlisting>
<programlisting language='lyx'> *   and using prefix of experimental range (240-255.x.y.z)</programlisting>
<programlisting language='lyx'> *</programlisting>
<programlisting language='lyx'> *  3 3 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1</programlisting>
<programlisting language='lyx'> *  1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0</programlisting>
<programlisting language='lyx'> *  1 1 1 1</programlisting>
<programlisting language='lyx'> * |p p p p|</programlisting>
<programlisting language='lyx'> *  Prefix</programlisting>
<programlisting language='lyx'> *    0xF</programlisting>
<programlisting language='lyx'> *</programlisting>
<programlisting language='lyx'> * Parity Bit (even parity)</programlisting>
<programlisting language='lyx'> *         |P|</programlisting>
<programlisting language='lyx'> *</programlisting>
<programlisting language='lyx'> * Mapping of GeonameID source</programlisting>
<programlisting language='lyx'> *           |s s s|</programlisting>
<programlisting language='lyx'> *            3-bit GeonameID source information</programlisting>
<programlisting language='lyx'> *            0 0 0 (0x0) = unknown</programlisting>
<programlisting language='lyx'> *            0 0 1 (0x1) = continent  (prio: lowest)</programlisting>
<programlisting language='lyx'> *            0 1 0 (0x2) = country</programlisting>
<programlisting language='lyx'> *            0 1 1 (0x3) = state/prov</programlisting>
<programlisting language='lyx'> *            1 0 0 (0x4) = district</programlisting>
<programlisting language='lyx'> *            1 0 1 (0x5) = city       (prio: highest)</programlisting>
<programlisting language='lyx'> *            1 1 0 (0x6) = (reserved)</programlisting>
<programlisting language='lyx'> *            1 1 1 (0x7) = LISP</programlisting>
<programlisting language='lyx'> *</programlisting>
<programlisting language='lyx'> * Mapping of GeonameID (limited to IDs &lt; 2^24, in worst case ID from source with lower prio is used)</programlisting>
<programlisting language='lyx'> *                 |g g g g g g g g g g g g g g g g g g g g g g g g|</programlisting>
<programlisting language='lyx'> *</programlisting>
<programlisting language='lyx'> * Mapping of LISP registry</programlisting>
<programlisting language='lyx'> *                                  0 0 0 = "unknown ASN registry"</programlisting>
<programlisting language='lyx'> *                                  0 1 0 = APNIC</programlisting>
<programlisting language='lyx'> *                                  0 1 1 = RIPE</programlisting>
<programlisting language='lyx'> *                                  1 0 0 = LACNIC</programlisting>
<programlisting language='lyx'> *                                  1 0 1 = AFRINIC</programlisting>
<programlisting language='lyx'> *                                  1 1 0 = ARIN</programlisting>
<programlisting language='lyx'> *                 |0 0 0 0 0 0 0 1 r r r 1 1 0 0 0 0 0 0 0 0 0 0 0|</programlisting>
</section>
</section>
<section>
<title>Supported log file formats</title>
<para>Currently native supported log files:</para>
<itemizedlist>
<listitem>
<para>Apache log file format, 1st token is IPv4 or IPv6 address</para>
</listitem>
</itemizedlist>
<para>There are plans to support also mail server log files sometimes in the future, but because of different formats, this would be probably done by a Perl program which parses the log file and a (cached) &#8217;ip6calc&#8217; call with action &#8217;anonymize&#8217;.</para>
</section>
<section>
<title>Supported options</title>
<programlisting language='lyx'>$ ipv6loganon -h</programlisting>
<programlisting language='lyx'>ipv6loganon: version 4.3.0 ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID</programlisting>
<programlisting language='lyx'>(P) &amp; (C) 2007-2025 by Peter Bieringer &lt;pb (at) bieringer.de&gt;</programlisting>
<programlisting language='lyx'>This program anonymizes IPv4/IPv6 addresses in e.g. HTTP server log files</programlisting>
<programlisting language='lyx'>  [-d|--debug &lt;debug value&gt;] : debug value (bitwise like)</programlisting>
<programlisting language='lyx'>                                can also be set by IPV6CALC_DEBUG environment value</programlisting>
<programlisting language='lyx'>  [-v|--version [-v [-v]]]   : version information (2 optional detail levels)</programlisting>
<programlisting language='lyx'>  [-v|--version -h]          : explanation of feature tokens</programlisting>
<programlisting language='lyx'>  [-V|--verbose]             : be more verbose</programlisting>
<programlisting language='lyx'>  [-h|--help|-?]             : this online help</programlisting>
<programlisting language='lyx'>  [-q|--quiet]               : be more quiet</programlisting>
<programlisting language='lyx'>  [--disable-ip2location           ] : IP2Location(BIN) support disabled</programlisting>
<programlisting language='lyx'>  [--db-ip2location-disable        ] : IP2Location(BIN) support disabled</programlisting>
<programlisting language='lyx'>  [--db-ip2location-dir &lt;directory&gt;] : IP2Location(BIN) database directory (default: /var/local/share/IP2Location)</programlisting>
<programlisting language='lyx'>  [--db-ip2location-only-type &lt;TYPE&gt;]: IP2Location(BIN) database only selected type (1-666)</programlisting>
<programlisting language='lyx'>  [--db-ip2location-allow-softlinks] : IP2Location(BIN) database softlinks allowed</programlisting>
<programlisting language='lyx'>     by default they are ignored because it is hard to autodetect COMM/LITE/SAMPLE</programlisting>
<programlisting language='lyx'>  [--db-ip2location-lite-to-sample-autoswitch-max-delta-months &lt;MONTHS&gt;]:</programlisting>
<programlisting language='lyx'>     autoswitch from LITE to SAMPLE databases if possible and delta is not more than 12 months (0=disabled)</programlisting>
<programlisting language='lyx'>  [--db-ip2location-comm-to-lite-switch-min-delta-months &lt;MONTHS&gt;]:</programlisting>
<programlisting language='lyx'>     switch from COMM to LITE databases if possible and delta more than 12 months (0=disabled)</programlisting>
<programlisting language='lyx'>  [--disable-ip2location2           ] : IP2Location(MMDB) support disabled</programlisting>
<programlisting language='lyx'>  [--db-ip2location2-disable        ] : IP2Location(MMDB) support disabled</programlisting>
<programlisting language='lyx'>  [--db-ip2location2-dir &lt;directory&gt;] : IP2Location(MMDB) database directory (default: /var/local/share/IP2Location)</programlisting>
<programlisting language='lyx'>  [--db-ip2location2-only-type &lt;TYPE&gt;]: IP2Location(MMDB) database only selected type (1-666)</programlisting>
<programlisting language='lyx'>  [--db-ip2location2-allow-softlinks] : IP2Location(MMDB) database softlinks allowed</programlisting>
<programlisting language='lyx'>     by default they are ignored because it is hard to autodetect COMM/LITE/SAMPLE</programlisting>
<programlisting language='lyx'>  [--db-ip2location2-lite-to-sample-autoswitch-max-delta-months &lt;MONTHS&gt;]:</programlisting>
<programlisting language='lyx'>     autoswitch from LITE to SAMPLE databases if possible and delta is not more than 12 months (0=disabled)</programlisting>
<programlisting language='lyx'>  [--db-ip2location-comm-to-lite-switch-min-delta-months &lt;MONTHS&gt;]:</programlisting>
<programlisting language='lyx'>     switch from COMM to LITE databases if possible and delta more than 12 months (0=disabled)</programlisting>
<programlisting language='lyx'>  [--disable-geoip2                ] : GeoIP(MaxMindDB) support disabled</programlisting>
<programlisting language='lyx'>  [--db-geoip2-disable             ] : GeoIP(MaxMindDB) support disabled</programlisting>
<programlisting language='lyx'>  [--db-geoip2-dir      &lt;directory&gt;] : GeoIP(MaxMindDB) database directory (default: /var/local/share/GeoIP)</programlisting>
<programlisting language='lyx'>  [--disable-dbip2                 ] : db-ip.com(MaxMindDB) support disabled</programlisting>
<programlisting language='lyx'>  [--db-dbip2-disable              ] : db-ip.com(MaxMindDB) support disabled</programlisting>
<programlisting language='lyx'>  [--db-dbip2-dir       &lt;directory&gt;] : db-ip.com(MaxMindDB) database directory (default: /var/local/share/DBIP)</programlisting>
<programlisting language='lyx'>  [--db-dbip2-only-type &lt;TYPE&gt;]      : db-ip.com(MaxMindDB) database only selected type (1-6)</programlisting>
<programlisting language='lyx'>  [--db-dbip2-comm-to-free-switch-min-delta-months &lt;MONTHS&gt;]:</programlisting>
<programlisting language='lyx'>     switch from COMM to FREE databases if possible and delta more than 12 months (0=disabled)</programlisting>
<programlisting language='lyx'>  [--disable-external              ] : External support disabled</programlisting>
<programlisting language='lyx'>  [--db-external-disable           ] : External support disabled</programlisting>
<programlisting language='lyx'>  [--db-external-dir    &lt;directory&gt;] : External database directory (default: /var/local/share/ipv6calc)</programlisting>
<programlisting language='lyx'>  [--disable-builtin               ] : BuiltIn support disabled</programlisting>
<programlisting language='lyx'>  [--db-builtin-disable            ] : BuiltIn support disabled</programlisting>
<programlisting language='lyx'>  [--db-priorization &lt;entry1&gt;[:...]] : Database priorization order list (overwrites default)</programlisting>
<programlisting language='lyx'>                                         colon separated: GeoIP2 IP2Location DBIP2 External BuiltIn IP2Location2</programlisting>
<programlisting language='lyx'> Hint: all long options can be predefined from environment by using</programlisting>
<programlisting language='lyx'>  prefix: IPV6CALC_ and  conversion: '-' -&gt; '_' and lowercase -&gt; uppercase</programlisting>
<programlisting language='lyx'>  example for options with values   : --db-dbip2-dir=&lt;DIR&gt;  -&gt;  environment: IPV6CALC_DB_DBIP2_DIR=&lt;DIR&gt;</programlisting>
<programlisting language='lyx'>  example for options without values: --db-dbip2-disable    -&gt;  environment: IPV6CALC_DB_DBIP2_DISABLE=1</programlisting>
<programlisting language='lyx'>                                                                              on|off|0|1 is supported</programlisting>
<programlisting language='lyx'>  [-w|--write]               : write output to file instead of stdout</programlisting>
<programlisting language='lyx'>  [-a|--append]              : append output to file instead of stdout</programlisting>
<programlisting language='lyx'>  [-f|--flush]               : flush output after each line</programlisting>
<programlisting language='lyx'>  [-V|--verbose]             : be verbose</programlisting>
<programlisting language='lyx'>  [-n|--nocache]             : disable caching</programlisting>
<programlisting language='lyx'>  [-c|--cachelimit &lt;value&gt;]  : set cache limit</programlisting>
<programlisting language='lyx'>                               default: 20</programlisting>
<programlisting language='lyx'>                               maximum: 200</programlisting>
<programlisting language='lyx'>  Shortcut for anonymization presets:</programlisting>
<programlisting language='lyx'>   --anonymize-standard (default)</programlisting>
<programlisting language='lyx'>   --anonymize-careful</programlisting>
<programlisting language='lyx'>   --anonymize-paranoid</programlisting>
<programlisting language='lyx'>  Supported methods [--anonymize-method METHOD]:</programlisting>
<programlisting language='lyx'>   anonymize : reliable anonymization, keep as much type information as possible</programlisting>
<programlisting language='lyx'>   zeroize   : simple zeroizing according to given masks, probably loose type information</programlisting>
<programlisting language='lyx'>   keep-type-asn-cc: special reliable anonymization, keep type &amp; Autonomous System Number and CountryCode</programlisting>
<programlisting language='lyx'>   keep-type-geonameid: special reliable anonymization, keep type &amp; GeonameID</programlisting>
<programlisting language='lyx'>  Available presets (shortcut names) [--anonymize-preset|ap PRESET-NAME]:</programlisting>
<programlisting language='lyx'>   anonymize-standard   (as): mask-ipv6= 56 mask-ipv4=24 mask-eui64=40 mask-mac=24 mask-autoadjust=yes method=anonymize</programlisting>
<programlisting language='lyx'>   anonymize-careful    (ac): mask-ipv6= 48 mask-ipv4=20 mask-eui64=24 mask-mac=24 mask-autoadjust=yes method=anonymize</programlisting>
<programlisting language='lyx'>   anonymize-paranoid   (ap): mask-ipv6= 40 mask-ipv4=16 mask-eui64= 0 mask-mac=24 mask-autoadjust=no  method=anonymize</programlisting>
<programlisting language='lyx'>   zeroize-standard     (zs): mask-ipv6= 56 mask-ipv4=24 mask-eui64=40 mask-mac=24 mask-autoadjust=yes method=zeroize</programlisting>
<programlisting language='lyx'>   zeroize-careful      (zc): mask-ipv6= 48 mask-ipv4=20 mask-eui64=24 mask-mac=24 mask-autoadjust=yes method=zeroize</programlisting>
<programlisting language='lyx'>   zeroize-paranoid     (zp): mask-ipv6= 40 mask-ipv4=16 mask-eui64= 0 mask-mac=24 mask-autoadjust=no  method=zeroize</programlisting>
<programlisting language='lyx'>   keep-type-asn-cc     (kp): mask-ipv6= 56 mask-ipv4=24 mask-eui64=40 mask-mac=24 mask-autoadjust=yes method=keep-type-asn-cc</programlisting>
<programlisting language='lyx'>   keep-type-geonameid  (kg): mask-ipv6= 56 mask-ipv4=24 mask-eui64=40 mask-mac=24 mask-autoadjust=yes method=keep-type-geonameid</programlisting>
<programlisting language='lyx'>  Custom control:</programlisting>
<programlisting language='lyx'>  --mask-ipv4  &lt;bits&gt;     : mask IPv4 address [0-32] (even if occurs in IPv6 address)</programlisting>
<programlisting language='lyx'>  --mask-ipv6  &lt;bits&gt;     : mask IPv6 prefix [0-64] (only applied to related address types)</programlisting>
<programlisting language='lyx'>  --mask-eui64 &lt;bits&gt;     : mask EUI-64 address or IPv6 interface identifier [0-64]</programlisting>
<programlisting language='lyx'>  --mask-mac   &lt;bits&gt;     : mask MAC address [0-48]</programlisting>
<programlisting language='lyx'>  --mask-autoadjust yes|no: autoadjust mask to keep type/vendor information regardless of less given mask</programlisting>
<programlisting language='lyx'> Takes data from stdin, outputs the processed data to stdout (default)</programlisting>
</section>
<section>
<title>Usage</title>
<section>
<title>Offline anonymization</title>
<programlisting language='lyx'>$ cat /path/to/http_log | ./ipv6loganon &gt;/path/to/http_log_anonymized</programlisting>
</section>
<section>
<title>On-the-fly online anonymization for Apache Webserver</title>
<blockquote>
<para>Note: since 0.91.1 also a module for Apache Webserver is available (see below) supporting anonymized logging</para>
</blockquote>
<para>(Supported since 0.90.0)</para>
<para>Adjust or add (note: more than one CustomLog directive is supported by Apache) httpd.conf like following:</para>
<programlisting language='lyx'>CustomLog "|/usr/local/bin/ipv6loganon -a -f /var/log/httpd/access_log" combined</programlisting>
<para>In case of &#8220;cronolog&#8221; is used on the system, configure like this:</para>
<itemizedlist>
<listitem>
<para>Apache version &lt; 2.4:</para>
</listitem>
</itemizedlist>
<programlisting language='lyx'>CustomLog "|/usr/bin/ipv6loganon -f |/usr/sbin/cronolog /var/log/httpd/access.log-%Y%m%d" combined </programlisting>
<itemizedlist>
<listitem>
<para>Apache version &gt;= 2.4:</para>
</listitem>
</itemizedlist>
<programlisting language='lyx'>CustomLog "|$/usr/bin/ipv6loganon -f |/usr/sbin/cronolog /var/log/httpd/access.log-%Y%m%d" combined </programlisting>
</section>
</section>
</section>
<section>
<title>External database update helper scripts</title>
<para>The &#8220;tools&#8221; subdirectory contains helper scripts for updating external databases.</para>
<section>
<title>IP2Location</title>
<para>Since 4.3.0 script also supports download of MMDB files</para>
<programlisting language='lyx'>$ /usr/share/ipv6calc/tools/IP2Location-update.sh -h</programlisting>
<programlisting language='lyx'>Usage: IP2Location-update.sh [-D &lt;dir&gt;] [-n] [-s] [-T] [-v] [-R [-r]]</programlisting>
<programlisting language='lyx'>	-D &lt;dir&gt;	database destination directory (optional)</programlisting>
<programlisting language='lyx'>	-n		no action (dry-run)</programlisting>
<programlisting language='lyx'>	-s		skip already successfully downloaded files</programlisting>
<programlisting language='lyx'>	-T		enforce use of 'token' instead of using 'login' &amp; 'password'</programlisting>
<programlisting language='lyx'>	-v		verbose</programlisting>
<programlisting language='lyx'>	-S &lt;selector&gt;	download only sample file given by selector IPv4:&lt;num&gt; or IPv6:&lt;num&gt;</programlisting>
<programlisting language='lyx'>	-R		restart services (having open but replaced database files)</programlisting>
<programlisting language='lyx'>			    requires "sudo" in case of non-root:</programlisting>
<programlisting language='lyx'>				/usr/bin/systemctl restart *</programlisting>
<programlisting language='lyx'>				/usr/bin/systemctl is-active *</programlisting>
<programlisting language='lyx'>				/usr/bin/lsof *</programlisting>
<programlisting language='lyx'>	-r		test-run for services restart</programlisting>
<programlisting language='lyx'>	database directory: /var/local/share/IP2Location (default: /usr/share/IP2Location)</programlisting>
<programlisting language='lyx'>	it honors externally defined environment value:</programlisting>
<programlisting language='lyx'>		prio 1: IP2LOCATION_DAT_DIR</programlisting>
<programlisting language='lyx'>		prio 2: IPV6CALC_DB_IP2LOCATION_DIR</programlisting>
<programlisting language='lyx'> this script will download data from ip2location.com</programlisting>
<programlisting language='lyx'>  into given/set database directory</programlisting>
<programlisting language='lyx'> Sample databases:</programlisting>
<programlisting language='lyx'>  IP2LOCATION_DAT_FILES_SAMPLE="IPv4:26 IPv6:26"</programlisting>
<programlisting language='lyx'>  IP2LOCATION_MMDB_FILES_SAMPLE=""</programlisting>
<programlisting language='lyx'> Lite (free) databases:</programlisting>
<programlisting language='lyx'>  IP2LOCATION_DAT_FILES_LITE_FREE=""</programlisting>
<programlisting language='lyx'>  IP2LOCATION_MMDB_FILES_LITE_FREE="IPv4:1"</programlisting>
<programlisting language='lyx'> With authentication (requires login/password or token in HOME/.ip2location) and a valid subscription</programlisting>
<programlisting language='lyx'>  IP2LOCATION_DAT_FILES_LITE=""</programlisting>
<programlisting language='lyx'>  IP2LOCATION_DAT_FILES=""</programlisting>
<programlisting language='lyx'>  IP2LOCATION_MMDB_FILES_LITE=""</programlisting>
<programlisting language='lyx'>  IP2LOCATION_MMDB_FILES=""</programlisting>
<programlisting language='lyx'> Credentials or token must be defined in $HOME/.ip2location by</programlisting>
<programlisting language='lyx'>  login=IP2LOCATION-LOGIN       found: pb...</programlisting>
<programlisting language='lyx'>  password=IP2LOCATION-PASSWORD found: D6...</programlisting>
<programlisting language='lyx'>  token=IP2LOCATION-TOKEN       found: 2q...</programlisting>
<programlisting language='lyx'> In addition settings from above can be overwritten by setting related variables</programlisting>
</section>
<section>
<title>GeoIP</title>
<para>Just note that old database format (version 1) is no longer supported for free download, ipv6calc &gt;= 2.0.0 supports also MaxMindDB format, ipv6calc &gt;= 3.0.0 drops legacy download capability</para>
<programlisting language='lyx'>$ /usr/share/ipv6calc/tools/GeoIP-update.sh -h</programlisting>
<programlisting language='lyx'>Usage: GeoIP-update.sh [-D &lt;dir&gt;] [-v] [-R [-r]]</programlisting>
<programlisting language='lyx'>	-D &lt;dir&gt;	database directory (optional)</programlisting>
<programlisting language='lyx'>	-v		verbose</programlisting>
<programlisting language='lyx'>	-n		no action (dry-run)</programlisting>
<programlisting language='lyx'>	-R		restart services (having open but replaced database files)</programlisting>
<programlisting language='lyx'>			    requires "sudo" in case of non-root:</programlisting>
<programlisting language='lyx'>				/usr/bin/systemctl restart *</programlisting>
<programlisting language='lyx'>				/usr/bin/systemctl is-active *</programlisting>
<programlisting language='lyx'>				/usr/bin/lsof *</programlisting>
<programlisting language='lyx'>	-r		test-run for services restart</programlisting>
<programlisting language='lyx'>	database directory: /var/local/share/GeoIP (default: /usr/share/GeoIP)</programlisting>
<programlisting language='lyx'>	it honors externally defined environment value:</programlisting>
<programlisting language='lyx'>		prio 1: GEOIP_DAT_DIR</programlisting>
<programlisting language='lyx'>		prio 2: IPV6CALC_DB_GEOIP2_DIR</programlisting>
<programlisting language='lyx'> adjust /etc/GeoIP.conf in advance:</programlisting>
<programlisting language='lyx'>   EditionIDs GeoLite2-Country GeoLite2-City GeoLite2-ASN</programlisting>
<programlisting language='lyx'>   (in case a valid license key exists, add key and extend EditionIDs related)</programlisting>
<programlisting language='lyx'>   see also https://dev.maxmind.com/geoip/geoipupdate/</programlisting>
</section>
<section>
<title>DB-IP.com</title>
<para>Since ipv6calc &gt;= 2.0.0 supports also MaxMindDB format, so download of CSV files and converting them into BerkeleyDB format is no longer required. Since ipv6calc &gt;= 4.3.1 support for &#8220;IP to ASN lite&#8221; is available.</para>
<programlisting language='lyx'>$ /usr/share/ipv6calc/tools/DBIP-update.sh -h</programlisting>
<programlisting language='lyx'>INFO  : found and sourced: ./tools/ipv6calc-db-update-support.sh</programlisting>
<programlisting language='lyx'>Usage: DBIP-update.sh [-v] [-s] [-c] [-D &lt;dir&gt;] [-C &lt;days&gt;] [-U &lt;url&gt;] [-T &lt;type&gt;] [-R [-r]]</programlisting>
<programlisting language='lyx'>	-s		skip download</programlisting>
<programlisting language='lyx'>	-c		skip decompress</programlisting>
<programlisting language='lyx'>	-v		verbose</programlisting>
<programlisting language='lyx'>	-D &lt;dir&gt;	database directory (optional)</programlisting>
<programlisting language='lyx'>	-C &lt;days&gt;	cleanup files older than given days (optional)</programlisting>
<programlisting language='lyx'>	-U &lt;url&gt;	use URL to download full database</programlisting>
<programlisting language='lyx'>	-T &lt;type&gt;	set type of via URL downloaded file</programlisting>
<programlisting language='lyx'>                          MMDB: country|isp|location|*location-isp*</programlisting>
<programlisting language='lyx'>			  CSV : isp|location|*full*</programlisting>
<programlisting language='lyx'>	-R		restart services (having open but replaced database files)</programlisting>
<programlisting language='lyx'>			    requires "sudo" in case of non-root:</programlisting>
<programlisting language='lyx'>				/usr/bin/systemctl restart *</programlisting>
<programlisting language='lyx'>				/usr/bin/systemctl is-active *</programlisting>
<programlisting language='lyx'>				/usr/bin/lsof *</programlisting>
<programlisting language='lyx'>	-r		test-run for services restart</programlisting>
<programlisting language='lyx'>	database directory: /var/local/share/DBIP (default: /usr/share/DBIP)</programlisting>
<programlisting language='lyx'> it honors externally defined environment value:</programlisting>
<programlisting language='lyx'>	prio 1: DBIP_DAT_DIR</programlisting>
<programlisting language='lyx'>	prio 2: IPV6CALC_DB_DBIP2_DIR</programlisting>
<programlisting language='lyx'> this script will download data from</programlisting>
<programlisting language='lyx'> DB-IP.com (default: free versions) the MaxMindDB (mmdb) files DB files for ipv6calc</programlisting>
<programlisting language='lyx'> "DBIP" database support</programlisting>
<programlisting language='lyx'> DBIP_DAT_URL_BASE=http://download.db-ip.com/free/</programlisting>
<programlisting language='lyx'> DBIP_DAT_FILES=dbip-country-lite-%Y-%m.mmdb.gz dbip-city-lite-%Y-%m.mmdb.gz dbip-asn-lite-%Y-%m.mmdb.gz</programlisting>
<programlisting language='lyx'> in case -U &lt;url&gt; (take URL from subscription e-mail) is provided, it downloads the database</programlisting>
<programlisting language='lyx'>  use -T &lt;type&gt; in case it's not "location-isp"</programlisting>
</section>
<section>
<title>External</title>
<programlisting language='lyx'>$ /usr/share/ipv6calc/tools/ipv6calc-db-update.sh -h</programlisting>
<programlisting language='lyx'>Usage: ipv6calc-db-update.sh [-s] [-u] [-D &lt;dir&gt;] [-R [-r]]</programlisting>
<programlisting language='lyx'>	-s		skip download</programlisting>
<programlisting language='lyx'>	-u		unconditional update</programlisting>
<programlisting language='lyx'>	-D &lt;dir&gt;        database directory (optional)</programlisting>
<programlisting language='lyx'>	-R		restart services (having open but replaced database files)</programlisting>
<programlisting language='lyx'>			    requires "sudo" in case of non-root:</programlisting>
<programlisting language='lyx'>				/usr/bin/systemctl restart *</programlisting>
<programlisting language='lyx'>				/usr/bin/systemctl is-active *</programlisting>
<programlisting language='lyx'>				/usr/bin/lsof *</programlisting>
<programlisting language='lyx'>	-r		test-run for services restart</programlisting>
<programlisting language='lyx'>	database directory: /var/local/share/ipv6calc (default: /usr/share/ipv6calc/db)</programlisting>
<programlisting language='lyx'>	it honors externally defined environment values:</programlisting>
<programlisting language='lyx'>		prio 1: IPV6CALC_DAT_DIR</programlisting>
<programlisting language='lyx'>		prio 2: IPV6CALC_DB_EXTERNAL_DIR</programlisting>
<programlisting language='lyx'>	this script (and its helper scripts) will download data from</programlisting>
<programlisting language='lyx'>	registries and generate Berkeley DB files for ipv6calc</programlisting>
<programlisting language='lyx'>	"external" database support</programlisting>
</section>
</section>
<section>
<title>Perl CGI wrapper program "ipv6calcweb.cgi"</title>
<para>Because calling C programs directly as CGI isn&#8217;t really recommended (too much security troubles all the time), I wrote a small wrapper utility which calls "ipv6calc" to get information about client and server address for displaying on a web page. </para>
<section>
<title>Examples</title>
<para>A demonstration about which kind of output is possible to produce is shown at</para>
<itemizedlist>
<listitem>
<para><link xlink:href="http://ip.bieringer.net/">http://ip.bieringer.net/</link> (IPv4/IPv6)</para>
</listitem>
<listitem>
<para><link xlink:href="http://www.ipv6.bieringer.de/">http://www.ipv6.bieringer.de/</link> (IPv6 only)</para>
</listitem>
<listitem>
<para><link xlink:href="http://mirrors.bieringer.de/">http://mirrors.bieringer.de/</link> (IPv4/IPv6)</para>
</listitem>
</itemizedlist>
</section>
</section>
<section>
<title>Webserver log statistics helper program "ipv6logstats"</title>
<para>This program parses a given webserver logfile and count addresses, useful for time period statistics.</para>
<para>Since version 0.95.0 it has extended output, adding a date/time line and statistics by Country Code and ASN (if required databases are available).</para>
<section>
<title>Supported options</title>
<programlisting language='lyx'>$ ipv6logstats -h</programlisting>
<programlisting language='lyx'>ipv6logstats: version 4.3.0 STAT_REG STAT_CC STAT_AS</programlisting>
<programlisting language='lyx'>(P) &amp; (C) 2003-2025 by Peter Bieringer &lt;pb (at) bieringer.de&gt;</programlisting>
<programlisting language='lyx'> Takes web server log data (or any other data which has IPv4/v6 address in first column)</programlisting>
<programlisting language='lyx'>   from stdin and print statistics table/list (depending on option) to stdout</programlisting>
<programlisting language='lyx'>  [-d|--debug &lt;debug value&gt;] : debug value (bitwise like)</programlisting>
<programlisting language='lyx'>                                can also be set by IPV6CALC_DEBUG environment value</programlisting>
<programlisting language='lyx'>  [-v|--version [-v [-v]]]   : version information (2 optional detail levels)</programlisting>
<programlisting language='lyx'>  [-v|--version -h]          : explanation of feature tokens</programlisting>
<programlisting language='lyx'>  [-V|--verbose]             : be more verbose</programlisting>
<programlisting language='lyx'>  [-h|--help|-?]             : this online help</programlisting>
<programlisting language='lyx'>  [-q|--quiet]               : be more quiet</programlisting>
<programlisting language='lyx'>  [--disable-ip2location           ] : IP2Location(BIN) support disabled</programlisting>
<programlisting language='lyx'>  [--db-ip2location-disable        ] : IP2Location(BIN) support disabled</programlisting>
<programlisting language='lyx'>  [--db-ip2location-dir &lt;directory&gt;] : IP2Location(BIN) database directory (default: /var/local/share/IP2Location)</programlisting>
<programlisting language='lyx'>  [--db-ip2location-only-type &lt;TYPE&gt;]: IP2Location(BIN) database only selected type (1-666)</programlisting>
<programlisting language='lyx'>  [--db-ip2location-allow-softlinks] : IP2Location(BIN) database softlinks allowed</programlisting>
<programlisting language='lyx'>     by default they are ignored because it is hard to autodetect COMM/LITE/SAMPLE</programlisting>
<programlisting language='lyx'>  [--db-ip2location-lite-to-sample-autoswitch-max-delta-months &lt;MONTHS&gt;]:</programlisting>
<programlisting language='lyx'>     autoswitch from LITE to SAMPLE databases if possible and delta is not more than 12 months (0=disabled)</programlisting>
<programlisting language='lyx'>  [--db-ip2location-comm-to-lite-switch-min-delta-months &lt;MONTHS&gt;]:</programlisting>
<programlisting language='lyx'>     switch from COMM to LITE databases if possible and delta more than 12 months (0=disabled)</programlisting>
<programlisting language='lyx'>  [--disable-ip2location2           ] : IP2Location(MMDB) support disabled</programlisting>
<programlisting language='lyx'>  [--db-ip2location2-disable        ] : IP2Location(MMDB) support disabled</programlisting>
<programlisting language='lyx'>  [--db-ip2location2-dir &lt;directory&gt;] : IP2Location(MMDB) database directory (default: /var/local/share/IP2Location)</programlisting>
<programlisting language='lyx'>  [--db-ip2location2-only-type &lt;TYPE&gt;]: IP2Location(MMDB) database only selected type (1-666)</programlisting>
<programlisting language='lyx'>  [--db-ip2location2-allow-softlinks] : IP2Location(MMDB) database softlinks allowed</programlisting>
<programlisting language='lyx'>     by default they are ignored because it is hard to autodetect COMM/LITE/SAMPLE</programlisting>
<programlisting language='lyx'>  [--db-ip2location2-lite-to-sample-autoswitch-max-delta-months &lt;MONTHS&gt;]:</programlisting>
<programlisting language='lyx'>     autoswitch from LITE to SAMPLE databases if possible and delta is not more than 12 months (0=disabled)</programlisting>
<programlisting language='lyx'>  [--db-ip2location-comm-to-lite-switch-min-delta-months &lt;MONTHS&gt;]:</programlisting>
<programlisting language='lyx'>     switch from COMM to LITE databases if possible and delta more than 12 months (0=disabled)</programlisting>
<programlisting language='lyx'>  [--disable-geoip2                ] : GeoIP(MaxMindDB) support disabled</programlisting>
<programlisting language='lyx'>  [--db-geoip2-disable             ] : GeoIP(MaxMindDB) support disabled</programlisting>
<programlisting language='lyx'>  [--db-geoip2-dir      &lt;directory&gt;] : GeoIP(MaxMindDB) database directory (default: /var/local/share/GeoIP)</programlisting>
<programlisting language='lyx'>  [--disable-dbip2                 ] : db-ip.com(MaxMindDB) support disabled</programlisting>
<programlisting language='lyx'>  [--db-dbip2-disable              ] : db-ip.com(MaxMindDB) support disabled</programlisting>
<programlisting language='lyx'>  [--db-dbip2-dir       &lt;directory&gt;] : db-ip.com(MaxMindDB) database directory (default: /var/local/share/DBIP)</programlisting>
<programlisting language='lyx'>  [--db-dbip2-only-type &lt;TYPE&gt;]      : db-ip.com(MaxMindDB) database only selected type (1-6)</programlisting>
<programlisting language='lyx'>  [--db-dbip2-comm-to-free-switch-min-delta-months &lt;MONTHS&gt;]:</programlisting>
<programlisting language='lyx'>     switch from COMM to FREE databases if possible and delta more than 12 months (0=disabled)</programlisting>
<programlisting language='lyx'>  [--disable-external              ] : External support disabled</programlisting>
<programlisting language='lyx'>  [--db-external-disable           ] : External support disabled</programlisting>
<programlisting language='lyx'>  [--db-external-dir    &lt;directory&gt;] : External database directory (default: /var/local/share/ipv6calc)</programlisting>
<programlisting language='lyx'>  [--disable-builtin               ] : BuiltIn support disabled</programlisting>
<programlisting language='lyx'>  [--db-builtin-disable            ] : BuiltIn support disabled</programlisting>
<programlisting language='lyx'>  [--db-priorization &lt;entry1&gt;[:...]] : Database priorization order list (overwrites default)</programlisting>
<programlisting language='lyx'>                                         colon separated: GeoIP2 IP2Location DBIP2 External BuiltIn IP2Location2</programlisting>
<programlisting language='lyx'> Hint: all long options can be predefined from environment by using</programlisting>
<programlisting language='lyx'>  prefix: IPV6CALC_ and  conversion: '-' -&gt; '_' and lowercase -&gt; uppercase</programlisting>
<programlisting language='lyx'>  example for options with values   : --db-dbip2-dir=&lt;DIR&gt;  -&gt;  environment: IPV6CALC_DB_DBIP2_DIR=&lt;DIR&gt;</programlisting>
<programlisting language='lyx'>  example for options without values: --db-dbip2-disable    -&gt;  environment: IPV6CALC_DB_DBIP2_DISABLE=1</programlisting>
<programlisting language='lyx'>                                                                              on|off|0|1 is supported</programlisting>
<programlisting language='lyx'>  [-u|--unknown]             : print unknown IP addresses to stderr</programlisting>
<programlisting language='lyx'>  [-c|--columns]             : print statistics in columns (1)</programlisting>
<programlisting language='lyx'>  [-N|--column-numbers]      : print column numbers</programlisting>
<programlisting language='lyx'>  [-n|--noheader]            : don't print header in columns mode (1)</programlisting>
<programlisting language='lyx'>  [-o|--onlyheader]          : print only header in columns mode (1)</programlisting>
<programlisting language='lyx'>  [-p|--prefix &lt;token&gt;]      : print token as prefix (1)</programlisting>
<programlisting language='lyx'>  [-s|--simple]              : disable extended statistic (CountryCode/ASN)</programlisting>
<programlisting language='lyx'> (1) unsupported for CountryCode &amp; ASN statistics</programlisting>
</section>
<section>
<title>Usage</title>
<para>There are a README and some helper scripts available in the package how to use this program and how to generate a graph using Gnuplot.</para>
<section>
<title>Line-by-line output</title>
<para>The example shows output version 4.0, which </para>
<programlisting language='lyx'>$ cat ip.bieringer.de-log.202401 | ipv6logstats</programlisting>
<para>Header section, since output version 3.0 (&gt;= 0.95.0) additional lines starting with &#8217;*3*&#8217; and &#8217;*DateTime&#8217; and &#8217;*UnixTime&#8217; included</para>
<programlisting language='lyx'>*Version             4.0</programlisting>
<programlisting language='lyx'>*DateTime: 2024:01:21 08:07:59+0000 GMT</programlisting>
<programlisting language='lyx'>*UnixTime: 1705824479</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB features: 0xff1fffff</programlisting>
<programlisting language='lyx'>*3*DB-Info: GeoIP(MaxMindDB): features available/implemented: 0x03063ff0/0x03063ff0</programlisting>
<programlisting language='lyx'>*3*DB-Info: GeoIP2: info of available databases in directory: /var/local/share/GeoIP</programlisting>
<programlisting language='lyx'>*3*DB-Info: GeoIP2: IPv4/v6 CountryCode (FREE)    : [1] GeoLite2-Country.mmdb          (GeoLite2-Country Copyright (c) 2024 MaxMind All Rights Reserved, created: 20240112-201408 UTC)</programlisting>
<programlisting language='lyx'>*3*DB-Info: GeoIP2: IPv4/v6 City (FREE)           : [2] GeoLite2-City.mmdb             (GeoLite2-City Copyright (c) 2024 MaxMind All Rights Reserved, created: 20240112-195220 UTC)</programlisting>
<programlisting language='lyx'>*3*DB-Info: GeoIP2: IPv4/v6 ASN (FREE)            : [3] GeoLite2-ASN.mmdb              (GeoLite2-ASN Copyright (c) 2024 MaxMind All Rights Reserved, created: 20240112-193300 UTC)</programlisting>
<programlisting language='lyx'>*3*DB-Info: IP2Location: features available/implemented: 0x0c003fc0/0x0c003ff0</programlisting>
<programlisting language='lyx'>*3*DB-Info: IP2Location: info of available databases in directory: /var/local/share/IP2Location</programlisting>
<programlisting language='lyx'>*3*DB-Info: IP2Location: Copyright (c) IP2Location All Rights Reserved</programlisting>
<programlisting language='lyx'>*3*DB-Info: IP2Location: IPv4 Co/Re/Ci/LaLo/ZI/TZ/IS/Do/Ne/Ar/We/Mo      :[220] IP-COUNTRY-REGION-CITY-LATITUDE-LONGITUDE-ZIPCODE-TIMEZONE-ISP-DOMAIN-NETSPEED-AREACODE-WEATHER-MOBILE-SAMPLE.BIN (IP2L-DB20 IPv4 IPv6 SAMPLE 20240101)</programlisting>
<programlisting language='lyx'>*3*DB-Info: IP2Location: IPv4 Co/Re/Ci/LaLo/ZI/TZ/IS/Do/Ne/Ar/We/Mo/El/Us:[224] IP-COUNTRY-REGION-CITY-LATITUDE-LONGITUDE-ZIPCODE-TIMEZONE-ISP-DOMAIN-NETSPEED-AREACODE-WEATHER-MOBILE-ELEVATION-USAGETYPE-SAMPLE.BIN (IP2L-DB24 IPv4 IPv6 SAMPLE 20240101)</programlisting>
<programlisting language='lyx'>*3*DB-Info: IP2Location: IPv6 Co/Re/Ci/LaLo/ZI/TZ/IS/Do/Ne/Ar/We/Mo      :[320] IPV6-COUNTRY-REGION-CITY-LATITUDE-LONGITUDE-ZIPCODE-TIMEZONE-ISP-DOMAIN-NETSPEED-AREACODE-WEATHER-MOBILE.SAMPLE.BIN (IP2L-DB20 IPv4 IPv6 SAMPLE 20240101)</programlisting>
<programlisting language='lyx'>*3*DB-Info: IP2Location: IPv6 Co/Re/Ci/LaLo/ZI/TZ/IS/Do/Ne/Ar/We/Mo/El/Us:[324] IPV6-COUNTRY-REGION-CITY-LATITUDE-LONGITUDE-ZIPCODE-TIMEZONE-ISP-DOMAIN-NETSPEED-AREACODE-WEATHER-MOBILE-ELEVATION-USAGETYPE.SAMPLE.BIN (IP2L-DB24 IPv4 IPv6 SAMPLE 20240101)</programlisting>
<programlisting language='lyx'>*3*DB-Info: IP2Location: IPv4 Country                                    :[401] IP2LOCATION-LITE-DB1.BIN            (IP2L-DB1 IPv4 IPv6 LITE 20231215)</programlisting>
<programlisting language='lyx'>*3*DB-Info: IP2Location: IPv4 Co/Re/Ci/LattLong/ZIP/TZ                   :[411] IP2LOCATION-LITE-DB11.BIN           (IP2L-DB11 IPv4 IPv6 LITE 20231215)</programlisting>
<programlisting language='lyx'>*3*DB-Info: IP2Location: IPvx Country                                    :[501] IP2LOCATION-LITE-DB1.IPV6.BIN       (IP2L-DB1 IPv4 IPv6 LITE 20231215)</programlisting>
<programlisting language='lyx'>*3*DB-Info: IP2Location: IPvx Co/Re/Ci/LattLong/ZIP/TZ                   :[511] IP2LOCATION-LITE-DB11.IPV6.BIN      (IP2L-DB11 IPv4 IPv6 LITE 20231215)</programlisting>
<programlisting language='lyx'>*3*DB-Info: IP2Location: IPvx Co/Re/Ci/LattLong/ZIP/TZ                   :[111] IPV6-COUNTRY-REGION-CITY-LATITUDE-LONGITUDE-ZIPCODE-TIMEZONE.BIN (IP2L-DB11 IPv4 IPv6 20231215)</programlisting>
<programlisting language='lyx'>*3*DB-Info: db-ip.com(MaxMindDB): features available/implemented: 0x30063ff0/0x30063ff0</programlisting>
<programlisting language='lyx'>*3*DB-Info: DBIP2: info of available databases in directory: /var/local/share/DBIP</programlisting>
<programlisting language='lyx'>*3*DB-Info: DBIP2: IPv4/v6 CountryCode (FREE)    : [1] dbip-country-lite.mmdb         (DBIP-Country-Lite Copyright (c) 2024 db-ip.com All Rights Reserved, created: 20240101-231423 UTC)</programlisting>
<programlisting language='lyx'>*3*DB-Info: DBIP2: IPv4/v6 City (FREE)           : [2] dbip-city-lite.mmdb            (DBIP-City-Lite Copyright (c) 2024 db-ip.com All Rights Reserved, created: 20240101-231818 UTC)</programlisting>
<programlisting language='lyx'>*3*DB-Info: DBIP2: IPv4/v6 Location+ISP (COMM)   : [6] dbip-location-isp.mmdb         (DBIP-Location-ISP (compat=Enterprise) Copyright (c) 2024 db-ip.com All Rights Reserved, created: 20240102-010801 UTC)</programlisting>
<programlisting language='lyx'>*3*DB-Info: External: features available/implemented: 0xc01980cc/0xc01980cc</programlisting>
<programlisting language='lyx'>*3*DB-Info: External: info of available databases in directory: /var/local/share/ipv6calc</programlisting>
<programlisting language='lyx'>*3*DB-Info: External: IPv4 Registry       : ipv6calc-external-ipv4-registry.db       (EXTDB-1/AFRINIC/20240107 APNIC/20240106 ARIN/20240107 IANA/20231218 LACNIC/20240105 LISP/20200318 RIPENCC/20240106, created: 20240107-161126 UTC)</programlisting>
<programlisting language='lyx'>*3*DB-Info: External: IPv6 Registry       : ipv6calc-external-ipv6-registry.db       (EXTDB-2/AFRINIC/20240107 APNIC/20240106 ARIN/20240107 IANA/20191106 LACNIC/20240105 LISP/20200318 RIPENCC/20240106, created: 20240107-162146 UTC)</programlisting>
<programlisting language='lyx'>*3*DB-Info: External: IPv4 CountryCode    : ipv6calc-external-ipv4-countrycode.db    (EXTDB-3/AFRINIC/20240107 APNIC/20240106 ARIN/20240107 IANA/20231218 LACNIC/20240105 LISP/20200318 RIPENCC/20240106, created: 20240107-161126 UTC)</programlisting>
<programlisting language='lyx'>*3*DB-Info: External: IPv6 CountryCode    : ipv6calc-external-ipv6-countrycode.db    (EXTDB-4/AFRINIC/20240107 APNIC/20240106 ARIN/20240107 IANA/20191106 LACNIC/20240105 LISP/20200318 RIPENCC/20240106, created: 20240107-162146 UTC)</programlisting>
<programlisting language='lyx'>*3*DB-Info: BuiltIn: features available/implemented: 0x0001c00f/0x0001c00f</programlisting>
<programlisting language='lyx'>*3*DB-Info: BuiltIn: info of available databases</programlisting>
<programlisting language='lyx'>*3*DB-Info: BuiltIn: ASN  : IANA/20230810</programlisting>
<programlisting language='lyx'>*3*DB-Info: BuiltIn: CC   : AFRINIC/20240119 APNIC/20240119 ARIN/20240119 LACNIC/20240119 RIPENCC/20240119</programlisting>
<programlisting language='lyx'>*3*DB-Info: BuiltIn: IPv4 : AFRINIC/20240119 APNIC/20240119 ARIN/20240119 IANA/20231218 LACNIC/20240119 LISP/20200318 RIPENCC/20240119 (created: 20240120-044633 UTC)</programlisting>
<programlisting language='lyx'>*3*DB-Info: BuiltIn: IPv6 : AFRINIC/20240119 APNIC/20240119 ARIN/20240119 IANA/20191106 LACNIC/20240119 LISP/20200318 RIPENCC/20240119 (created: 20240120-050328 UTC)</programlisting>
<programlisting language='lyx'>*3*DB-Info: BuiltIn: IEEE : IAB/20240120 OUI/20240120 OUI28/20240120 OUI36/20240120</programlisting>
<programlisting language='lyx'>*3*DB-Info: Database selection or priorization ('-&gt;': subsequential calls)</programlisting>
<programlisting language='lyx'>*3*DB-Info: Database priorization default: GeoIP(MaxMindDB)-&gt;IP2Location-&gt;db-ip.com(MaxMindDB)-&gt;GeoIP-&gt;db-ip.com-&gt;External-&gt;BuiltIn</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_AS_REG (AS-Number to Registry database): BuiltIn</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_CC_REG (CountryCode to Registry database): BuiltIn</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_IPV4_REG (IPv4 to Registry database): BuiltIn</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_IPV6_REG (IPv6 to Registry database): BuiltIn</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_IPV4_AS (IPv4 to AS database): GeoIP(MaxMindDB)-&gt;db-ip.com(MaxMindDB)</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_IPV6_AS (IPv6 to AS database): GeoIP(MaxMindDB)-&gt;db-ip.com(MaxMindDB)</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_IPV4_CC (IPv4 to CountryCode database): GeoIP(MaxMindDB)-&gt;IP2Location-&gt;db-ip.com(MaxMindDB)-&gt;External</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_IPV6_CC (IPv6 to CountryCode database): GeoIP(MaxMindDB)-&gt;IP2Location-&gt;db-ip.com(MaxMindDB)-&gt;External</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_IPV4_COUNTRY (IPv4 to Country database): GeoIP(MaxMindDB)-&gt;IP2Location-&gt;db-ip.com(MaxMindDB)</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_IPV6_COUNTRY (IPv6 to Country database): GeoIP(MaxMindDB)-&gt;IP2Location-&gt;db-ip.com(MaxMindDB)</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_IPV4_CITY (IPv4 to City database): GeoIP(MaxMindDB)-&gt;IP2Location-&gt;db-ip.com(MaxMindDB)</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_IPV6_CITY (IPv6 to City database): GeoIP(MaxMindDB)-&gt;IP2Location-&gt;db-ip.com(MaxMindDB)</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_IPV4_REGION (IPv4 to Region database): GeoIP(MaxMindDB)-&gt;IP2Location-&gt;db-ip.com(MaxMindDB)</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_IPV6_REGION (IPv6 to Region database): GeoIP(MaxMindDB)-&gt;IP2Location-&gt;db-ip.com(MaxMindDB)</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_IEEE (IEEE/OUI/OUI28/OUI36 Vendor database): BuiltIn</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_IPV4_INFO (IPv4 additional information): External-&gt;BuiltIn</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_IPV6_INFO (IPv6 additional information): External-&gt;BuiltIn</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_IPV4_GEONAMEID (IPv4 GeonameID): GeoIP(MaxMindDB)-&gt;db-ip.com(MaxMindDB)</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_IPV6_GEONAMEID (IPv6 GeonameID): GeoIP(MaxMindDB)-&gt;db-ip.com(MaxMindDB)</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_IPV4_DUMP_CC (IPv4 Database Dump by CountryCode): External</programlisting>
<programlisting language='lyx'>*3*DB-Info: DB_IPV6_DUMP_CC (IPv6 Database Dump by CountryCode): External</programlisting>
<para>Simple statistics section</para>
<programlisting language='lyx'>ALL                  68612</programlisting>
<programlisting language='lyx'>IPv4                 57311</programlisting>
<programlisting language='lyx'>IPv6                 11301</programlisting>
<programlisting language='lyx'>UNKNOWN              0</programlisting>
<programlisting language='lyx'>IPv4/APNIC           4154</programlisting>
<programlisting language='lyx'>IPv4/ARIN            27873</programlisting>
<programlisting language='lyx'>IPv4/RIPE            24889</programlisting>
<programlisting language='lyx'>IPv4/LACNIC          305</programlisting>
<programlisting language='lyx'>IPv4/AFRINIC         90</programlisting>
<programlisting language='lyx'>IPv4/UNKNOWN         0</programlisting>
<programlisting language='lyx'>IPv6/6bone           0</programlisting>
<programlisting language='lyx'>IPv6/IANA            0</programlisting>
<programlisting language='lyx'>IPv6/APNIC           506</programlisting>
<programlisting language='lyx'>IPv6/ARIN            1475</programlisting>
<programlisting language='lyx'>IPv6/RIPE            9103</programlisting>
<programlisting language='lyx'>IPv6/LACNIC          216</programlisting>
<programlisting language='lyx'>IPv6/AFRINIC         0</programlisting>
<programlisting language='lyx'>IPv6/RESERVED        0</programlisting>
<programlisting language='lyx'>IPv6/UNKNOWN         0</programlisting>
<programlisting language='lyx'>IPv6/6to4/IANA       0</programlisting>
<programlisting language='lyx'>IPv6/6to4/APNIC      0</programlisting>
<programlisting language='lyx'>IPv6/6to4/ARIN       0</programlisting>
<programlisting language='lyx'>IPv6/6to4/RIPE       1</programlisting>
<programlisting language='lyx'>IPv6/6to4/LACNIC     0</programlisting>
<programlisting language='lyx'>IPv6/6to4/AFRINIC    0</programlisting>
<programlisting language='lyx'>IPv6/6to4/RESERVED   0</programlisting>
<programlisting language='lyx'>IPv6/6to4/UNKNOWN    0</programlisting>
<programlisting language='lyx'>IPv6/Teredo/IANA     0</programlisting>
<programlisting language='lyx'>IPv6/Teredo/APNIC    0</programlisting>
<programlisting language='lyx'>IPv6/Teredo/ARIN     0</programlisting>
<programlisting language='lyx'>IPv6/Teredo/RIPE     0</programlisting>
<programlisting language='lyx'>IPv6/Teredo/LACNIC   0</programlisting>
<programlisting language='lyx'>IPv6/Teredo/AFRINIC  0</programlisting>
<programlisting language='lyx'>IPv6/Teredo/RESERVED 0</programlisting>
<programlisting language='lyx'>IPv6/Teredo/UNKNOWN  0</programlisting>
<programlisting language='lyx'>IPv6/NAT64/IANA      0</programlisting>
<programlisting language='lyx'>IPv6/NAT64/APNIC     0</programlisting>
<programlisting language='lyx'>IPv6/NAT64/ARIN      0</programlisting>
<programlisting language='lyx'>IPv6/NAT64/RIPE      0</programlisting>
<programlisting language='lyx'>IPv6/NAT64/LACNIC    0</programlisting>
<programlisting language='lyx'>IPv6/NAT64/AFRINIC   0</programlisting>
<programlisting language='lyx'>IPv6/NAT64/RESERVED  0</programlisting>
<programlisting language='lyx'>IPv6/NAT64/UNKNOWN   0</programlisting>
<programlisting language='lyx'>IPv6/IID/Global      2581</programlisting>
<programlisting language='lyx'>IPv6/IID/Random      6880</programlisting>
<programlisting language='lyx'>IPv6/IID/Manual      1839</programlisting>
<programlisting language='lyx'>IPv6/IID/ISATAP      0</programlisting>
<programlisting language='lyx'>IPv6/IID/Unknown     0</programlisting>
<para>External database supported output since output version 3.0 (&gt;= 0.95.0)</para>
<itemizedlist>
<listitem>
<para>Country Code / Proto</para>
</listitem>
</itemizedlist>
<programlisting language='lyx'>...</programlisting>
<programlisting language='lyx'>*3*CC-code-proto/DE/ALL   9126</programlisting>
<programlisting language='lyx'>*3*CC-code-proto/DE/IPv4  5381</programlisting>
<programlisting language='lyx'>*3*CC-code-proto/DE/IPv6  3745</programlisting>
<programlisting language='lyx'>*3*CC-code-proto-list/DE  9126 5381 3745</programlisting>
<programlisting language='lyx'>...</programlisting>
<itemizedlist>
<listitem>
<para>Proto / Country Code (&#8220;ALL&#8221; line contains: ALL IPv4 IPv6)</para>
</listitem>
</itemizedlist>
<programlisting language='lyx'>...</programlisting>
<programlisting language='lyx'>*3*CC-proto-code/ALL/DE   96450</programlisting>
<programlisting language='lyx'>*3*CC-proto-code/IPv4/DE  36486</programlisting>
<programlisting language='lyx'>*3*CC-proto-code/IPv6/DE  59964</programlisting>
<programlisting language='lyx'>...</programlisting>
<programlisting language='lyx'>*3*CC-proto-code-list/ALL  108525 46483 62042</programlisting>
<itemizedlist>
<listitem>
<para>Autonomous System number / Proto</para>
</listitem>
</itemizedlist>
<programlisting language='lyx'>...</programlisting>
<programlisting language='lyx'>*3*AS-num-proto/8767/ALL   6054</programlisting>
<programlisting language='lyx'>*3*AS-num-proto/8767/IPv4  2705</programlisting>
<programlisting language='lyx'>*3*AS-num-proto/8767/IPv6  3349</programlisting>
<programlisting language='lyx'>*3*AS-num-proto-list/8767  6054 2705 3349</programlisting>
<programlisting language='lyx'>...</programlisting>
<itemizedlist>
<listitem>
<para>Proto / Autonomous System number (&#8220;ALL&#8221; line contains: ALL IPv4 IPv6)</para>
</listitem>
</itemizedlist>
<programlisting language='lyx'>...</programlisting>
<programlisting language='lyx'>*3*AS-proto-num/ALL/8767   6054</programlisting>
<programlisting language='lyx'>*3*AS-proto-num/IPv4/8767  2705</programlisting>
<programlisting language='lyx'>*3*AS-proto-num/IPv6/8767  3349</programlisting>
<programlisting language='lyx'>...</programlisting>
<programlisting language='lyx'>*3*AS-proto-num-list/ALL  108525 46483 62042</programlisting>
</section>
<section>
<title>Column output</title>
<para>Column output does not support version 3 extension, only simple statistics with a header line:</para>
<programlisting language='lyx'>$ zcat ip.bieringer.de-log.201*.gz | ipv6logstats -q -c </programlisting>
<programlisting language='lyx'> IPv4 IPv6 UNKNOWN IPv4/APNIC IPv4/ARIN IPv4/RIPE IPv4/LACNIC IPv4/UNKNOWN IPv6/6bone IPv6/IANA IPv6/APNIC IPv6/ARIN IPv6/RIPE IPv6/LACNIC IPv6/RESERVED IPv6/UNKNOWN IPv6/6to4/IANA IPv6/6to4/APNIC IPv6/6to4/ARIN IPv6/6to4/RIPE IPv6/6to4/LACNIC IPv6/6to4/RESERVED IPv6/6to4/UNKNOWN IPv6/Teredo/IANA IPv6/Teredo/APNIC IPv6/Teredo/ARIN IPv6/Teredo/RIPE IPv6/Teredo/LACNIC IPv6/Teredo/RESERVED IPv6/Teredo/UNKNOWN IPv6/NAT64/IANA IPv6/NAT64/APNIC IPv6/NAT64/ARIN IPv6/NAT64/RIPE IPv6/NAT64/LACNIC IPv6/NAT64/RESERVED IPv6/NAT64/UNKNOWN IPv6/IID/Global IPv6/IID/Random IPv6/IID/Manual IPv6/IID/ISATAP IPv6/IID/Unknown</programlisting>
<programlisting language='lyx'> 46233 62292 0 2397 3525 40198 97 16 0 0 129 839 61074 0 0 0 0 0 16 51 0 0 0 0 63 0 90 30 0 0 0 0 0 0 0 0 0 1436 58198 2055 353 0</programlisting>
<para>An optional prefix token can be given (&#8220;-p &lt;prefix&gt;&#8221;) to create e.g. in a for-loop one line per month and put month in front of statistics, also the header line can be suppressed (&#8220;-n&#8221;).</para>
<programlisting language='lyx'>$ zcat ip.bieringer.de-log.201*.gz | ipv6logstats -q -c -n -p ALL</programlisting>
<programlisting language='lyx'>ALL  46233 62292 0 2397 3525 40198 97 16 0 0 129 839 61074 0 0 0 0 0 16 51 0 0 0 0 63 0 90 30 0 0 0 0 0 0 0 0 0 1436 58198 2055 353 0 </programlisting>
</section>
</section>
<section>
<title>Examples</title>
<para>A demonstration with real data is available at <link xlink:href="http://mirrors.bieringer.de/stats/timeline.html">http://mirrors.bieringer.de/stats/timeline.html</link>.</para>
</section>
</section>
<section>
<title>Apache web server module &#8220;mod_ipv6calc&#8221;</title>
<para>This Apache web server module (since version 0.99.1, released 2015) interfaces with internal ipv6calc library to support</para>
<itemizedlist>
<listitem>
<para>Client IP address anonymization &#8220;on-the-fly&#8221;, exported to IPV6CALC_CLIENT_IP_ANON
</para>
<itemizedlist>
<listitem>
<para>depending on the configured anonymization method 3rd party database is required</para>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<para>Country code of client IP address, exported to IPV6CALC_CLIENT_COUNTRYCODE
</para>
<itemizedlist>
<listitem>
<para>requires 3rd party database: GeoIP or IP2Location or DB-IP.com</para>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<para>Autonomous System Number (ASN) of client IP address, exported to IPV6CALC_CLIENT_ASN
</para>
<itemizedlist>
<listitem>
<para>requires 3rd party database: GeoIP</para>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<para>Registry of client IP address, exported to IPV6CALC_CLIENT_REGISTRY
</para>
<itemizedlist>
<listitem>
<para>requires internal or &#8220;external&#8221; database</para>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<para>Configured IP address anonymization method, exported to IPV6CALC_ANON_METHOD</para>
</listitem>
</itemizedlist>
<section>
<title>Installation</title>
<para>Install compiled Apache module &#8220;mod_ipv6calc&#8221; to Apache&#8217;s module directory</para>
<para>Install included default configuration file &#8220;ipv6calc.conf&#8221; to Apache&#8217;s config directory (usually conf.d)</para>
</section>
<section>
<title>Configuration</title>
<para>Enable in &#8220;ipv6calc.conf&#8221; loading of module</para>
<programlisting language='lyx'>LoadModule ipv6calc_module modules/mod_ipv6calc.so</programlisting>
<para>Enable module itself </para>
<programlisting language='lyx'>ipv6calcEnable                         on</programlisting>
<para>Adjust configuration settings, if needed (see examples in &#8220;ipv6calc.conf&#8221;)</para>
<para>Review predefined log format</para>
<programlisting language='lyx'>LogFormat "%{IPV6CALC_CLIENT_IP_ANON}e \"%{IPV6CALC_CLIENT_COUNTRYCODE}e/%{IPV6CALC_CLIENT_ASN}e/%{IPV6CALC_CLIENT_REGISTRY}e/%{IPV6CALC_ANON_METHOD}e\" %u %t \"%r\" %&gt;s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined_anon</programlisting>
<para>Enable custom log with anonymized information, using the predefined LogFormat</para>
<programlisting language='lyx'>CustomLog logs/access_anon_log combined_anon</programlisting>
<para>Restart Apache web server, check error_log for any issues</para>
</section>
<section>
<title>Result</title>
<para>The new log file contains anonymized requests like</para>
<programlisting language='lyx'>252.176.92.172 "CN/23724/APNIC/keep-type-asn-cc" - [25/Jul/2015:13:20:25 +0200] "GET / HTTP/1.1" 200 3569 "-" "Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)"</programlisting>
<programlisting language='lyx'>a909:390a:909a:81d9:a909:4291:c02d:5d1d "CZ/43037/RIPENCC/keep-type-asn-cc" - [25/Jul/2015:12:59:00 +0200] "GET /robots.txt HTTP/1.1" 200 33 "-" "Mozilla/5.0 (compatible; SeznamBot/3.2; +http://fulltext.sblog.cz/)" </programlisting>
</section>
<section>
<title>Post-analysis in case of anonymization method &#8220;keep-type-asn-cc&#8221;</title>
<para>In case &#8220;keep-type-asn-cc&#8221; is configured and also working (required databases are available), related information of anonymized IP addresses can be retrieved using &#8220;ipv6calc&#8221; or &#8220;ipv6logstats&#8221;.</para>
<programlisting language='lyx'>$ ipv6calc -q -m -i 252.176.92.172</programlisting>
<programlisting language='lyx'>IPV4=252.176.92.172</programlisting>
<programlisting language='lyx'>IPV4_TYPE=unicast,anonymized,global</programlisting>
<programlisting language='lyx'>IPV4_AS_NUM=23724</programlisting>
<programlisting language='lyx'>IPV4_COUNTRYCODE=CN</programlisting>
<programlisting language='lyx'>IPV4_REGISTRY=APNIC </programlisting>
<programlisting language='lyx'>...</programlisting>
<programlisting language='lyx'>$ ipv6calc -q -m -i a909:390a:909a:81d9:a909:4291:c02d:5d1d</programlisting>
<programlisting language='lyx'>IPV6=a909:390a:909a:81d9:a909:4291:c02d:5d1d</programlisting>
<programlisting language='lyx'>IPV6_TYPE=unicast,anonymized-iid,anonymized-prefix,global-unicast,productive,iid,iid-local</programlisting>
<programlisting language='lyx'>IPV6_COUNTRYCODE=CZ</programlisting>
<programlisting language='lyx'>IPV6_AS_NUM=43037</programlisting>
<programlisting language='lyx'>IPV6_REGISTRY=RIPENCC</programlisting>
<programlisting language='lyx'>...</programlisting>
</section>
</section>
<section>
<title>History</title>
<para>Major extensions/changes are listed here</para>
<section>
<title>2025</title>
<itemizedlist>
<listitem>
<para>add support for MaxMindDB (IP2Location) (&gt;= 4.3.0)cd do</para>
</listitem>
</itemizedlist>
</section>
<section>
<title>2023</title>
<itemizedlist>
<listitem>
<para>add support for using MD5 from libmd (&gt;= 4.2.0)</para>
</listitem>
</itemizedlist>
</section>
<section>
<title>2021</title>
<itemizedlist>
<listitem>
<para>add support for compressed IPv4 addresses like 10/8 (&gt;= 3.1.0)</para>
</listitem>
<listitem>
<para>add support for octal representation of IPv4 addresses (&gt;= 3.3.0)</para>
</listitem>
<listitem>
<para>add Database Dump action (&gt;= 3.3.0)</para>
</listitem>
</itemizedlist>
</section>
<section>
<title>2020</title>
<itemizedlist>
<listitem>
<para>drop GeoIP(legacy) support (&gt;= 3.0.0)</para>
</listitem>
<listitem>
<para>drop db-ip.com(BerkeleyDB) support (&gt;= 3.0.0)</para>
</listitem>
</itemizedlist>
</section>
<section>
<title>2019</title>
<itemizedlist>
<listitem>
<para>add OUI-28 support (&gt;= 2.2.0)</para>
</listitem>
<listitem>
<para>add action &#8220;addr2cc&#8221; (can be used as replacement for geoiplookup) (&gt;= 2.1.0)</para>
</listitem>
<listitem>
<para>enable &#8220;geonameid&#8221; also in mod_ipv6calc (&gt;= 2.1.0)</para>
</listitem>
<listitem>
<para>add anonymization method &#8220;keep-type-geonameid&#8221; (&gt;= 2.1.0)</para>
</listitem>
<listitem>
<para>add support for MaxMindDB (GeoIP, db-ip.com) (&gt;= 2.0.0)</para>
</listitem>
<listitem>
<para>drop support of IP2Location libraries &lt; 7.0.1 (&gt;= 2.0.0)</para>
</listitem>
</itemizedlist>
</section>
<section>
<title>2017</title>
<itemizedlist>
<listitem>
<para>add support for LISP detection</para>
</listitem>
<listitem>
<para>add support for non-free versions <link xlink:href="http://www.db-ip.com/">DB-IP.com</link> databases</para>
</listitem>
<listitem>
<para>finally release 1.0.0 after 16 year of development</para>
</listitem>
</itemizedlist>
</section>
<section>
<title>2016</title>
<itemizedlist>
<listitem>
<para>implement action &#8217;test&#8217; and extend action &#8217;filter&#8217; with support of address ranges (&gt;= 0.99.2)</para>
</listitem>
</itemizedlist>
</section>
<section>
<title>2015</title>
<itemizedlist>
<listitem>
<para>Introduce mod_ipv6calc for Apache web server (&gt;= 0.99.1)</para>
</listitem>
<listitem>
<para>Add support for <link xlink:href="http://www.db-ip.com/">DB-IP.com</link> databases (by generated Berkeley DB files) (&gt;= 0.98.0)</para>
</listitem>
<listitem>
<para>Add support for &#8220;External&#8221; database files (generated Berkeley DB files), superseeding (if newer) built-in IPv4/IPv6-&gt;Registry and adding IPv4/IPv6-&gt;CountryCode support (&gt;= 0.98.0)</para>
</listitem>
<listitem>
<para>Extend filter options with support of CountryCode, ASN or Registry (&gt;= 0.99.0)</para>
</listitem>
<listitem>
<para>Add support for <link xlink:href="http://lite.ip2location.com/">IP2Location LITE</link> databases (&gt;= 0.99.0), add configurable IP2Location database autoselection support</para>
</listitem>
</itemizedlist>
</section>
<section>
<title>2014</title>
<itemizedlist>
<listitem>
<para>Shared library mode supported (reduces size of binaries)</para>
</listitem>
</itemizedlist>
</section>
<section>
<title>2013</title>
<itemizedlist>
<listitem>
<para>Prefix and IID anonymization methods</para>
</listitem>
<listitem>
<para>Support of dynamic load of GeoIP and IP2Location libraries</para>
</listitem>
<listitem>
<para>Specifying dedicated GeoIP and IP2Location database files is now replaced by specifying dedicated database directories to make especially for GeoIP use of more database files.</para>
</listitem>
</itemizedlist>
</section>
<section>
<title>2011</title>
<itemizedlist>
<listitem>
<para>ipv6calc/ipv6calcweb.cgi: enable included GeoIP support with IPv6 (usable with GeoIP &gt;= 1.4.5)</para>
</listitem>
<listitem>
<para>ipv6calc: extend for 6rd support (--action 6rd_local_prefix --6rd_prefix &lt;PREFIX&gt; --6rd_relay_prefix &lt;RELAY_PREFIX&gt;)</para>
</listitem>
<listitem>
<para>ipv6calc: enable stdin support for bulk transformation</para>
</listitem>
<listitem>
<para>ipv6calc: add support for NAT64 address type</para>
</listitem>
<listitem>
<para>ipv6calc: add option &#8220;forceprefix &lt;LENGTH&gt;&#8221; to print prefix of an address without a given prefix length</para>
</listitem>
<listitem>
<para>ipv6loganon: extend for pipe usage (e.g. in Apache log file directive) and write/append to specified file</para>
</listitem>
<listitem>
<para>General: add configure options to disable built-in databases (reduce binary size a lot, e.g. for embedded devices)</para>
</listitem>
</itemizedlist>
</section>
<section>
<title>2002-2010</title>
<para>See <link xlink:href="https://raw.githubusercontent.com/pbiering/ipv6calc/master/ChangeLog">ChangeLog@GitHub</link> for now</para>
</section>
<section>
<title>2001</title>
<itemizedlist>
<listitem>
<para>Start of development</para>
</listitem>
</itemizedlist>
</section>
</section>
</article>
<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>The ipv6calc Homepage</title><link rel="stylesheet" type="text/css" href="dbprojects.css" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /></head><body><div xml:lang="en-US" class="article" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="id1337"></a>The ipv6calc Homepage</h2></div><div><div class="author"><h3 class="author"><span class="firstname">Peter</span> <span class="surname">Bieringer</span></h3><div class="affiliation"><div class="address"><p>pb마t막ieringer맋ot맋e</p></div></div></div></div><div><div class="revhistory"><table style="border-style:solid; width:100%;" summary="Revision History"><tr><th align="left" valign="top" colspan="3"><strong>Revision History</strong></th></tr><tr><td align="left">Revision 12.0.1</td><td align="left">2025-05-11</td><td align="left">PB</td></tr></table></div></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="#id1343">General</a></span></dt><dd><dl><dt><span class="section"><a href="#id1339">Latest version</a></span></dt><dt><span class="section"><a href="#id1340">Included programs</a></span></dt><dt><span class="section"><a href="#id1341">Included databases</a></span></dt><dt><span class="section"><a href="#id1342">Possible external databases</a></span></dt></dl></dd><dt><span class="section"><a href="#id1344">License</a></span></dt><dt><span class="section"><a href="#id1345">Copyright</a></span></dt><dt><span class="section"><a href="#id1346">Author</a></span></dt><dt><span class="section"><a href="#id1362">Where to get sources or binaries</a></span></dt><dd><dl><dt><span class="section"><a href="#id1347">Latest version of sources</a></span></dt><dt><span class="section"><a href="#id1351">Releases</a></span></dt><dt><span class="section"><a href="#id1361">Ready to use packages for several operating systems:</a></span></dt></dl></dd><dt><span class="section"><a href="#id1366">Configuring &amp; Compiling</a></span></dt><dd><dl><dt><span class="section"><a href="#id1363">Configuring</a></span></dt><dt><span class="section"><a href="#id1364">Compiling</a></span></dt><dt><span class="section"><a href="#id1365">Configuring &amp; Compiling with Presets</a></span></dt></dl></dd><dt><span class="section"><a href="#id1369">Mailing Lists</a></span></dt><dd><dl><dt><span class="section"><a href="#id1367">ipv6calc-announce</a></span></dt><dt><span class="section"><a href="#id1368">ipv6calc</a></span></dt></dl></dd><dt><span class="section"><a href="#id1370">Bug Reports</a></span></dt><dt><span class="section"><a href="#id1400">Features of ipv6calc</a></span></dt><dd><dl><dt><span class="section"><a href="#id1371">Description</a></span></dt><dt><span class="section"><a href="#id1372">List of built-in features</a></span></dt><dt><span class="section"><a href="#id1387">Examples</a></span></dt><dt><span class="section"><a href="#id1388">Option style</a></span></dt><dt><span class="section"><a href="#id1399">Online help</a></span></dt></dl></dd><dt><span class="section"><a href="#id1404">Webserver log conversion helper program "ipv6logconv"</a></span></dt><dd><dl><dt><span class="section"><a href="#id1401">Supported options</a></span></dt><dt><span class="section"><a href="#id1402">Examples</a></span></dt><dt><span class="section"><a href="#id1403">Usage</a></span></dt></dl></dd><dt><span class="section"><a href="#id1415">Webserver log anonymization helper program "ipv6loganon"</a></span></dt><dd><dl><dt><span class="section"><a href="#id1409">Anonymization details</a></span></dt><dt><span class="section"><a href="#id1410">Supported log file formats</a></span></dt><dt><span class="section"><a href="#id1411">Supported options</a></span></dt><dt><span class="section"><a href="#id1414">Usage</a></span></dt></dl></dd><dt><span class="section"><a href="#id1420">External database update helper scripts</a></span></dt><dd><dl><dt><span class="section"><a href="#id1416">IP2Location</a></span></dt><dt><span class="section"><a href="#id1417">GeoIP</a></span></dt><dt><span class="section"><a href="#id1418">DB-IP.com</a></span></dt><dt><span class="section"><a href="#id1419">External</a></span></dt></dl></dd><dt><span class="section"><a href="#id1422">Perl CGI wrapper program "ipv6calcweb.cgi"</a></span></dt><dd><dl><dt><span class="section"><a href="#id1421">Examples</a></span></dt></dl></dd><dt><span class="section"><a href="#id1428">Webserver log statistics helper program "ipv6logstats"</a></span></dt><dd><dl><dt><span class="section"><a href="#id1423">Supported options</a></span></dt><dt><span class="section"><a href="#id1426">Usage</a></span></dt><dt><span class="section"><a href="#id1427">Examples</a></span></dt></dl></dd><dt><span class="section"><a href="#id1433">Apache web server module &#8220;mod_ipv6calc&#8221;</a></span></dt><dd><dl><dt><span class="section"><a href="#id1429">Installation</a></span></dt><dt><span class="section"><a href="#id1430">Configuration</a></span></dt><dt><span class="section"><a href="#id1431">Result</a></span></dt><dt><span class="section"><a href="#id1432">Post-analysis in case of anonymization method &#8220;keep-type-asn-cc&#8221;</a></span></dt></dl></dd><dt><span class="section"><a href="#id1447">History</a></span></dt><dd><dl><dt><span class="section"><a href="#id1434">2025</a></span></dt><dt><span class="section"><a href="#id1435">2023</a></span></dt><dt><span class="section"><a href="#id1436">2021</a></span></dt><dt><span class="section"><a href="#id1437">2020</a></span></dt><dt><span class="section"><a href="#id1438">2019</a></span></dt><dt><span class="section"><a href="#id1439">2017</a></span></dt><dt><span class="section"><a href="#id1440">2016</a></span></dt><dt><span class="section"><a href="#id1441">2015</a></span></dt><dt><span class="section"><a href="#id1442">2014</a></span></dt><dt><span class="section"><a href="#id1443">2013</a></span></dt><dt><span class="section"><a href="#id1444">2011</a></span></dt><dt><span class="section"><a href="#id1445">2002-2010</a></span></dt><dt><span class="section"><a href="#id1446">2001</a></span></dt></dl></dd></dl></div>

<div class="address"><p>pb마t막ieringer맋ot맋e</p></div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id1343"></a>General</h2></div></div></div>

<p>ipv6calc is a small utility written in programming language C to manipulate (not only) IPv6 addresses and is able to do other tricky things. Intentions were convering a given IPv6 address into compressed format, convering a given IPv6 address into the same format like shown in <span class="emphasis"><em>/proc/net/if_inet6 and (because it was not difficulty) migrating the Perl program <span class="emphasis"><em>ip6_int into. Now only one utility is needed to do a lot.</em></span></em></span></p>
<p>This utility was also used in the past to extend features on network-functions-ipv6 library, used by initscripts-ipv6.</p>
<p>Note: this tool got also its <a class="ulink" href="http://freecode.com/projects/ipv6calc/" target="_top">freecode.com (former freshmeat, now also EOL) / ipv6calc</a> page (but this is not maintained by the author)</p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1339"></a>Latest version</h3></div></div></div>

<p>Latest version since last update of this page is 4.3.1</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1340"></a>Included programs</h3></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>&#8220;ipv6calc&#8221;: the main utility</p>
</li><li class="listitem">
<p>&#8220;ipv6calcweb&#8221;: CGI wrapper for ipv6calc&#8217;s address information output</p>
</li><li class="listitem">
<p>&#8220;ipv6logconv&#8221;: log converter (IPv4/IPv6)</p>
</li><li class="listitem">
<p>&#8220;ipv6loganon&#8221;: log anonymizer (IPv4/IPv6)</p>
</li><li class="listitem">
<p>&#8220;ipv6logstats&#8221;: log statistic generator (IPv4/IPv6)</p>
</li><li class="listitem">
<p>&#8220;mod_ipv6calc&#8221;: Apache module</p>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1341"></a>Included databases</h3></div></div></div>

<p>If not disabled during compiling of the tool, following databases are statically included, since version 0.95.0 internally mentioned as &#8220;BuiltIn&#8221;:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>IEEE IAB, OUI, OUI-28, OUI-36 databases (for decoding vendor part of MAC/EUI-48/EUI-64)</p>
</li><li class="listitem">
<p>IPv4 assignment databases from IANA, ARIN, RIPENCC, APNIC, LACNIC, AFRINIC (for selecting proper registry in ipv6calcweb.cgi and IPv4 anonymization)</p>
</li><li class="listitem">
<p>IPv6 assignment databases from IANA, ARIN, RIPENCC, APNIC, LACNIC, AFRINIC (for selecting proper registry in ipv6calcweb.cgi and IPv6 anonymization)</p>
</li><li class="listitem">
<p>ASN assignment databases from IANA, ARIN, RIPENCC, APNIC, LACNIC, AFRINIC (for IPv4/IPv6 anonymization)</p>
</li><li class="listitem">
<p>LISP assignment database for supplying extra info</p>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1342"></a>Possible external databases</h3></div></div></div>

<p>If enabled during compiling the tool, following external (but local stored) databases can be used</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p><a class="ulink" href="http://www.maxmind.com/" target="_top">GeoIP</a>
</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<p>IPv4 &#8220;legacy&#8221; (since 0.61.0, released 2006 until 3.0.0 released 2020)</p>
</li><li class="listitem">
<p>IPv6 &#8220;legacy&#8221; (since 0.90.0, released 2011, req. GeoIP &gt;= 1.4.5 until 3.0.0 released 2020)</p>
</li><li class="listitem">
<p>GeoIP2 (native MaxMindDB file support since 2.0.0, release 2019)</p>
</li></ul></div>
</li><li class="listitem">
<p><a class="ulink" href="http://www.ip2location.com/" target="_top">IP2Location</a>
</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<p>IPv4 (since 0.60.0, released 2006)</p>
</li><li class="listitem">
<p>IPv6 (since 0.70.0, released 2007, <a class="ulink" href="http://lite.ip2location.com/" target="_top">IP2Location LITE IPv6 Databases</a> since 0.99.0, released 2015)</p>
</li><li class="listitem">
<p>release 0.99.0 is tested against IP2Location &gt;= 4.0.2</p>
</li><li class="listitem">
<p>release &gt;= 2.0.0 &amp;&amp; &lt; 3.0.0 is only working with IP2Location &gt;= 7.0.1</p>
</li><li class="listitem">
<p>release &gt;= 3.0.0 is only working with IP2Location &gt;= 8.2.0</p>
</li><li class="listitem">
<p>native MaxMindDB files (support since 4.3.0, released 2025)</p>
</li><li class="listitem">
<p>ASN database files (support since 4.3.2, released 2025)</p>
</li></ul></div>
</li><li class="listitem">
<p><a class="ulink" href="http://www.db-ip.com/" target="_top">DB-IP.com</a></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<p>(since 0.98.0, released 2015 until 3.0.0 released 2020) based on local Berkeley DB files generated from downloaded CSV files</p>
</li><li class="listitem">
<p>native MaxMindDB files (support since 2.0.0, released 2019)</p>
</li><li class="listitem">
<p>MaxMindDB file &#8220;IP to ASN-Lite&#8221; (support since 4.3.1, released 2025)</p>
</li></ul></div>
</li><li class="listitem">
<p>&#8220;External&#8221; (since 0.98.0, released 2015), based on local Berkeley DB files, generated from downloaded TXT/XML files (registries assignment databases). Supporting IPv4/IPv6 to Registries and IPv4/IPv6 to CountryCode. If newer, overruling the related included databases.</p>
</li></ul></div>
<p>Since version 0.95.0 the tool can be compiled to use dynamically loading of library, means the binaries can be also used on systems where IP2Location or GeoIP libraries are not existing. On such system, the support is simply disabled then and some capabilities/features which requires the databases are disabled.</p>
<p>Since version 0.97.4 also fallback code for GeoIP and IP2Location is included in the source package, means that support of dynamically loading of library can be included during compilation without having related development sources on the system.</p>
<p>Since version 2.0.0 MaxMindDB is supported (linked or dynamically loaded)</p>
<p>Since version 3.0.0 GeoIP(legacy) and db-ip.com(BerkeleyDB) is removed</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id1344"></a>License</h2></div></div></div>

<p>The program is published under the GNU GPL version 2.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id1345"></a>Copyright</h2></div></div></div>

<p>(C) 2001 - 2024 by Dr. Peter Bieringer</p>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id1346"></a>Author</h2></div></div></div>

<p>The author of ipv6calc is</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p><a class="ulink" href="mailto:pb@bieringer.de" target="_top">Dr. Peter Bieringer</a> with some minor contribution by others</p>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id1362"></a>Where to get sources or binaries</h2></div></div></div>

<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1347"></a>Latest version of sources</h3></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>Via GitHub (since 2016-09-05) at <a class="ulink" href="https://github.com/pbiering/ipv6calc" target="_top">GitHub / ipv6calc</a></p>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1351"></a>Releases</h3></div></div></div>

<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1348"></a>as tar.gz or zip</h4></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>via HTTPS at <a class="ulink" href="https://github.com/pbiering/ipv6calc/releases" target="_top">GitHub / ipv6calc / releases</a> </p>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1349"></a>as tar.gz (signed)</h4></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>from <a class="ulink" href="http://www.deepspace6.net/" target="_top">DeepSpace6</a> via FTP <a class="ulink" href="ftp://ftp.deepspace6.net/pub/ds6/sources/ipv6calc/" target="_top">DeepSpace6 / anonymous FTP</a> or HTTP <a class="ulink" href="http://www.deepspace6.net/ftp/pub/ds6/sources/ipv6calc/" target="_top">www.deepspace6.net mapped FTP</a></p>
</li><li class="listitem">
<p>via <a class="ulink" href="ftp://ftp.bieringer.de/pub/linux/IPv6/ipv6calc/" target="_top">ftp.bieringer.de / anonymous FTP</a> or HTTP at <a class="ulink" href="http://www.bieringer.de/ftp/pub/linux/IPv6/ipv6calc/" target="_top">www.bieringer.de mapped FTP</a></p>
</li></ul></div>
<p>Since version 0.95.0 packages are signed with new GPG key, also available here: <a class="ulink" href="ftp://ftp.bieringer.de/pub/linux/IPv6/ipv6calc/CODE-GPG-KEY-bieringer.de-2013" target="_top">CODE-GPG-KEY-bieringer.de-2013 @ftp.bieringer.de</a> or <a class="ulink" href="ftp://ftp.deepspace6.net/pub/ds6/sources/ipv6calc/CODE-GPG-KEY-bieringer.de-2013" target="_top">CODE-GPG-KEY-bieringer.de-2013 @ftp.deepspace6.net</a></p>
<pre class="programlisting">Key fingerprint: AAB3 8CB7 97C7 50C7 78C6 08C6 DDEB 141D F738 0F61</pre>
<pre class="programlisting">uid: Peter Bieringer (Code Signing Key 2013) &lt;code@bieringer.de&gt;</pre>
<p>A SPEC file is included, so you can build a RPM from tar.gz using</p>
<pre class="programlisting">$ rpmbuild -ta path/to/ipv6calc-$version.tar.gz</pre>
<p>In addition, conditional build options are available (see related configure options below):</p>
<pre class="programlisting">--without ip2location</pre>
<pre class="programlisting">--without mmdb (which disables GeoIP v2 and db-ip.com v2)</pre>
<pre class="programlisting">--without external</pre>
<pre class="programlisting">--without shared</pre>
<pre class="programlisting">--without mod_ipv6calc</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1350"></a>as RPM</h4></div></div></div>

<p>Can be searched via <a class="ulink" href="http://www.rpmfind.net/linux/rpm2html/search.php?query=ipv6calc" target="_top">rpmfind / ipv6calc</a>.</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1361"></a>Ready to use packages for several operating systems:</h3></div></div></div>

<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1352"></a>Fedora Linux</h4></div></div></div>

<p>Fedora 29 is the current developing platform, so use given hints above to create a RPM. Since Fedora 7 this package is included by default.</p>
<p>See also <a class="ulink" href="https://src.fedoraproject.org/rpms/ipv6calc" target="_top">FedoraProject / Packages / ipv6calc</a></p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1353"></a>Red Hat Enterprise Linux and clones</h4></div></div></div>

<p>It&#8217;s tested by the developer that creation of the RPM is working fine starting with RHEL 4.</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>Major version 5 has the package included by default (but a rather old version)
</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<p>RPMs of newer releases are available as test builds on koji, see related URL in announcements <a class="ulink" href="https://lists.deepspace6.net/pipermail/ipv6calc-announce/" target="_top">ipv6calc-announce / list archive</a></p>
</li><li class="listitem">
<p>*** Untested since version 2.0.0 because OS is out of support ***</p>
</li></ul></div>
</li><li class="listitem">
<p>Major version 6: available since September 2014 on <a class="ulink" href="https://fedoraproject.org/wiki/EPEL" target="_top">FedoraProject / EPEL</a>, see also <a class="ulink" href="https://src.fedoraproject.org/rpms/ipv6calc" target="_top">FedoraProject / Packages / ipv6calc</a></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<p>*** Untested since version 3.0.1 because OS is out of support ***</p>
</li></ul></div>
</li><li class="listitem">
<p>Major version 7: available since Decenber 2016 on <a class="ulink" href="https://fedoraproject.org/wiki/EPEL" target="_top">FedoraProject / EPEL</a>, see also <a class="ulink" href="https://src.fedoraproject.org/rpms/ipv6calc" target="_top">FedoraProject / Packages / ipv6calc</a></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<p>*** Untested since version 4.2.1 because OS is out of support ***</p>
</li></ul></div>
</li><li class="listitem">
<p>Major version 8: available since September 2019 on <a class="ulink" href="https://fedoraproject.org/wiki/EPEL" target="_top">FedoraProject / EPEL</a>, see also <a class="ulink" href="https://src.fedoraproject.org/rpms/ipv6calc" target="_top">FedoraProject / Packages / ipv6calc</a></p>
</li><li class="listitem">
<p>Major version 9: available since December 2021 on <a class="ulink" href="https://fedoraproject.org/wiki/EPEL" target="_top">FedoraProject / EPEL</a>, see also <a class="ulink" href="https://src.fedoraproject.org/rpms/ipv6calc" target="_top">FedoraProject / Packages / ipv6calc</a></p>
</li><li class="listitem">
<p>Major version 10: available since January 2025 on <a class="ulink" href="https://fedoraproject.org/wiki/EPEL" target="_top">FedoraProject / EPEL</a>, see also <a class="ulink" href="https://src.fedoraproject.org/rpms/ipv6calc" target="_top">FedoraProject / Packages / ipv6calc</a></p>
</li></ul></div>
<p>AlmaLinux 8+9+10 are also platforms for regression tests.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1354"></a>Gentoo/Funtoo</h4></div></div></div>

<p>Package is maintained, nevertheless, Funtoo is used as platform for regression tests.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1355"></a>Ubuntu</h4></div></div></div>

<p>Package is maintained, more information can be found at <a class="ulink" href="https://packages.ubuntu.com/ipv6calc" target="_top">https://packages.ubuntu.com/ipv6calc</a></p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1356"></a>Debian GNU/Linux</h4></div></div></div>

<p>Package is maintained, more information can be found at <a class="ulink" href="http://packages.debian.org/ipv6calc" target="_top">http://packages.debian.org/ipv6calc</a></p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1357"></a>openSUSE</h4></div></div></div>

<p>Package is maintained, more information can be found at <a class="ulink" href="http://download.opensuse.org/repositories/home:/uebelhacker/" target="_top">http://download.opensuse.org/repositories/home:/uebelhacker/</a></p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1358"></a>NetBSD</h4></div></div></div>

<p>See here for more: <a class="ulink" href="ftp://ftp.netbsd.org/pub/pkgsrc/current/pkgsrc/net/ipv6calc/README.html" target="_top">ftp://ftp.netbsd.org/pub/pkgsrc/current/pkgsrc/net/ipv6calc/README.html</a></p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1359"></a>FreeBSD</h4></div></div></div>

<p>See here for more: <a class="ulink" href="http://www.freshports.org/net-mgmt/ipv6calc/" target="_top">http://www.freshports.org/net-mgmt/ipv6calc/</a> (<a class="ulink" href="http://www.freebsd.org/cgi/query-pr.cgi?pr=34441" target="_top">http://www.freebsd.org/cgi/query-pr.cgi?pr=34441</a>)</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1360"></a>OpenBSD</h4></div></div></div>

<p>See here for more: <a class="ulink" href="http://www.openbsd.org/cgi-bin/cvsweb/ports/net/ipv6calc/" target="_top">http://www.openbsd.org/cgi-bin/cvsweb/ports/net/ipv6calc/</a></p>
</div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id1366"></a>Configuring &amp; Compiling</h2></div></div></div>

<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1363"></a>Configuring</h3></div></div></div>

<p>Following &#8220;ipc6calc&#8221; related configure options are currently supported (note: disabling the internal databases reduces the size of the resulting binaries/shared library a lot):</p>
<pre class="programlisting">--disable-dynamic-load  Disable dynamic load of libraries (default: enabled)</pre>
<pre class="programlisting">--disable-db-ieee        Disable build-in IEEE database (default: enabled)</pre>
<pre class="programlisting">--disable-db-ipv4        Disable build-in IPv4 database (default: enabled)</pre>
<pre class="programlisting">--disable-db-ipv6        Disable build-in IPv6 database (default: enabled)</pre>
<pre class="programlisting">--disable-db-as-registry Disable built-in AS-to-Registry database (default: enabled)</pre>
<pre class="programlisting">--disable-db-cc-registry Disable built-in CountryCode-to-Registry database (default: enabled) </pre>
<pre class="programlisting">--disable-geoip2         Disable MaxMindDB support for GeoIP (default: enabled)</pre>
<pre class="programlisting">--disable-dbip2          Disable MaxMindDB support for db-ip.com (default: enabled) </pre>
<pre class="programlisting">--disable-ip2location2   Disable MaxMindDB support for IP2Location (default: enabled) </pre>
<pre class="programlisting">--enable-mmdb            Enable MaxMindDB support (GeoIP/db-ip.com) (default: disabled) </pre>
<pre class="programlisting">--enable-external        Enable external db support (default: disabled) </pre>
<pre class="programlisting">--enable-ip2location     Enable IP2Location support (default: disabled)</pre>
<pre class="programlisting">--enable-mod_ipv6calc    Enable build of mod_ipv6calc for Apache (default: disabled) </pre>
<pre class="programlisting">--with-mmdb-dynamic     Enable use of dynamic loading of MaxMindDB library (default=no)</pre>
<pre class="programlisting">--with-mmdb-headers=DIR MaxMindDB include files location</pre>
<pre class="programlisting">--with-mmdb-lib=DIR     MaxMindDB library location</pre>
<pre class="programlisting">--with-mmdb-dyn-lib=NAME Use specified MaxMindDB dynamic library, default: libmaxminddb.so.0 </pre>
<pre class="programlisting">--with-ip2location-headers=DIR      IP2Location include files location</pre>
<pre class="programlisting">--with-ip2location-headers-fallback IP2Location include files from internal fallback location (only usable with dynamic load option)                          </pre>
<pre class="programlisting">--with-ip2location-lib=FILE         IP2Location library location</pre>
<pre class="programlisting">--with-ip2location-static           Explicitly link IP2Location statically (default=no)</pre>
<pre class="programlisting">--with-ip2location-dynamic          Enable use of dynamic loading of IP2Location library (default=no)</pre>
<pre class="programlisting">--with-ip2location-db=DIR           Use specified IP2Location database directory, default: /usr/share/IP2Location</pre>
<pre class="programlisting">--with-ip2location-dyn-lib=NAME     Use specified IP2Location dynamic library, default: libIP2Location.so</pre>
<pre class="programlisting">--with-geoip-db=DIR             Use specified GeoIP database directory, default: /usr/share/GeoIP</pre>
<pre class="programlisting">--with-dbip-db=DIR      Use specified db-ip.com database directory, default: /usr/share/DBIP</pre>
<pre class="programlisting">--with-external-db=DIR  Use specified external database directory, default: /usr/share/ipv6calc/db </pre>
<pre class="programlisting">--with-apxs=NAME        name of the apxs executable (apxs) </pre>
<pre class="programlisting">--enable-shared                 Enable shared library build (default: disabled)</pre>
<pre class="programlisting">--enable-bundled-getopt         Enable bundled getopt library (default: autoselected)</pre>
<pre class="programlisting">--enable-bundled-md5            Enable bundled MD5 library (default: autoselected)</pre>
<pre class="programlisting">--enable-libmd-md5              Enforce use of libmd MD5 implementation (default: autoselected)</pre>
<pre class="programlisting">--enable-openssl-evp-md5        Enforce use of OpenSSL EVP MD5 implementation (default: autoselected)</pre>
<pre class="programlisting">--enable-openssl-md5            Enforce use of OpenSSL legacy MD5 implementation (default: autoselected) </pre>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1364"></a>Compiling</h3></div></div></div>

<p>As usual, use</p>
<pre class="programlisting">$ make</pre>
<p>and run tests afterwards using</p>
<pre class="programlisting">$ make test</pre>
<p>or at least (e.g. if external databases are not available)</p>
<pre class="programlisting">$ make test-minimal</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1365"></a>Configuring &amp; Compiling with Presets</h3></div></div></div>

<p>A shell script is included which can configure and compile with standard presets (also used during regression tests):</p>
<pre class="programlisting">$ ./autogen.sh -h</pre>
<pre class="programlisting">Supported options:</pre>
<pre class="programlisting">   -?|-h|--help          : this help</pre>
<pre class="programlisting">   -n|--no-make          : stop before running 'make'</pre>
<pre class="programlisting">   -a|--all              : enable GeoIP/IP2Location/db-ip.com/External/mod_ipv6calc support</pre>
<pre class="programlisting">   -A|--ALL              : enable GeoIP/IP2Location/db-ip.com/External/mod_ipv6calc support with dynamic library support</pre>
<pre class="programlisting">   -m|--mmdb             : enable MaxMindDB support (GeoIP/db-ip.com)</pre>
<pre class="programlisting">   --mmdb-dyn|-M         : switch to dynamic library loading of MaxMindDB</pre>
<pre class="programlisting">   --disable-geoip2      : disable MaxMindDB support for GeoIP</pre>
<pre class="programlisting">   --disable-dbip2       : disable MaxMindDB support for db-ip.com</pre>
<pre class="programlisting">   --disable-ip2location2: disable MaxMindDB support for IP2Location</pre>
<pre class="programlisting">   -i|--ip2location      : enable IP2Location support</pre>
<pre class="programlisting">   --ip2location-dyn|-I  : switch to dynamic library loading of IP2Location</pre>
<pre class="programlisting">   -e|--external         : enable external database support</pre>
<pre class="programlisting">   --disable-db-ieee     : disable built-in IEEE database</pre>
<pre class="programlisting">   --disable-db-ipv4     : disable built-in IPv4 database</pre>
<pre class="programlisting">   --disable-db-ipv6     : disable built-in IPv6 database</pre>
<pre class="programlisting">   --disable-builtin     : disable all internal databases</pre>
<pre class="programlisting">   -S                    : enable shared library mode</pre>
<pre class="programlisting">   --no-static-build     : skip static build</pre>
<pre class="programlisting">   --no-test             : skip 'make test'</pre>
<pre class="programlisting">   --clang               : use 'clang' instead of default (usually 'gcc')</pre>
<pre class="programlisting">                            if used before '-a|-A' mod_ipv6calc support will be excluded (incompatible linker issue)</pre>
<pre class="programlisting">   --m32                 : compile for 32-bit</pre>
<pre class="programlisting">   --enable-openssl-md5  : use legacy OpenSSL MD5 implementation</pre>
<pre class="programlisting">   --enable-libmd-md5    : use libmd MD5 implementation</pre>
<pre class="programlisting">   --relax               : don't stop on compiler warnings</pre>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id1369"></a>Mailing Lists</h2></div></div></div>

<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1367"></a>ipv6calc-announce</h3></div></div></div>

<div class="variablelist"><dl class="variablelist"><dt><span class="term">Reason:</span></dt><dd>
<p>sending announcements of new versions</p>
</dd><dt><span class="term">Traffic:</span></dt><dd>
<p>very low</p>
</dd><dt><span class="term">Postings:</span></dt><dd>
<p>only moderators are allowed to post</p>
</dd><dt><span class="term">Information:</span></dt><dd>
<p><a class="ulink" href="https://lists.deepspace6.net/postorius/lists/ipv6calc-announce.lists.deepspace6.net/" target="_top">DeepSpace6 / maillist ipv6calc-announce</a></p>
</dd></dl></div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1368"></a>ipv6calc</h3></div></div></div>

<div class="variablelist"><dl class="variablelist"><dt><span class="term">Reason:</span></dt><dd>
<p>discussions</p>
</dd><dt><span class="term">Traffic:</span></dt><dd>
<p>low</p>
</dd><dt><span class="term">Postings:</span></dt><dd>
<p>subscribers</p>
</dd><dt><span class="term">Information:</span></dt><dd>
<p><a class="ulink" href="https://lists.deepspace6.net/postorius/lists/ipv6calc.lists.deepspace6.net/" target="_top">DeepSpace6 / maillist ipv6calc</a></p>
</dd></dl></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id1370"></a>Bug Reports</h2></div></div></div>

<p>You can send bug reports to the author himself or subscribe to maillist &#8220;ipv6calc&#8221; and send it to the list.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id1400"></a>Features of ipv6calc</h2></div></div></div>

<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1371"></a>Description</h3></div></div></div>

<p>The main program named &#8220;ipv6calc&#8221; is able to recognize many (not only) IPv6 address formats and depending on a selectable action (not required) a selectable output format can be specified. Also it has the capability to show detailed information of an IPv4/IPv6 address or anonymize it.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1372"></a>List of built-in features</h3></div></div></div>

<p>Option &#8220;-v&#8221; shows built-in features, depending on configuration before compiling:</p>
<pre class="programlisting">$ ipv6calc -v</pre>
<pre class="programlisting">ipv6calc: version 4.3.0 GeoIP GeoIPv6 IP2Location IP2Location6 IP2Location2 IP2Location2v6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID DB_IPV4_DUMP_CC DB_IPV6_DUMP_CC ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID</pre>
<p>Option &#8220;-v -v&#8221; (since 0.91.0) shows built-in features and capabilities in detail, depending on configuration before compiling (EXAMPLE):</p>
<pre class="programlisting">$ ipv6calc -vv</pre>
<pre class="programlisting">ipv6calc: version 4.3.1 GeoIP GeoIPv6 IP2Location IP2Location6 IP2Location2 IP2Location2v6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID DB_IPV4_DUMP_CC DB_IPV6_DUMP_CC ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID</pre>
<pre class="programlisting">Capabilities: GeoIP2(linked/MMDB) IP2Location(linked/BIN) DBIP2(linked/MMDB) IP2Location2(linked/MMDB) ExternalDatabase DB_AS_REG(BuiltIn) DB_CC_REG(BuiltIn) DB_IPV4_REG(BuiltIn) DB_IPV6_REG(BuiltIn) DB_IEEE(BuiltIn)</pre>
<pre class="programlisting">Internal main     library version: 4.3.1  API: 4.3.0  (built-in)</pre>
<pre class="programlisting">Internal database library version: 4.3.1  API: 4.3.0  (built-in)</pre>
<pre class="programlisting">Linked MD5 implementation: OpenSSL EVP MD5</pre>
<pre class="programlisting">MaxMindDB for GeoIP2/DBIP2/IP2Location2 support enabled</pre>
<pre class="programlisting">MaxMindDB dynamic library version (on this system): 1.12.2</pre>
<pre class="programlisting">GeoIP2(MaxMindDB) support enabled</pre>
<pre class="programlisting">GeoIP(MMDB) database support: Country4=1 Country6=1 City4=1 City6=1 ASN4=1 ASN6=1 GeonameID4=1 GeonameID6=1</pre>
<pre class="programlisting">IP2Location support enabled, compiled with API version: 8.6.1, dynamically linked with version: API=8.6.1 Major=8 MajorMinor=806</pre>
<pre class="programlisting">IP2Location(BIN) database support: Country4=1 Country6=1 City4=1 City6=1 ASN4=1 ASN6=1 GeonameID4=0 GeonameID6=0</pre>
<pre class="programlisting">DBIP(MaxMindDB) support enabled</pre>
<pre class="programlisting">db-ip.com(MMDB) database support: Country4=1 Country6=1 City4=1 City6=1 ASN4=1 ASN6=1 GeonameID4=1 GeonameID6=1</pre>
<pre class="programlisting">IP2Location(MaxMindDB) support enabled</pre>
<pre class="programlisting">IP2Location(MMDB) database support: Country4=1 Country6=1 City4=0 City6=0 ASN4=0 ASN6=0 GeonameID4=1 GeonameID6=1</pre>
<pre class="programlisting">External(BDB) available databases: Country4=1 Country6=1 IPV4_REG=1 IPV6_REG=1</pre>
<pre class="programlisting">BuiltIn databases available: ASN_REG=1 IPV4_REG=1 IPV6_REG=1 IEEE=1 CC_REG=1</pre>
<pre class="programlisting">DB features: 0xffdfffff</pre>
<pre class="programlisting">GeoIP(MMDB): features available/implemented: 0x03063ff0/0x03063ff0 (100%)</pre>
<pre class="programlisting">GeoIP(MMDB): info of available databases in directory: /var/local/share/GeoIP</pre>
<pre class="programlisting">GeoIP(MMDB): IPv4/v6 CountryCode (LITE)    : [1] GeoLite2-Country.mmdb          (GeoLite2-Country Copyright (c) 2025 MaxMind All Rights Reserved, created: 20250121-103200 UTC)</pre>
<pre class="programlisting">GeoIP(MMDB): IPv4/v6 City (LITE)           : [2] GeoLite2-City.mmdb             (GeoLite2-City Copyright (c) 2025 MaxMind All Rights Reserved, created: 20250121-102358 UTC)</pre>
<pre class="programlisting">GeoIP(MMDB): IPv4/v6 ASN (LITE)            : [3] GeoLite2-ASN.mmdb              (GeoLite2-ASN Copyright (c) 2025 MaxMind All Rights Reserved, created: 20250121-081512 UTC)</pre>
<pre class="programlisting">GeoIP(MMDB): detected best databases LITE   : Country4=2  Country6=2  City4=2  City6=2  ASN4=3  ASN6=3  GeonameID4=2  GeonameID6=2</pre>
<pre class="programlisting">GeoIP(MMDB): detected best databases COMM   : Country4=-  Country6=-  City4=-  City6=-  ASN4=-  ASN6=-  GeonameID4=-  GeonameID6=-</pre>
<pre class="programlisting">GeoIP(MMDB): selected best databases normal : Country4=2  Country6=2  City4=2  City6=2  ASN4=3  ASN6=3  GeonameID4=2  GeonameID6=2</pre>
<pre class="programlisting">GeoIP(MMDB): selected best databases method : COMM older than 12 months are deselected in case of LITE is available</pre>
<pre class="programlisting">GeoIP(MMDB): selected best databases method : COMM/LITE with more features are only selected in case not older than 1 months of already found COMM/LITE</pre>
<pre class="programlisting">IP2Location(BIN): features available/implemented: 0x0c003ff0/0x0c003ff0 (100%)</pre>
<pre class="programlisting">IP2Location(BIN): info of available databases in directory: /var/local/share/IP2Location</pre>
<pre class="programlisting">IP2Location(BIN): Copyright (c) IP2Location All Rights Reserved</pre>
<pre class="programlisting">IP2Location(BIN): IPv4 Co/Re/Ci/LaLo/ZI/TZ/IS/Do/Ne/Ar/We/Mo/El/Us/Ad/Ca/Di/AS:[226] IP-COUNTRY-REGION-CITY-LATITUDE-LONGITUDE-ZIPCODE-TIMEZONE-ISP-DOMAIN-NETSPEED-AREACODE-WEATHER-MOBILE-ELEVATION-USAGETYPE-ADDRESSTYPE-CATEGORY-DISTRICT-ASN-SAMPLE.BIN (IP2L-DB26 IPv4 IPv6 SAMPLE 20202502)</pre>
<pre class="programlisting">IP2Location(BIN): IPv6 Co/Re/Ci/LaLo/ZI/TZ/IS/Do/Ne/Ar/We/Mo/El/Us/Ad/Ca/Di/AS:[326] IPV6-COUNTRY-REGION-CITY-LATITUDE-LONGITUDE-ZIPCODE-TIMEZONE-ISP-DOMAIN-NETSPEED-AREACODE-WEATHER-MOBILE-ELEVATION-USAGETYPE-ADDRESSTYPE-CATEGORY-DISTRICT-ASN.SAMPLE.BIN (IP2L-DB26 IPv4 IPv6 SAMPLE 20202502)</pre>
<pre class="programlisting">IP2Location(BIN): IPv4 Country                                    :[401] IP2LOCATION-LITE-DB1.BIN            (IP2L-DB1 IPv4 IPv6 LITE 20250101)</pre>
<pre class="programlisting">IP2Location(BIN): IPvx Country                                    :[501] IP2LOCATION-LITE-DB1.IPV6.BIN       (IP2L-DB1 IPv4 IPv6 LITE 20250101)</pre>
<pre class="programlisting">IP2Location(BIN): IPvx Co/Re/Ci/LattLong/ZIP/TZ                   :[111] IPV6-COUNTRY-REGION-CITY-LATITUDE-LONGITUDE-ZIPCODE-TIMEZONE.BIN (IP2L-DB11 IPv4 IPv6 20250115)</pre>
<pre class="programlisting">IP2Location(BIN): detected best databases SAMPLE : Country4=226  Country6=326  City4=226  City6=326  ASN4=226  ASN6=326  GeonameID4=-    GeonameID6=-  </pre>
<pre class="programlisting">IP2Location(BIN): detected best databases LITE   : Country4=501  Country6=501  City4=-    City6=-    ASN4=-    ASN6=-    GeonameID4=-    GeonameID6=-  </pre>
<pre class="programlisting">IP2Location(BIN): detected best databases COMM   : Country4=111  Country6=111  City4=111  City6=111  ASN4=-    ASN6=-    GeonameID4=-    GeonameID6=-  </pre>
<pre class="programlisting">IP2Location(BIN): selected best databases LI-&gt;SA*: Country4=-    Country6=-    City4=-    City6=-    ASN4=-    ASN6=-    GeonameID4=-    GeonameID6=-  </pre>
<pre class="programlisting">IP2Location(BIN): selected best databases normal : Country4=111  Country6=111  City4=111  City6=111  ASN4=226  ASN6=326  GeonameID4=-    GeonameID6=-  </pre>
<pre class="programlisting">IP2Location(BIN): selected best databases method : * = autoswitch from LITE to SAMPLE enabled in case not older than 12 months and having more features</pre>
<pre class="programlisting">IP2Location(BIN): selected best databases method : COMM older than 12 months are deselected in case of LITE is available</pre>
<pre class="programlisting">IP2Location(BIN): selected best databases method : COMM/LITE/SAMPLE with more features are only selected in case not older than 1 months of already found COMM/LITE/SAMPLE</pre>
<pre class="programlisting">IP2Location(BIN): selected best databases method : softlinks skipped-by-default</pre>
<pre class="programlisting">db-ip.com(MMDB): features available/implemented: 0x30063ff0/0x30063ff0 (100%)</pre>
<pre class="programlisting">db-ip.com(MMDB): info of available databases in directory: /var/local/share/DBIP</pre>
<pre class="programlisting">db-ip.com(MMDB): IPv4/v6 CountryCode (LITE)    : [1] dbip-country-lite.mmdb         (DBIP-Country-Lite Copyright (c) 2025 db-ip.com All Rights Reserved, created: 20250201-021656 UTC)</pre>
<pre class="programlisting">db-ip.com(MMDB): IPv4/v6 City (LITE)           : [2] dbip-city-lite.mmdb            (DBIP-City-Lite Copyright (c) 2025 db-ip.com All Rights Reserved, created: 20250201-022127 UTC)</pre>
<pre class="programlisting">db-ip.com(MMDB): IPv4/v6 ASN (LITE)            : [3] dbip-asn-lite.mmdb             (DBIP-ASN-Lite (compat=GeoLite2-ASN) Copyright (c) 2025 db-ip.com All Rights Reserved, created: 20250201-022141 UTC)</pre>
<pre class="programlisting">db-ip.com(MMDB): detected best databases LITE   : Country4=2  Country6=2  City4=2  City6=2  ASN4=3  ASN6=3  GeonameID4=2  GeonameID6=2</pre>
<pre class="programlisting">db-ip.com(MMDB): detected best databases COMM   : Country4=-  Country6=-  City4=-  City6=-  ASN4=-  ASN6=-  GeonameID4=-  GeonameID6=-</pre>
<pre class="programlisting">db-ip.com(MMDB): selected best databases normal : Country4=2  Country6=2  City4=2  City6=2  ASN4=3  ASN6=3  GeonameID4=2  GeonameID6=2</pre>
<pre class="programlisting">db-ip.com(MMDB): selected best databases method: COMM older than 12 months are deselected in case of LITE is available</pre>
<pre class="programlisting">db-ip.com(MMDB): selected best databases method: COMM/LITE with more features are only selected in case not older than 1 months of already found COMM/LITE</pre>
<pre class="programlisting">IP2Location(MMDB): features available/implemented: 0x00c603c0/0x00c63ff0 (57%)</pre>
<pre class="programlisting">IP2Location(MMDB): info of available databases in directory: /var/local/share/IP2Location</pre>
<pre class="programlisting">IP2Location(MMDB): Copyright (c) IP2Location All Rights Reserved</pre>
<pre class="programlisting">IP2Location(MMDB): IPvx Country                                    :[401] IP2LOCATION-LITE-DB1.MMDB           (GeoLite2Country database, created: 20241228-235320 UTC)</pre>
<pre class="programlisting">IP2Location(MMDB): detected best databases SAMPLE : Country4=-    Country6=-    City4=-    City6=-    ASN4=-    ASN6=-    GeonameID4=-    GeonameID6=-  </pre>
<pre class="programlisting">IP2Location(MMDB): detected best databases LITE   : Country4=401  Country6=401  City4=-    City6=-    ASN4=-    ASN6=-    GeonameID4=401  GeonameID6=401</pre>
<pre class="programlisting">IP2Location(MMDB): detected best databases COMM   : Country4=-    Country6=-    City4=-    City6=-    ASN4=-    ASN6=-    GeonameID4=-    GeonameID6=-  </pre>
<pre class="programlisting">IP2Location(MMDB): selected best databases LI-&gt;SA*: Country4=-    Country6=-    City4=-    City6=-    ASN4=-    ASN6=-    GeonameID4=-    GeonameID6=-  </pre>
<pre class="programlisting">IP2Location(MMDB): selected best databases normal : Country4=401  Country6=401  City4=-    City6=-    ASN4=-    ASN6=-    GeonameID4=401  GeonameID6=401</pre>
<pre class="programlisting">IP2Location(MMDB): selected best databases method : * = autoswitch from LITE to SAMPLE enabled in case not older than 12 months and having more features</pre>
<pre class="programlisting">IP2Location(MMDB): selected best databases method : COMM older than 12 months are deselected in case of LITE is available</pre>
<pre class="programlisting">IP2Location(MMDB): selected best databases method : COMM/LITE/SAMPLE with more features are only selected in case not older than 1 months of already found COMM/LITE/SAMPLE</pre>
<pre class="programlisting">IP2Location(MMDB): selected best databases method : softlinks skipped-by-default</pre>
<pre class="programlisting">External(BDB): features available/implemented: 0xc01980cc/0xc01980cc (100%)</pre>
<pre class="programlisting">External(BDB): info of available databases in directory: /var/local/share/ipv6calc</pre>
<pre class="programlisting">External(BDB): IPv4 Registry       : ipv6calc-external-ipv4-registry.db       (EXTDB-1/AFRINIC/20250128 APNIC/20250127 ARIN/20250127 IANA/20231218 LACNIC/20250127 LISP/20200318 RIPENCC/20250127, created: 20250128-070630 UTC)</pre>
<pre class="programlisting">External(BDB): IPv6 Registry       : ipv6calc-external-ipv6-registry.db       (EXTDB-2/AFRINIC/20250128 APNIC/20250127 ARIN/20250127 IANA/20241104 LACNIC/20250127 LISP/20200318 RIPENCC/20250127, created: 20250128-071031 UTC)</pre>
<pre class="programlisting">External(BDB): IPv4 CountryCode    : ipv6calc-external-ipv4-countrycode.db    (EXTDB-3/AFRINIC/20250128 APNIC/20250127 ARIN/20250127 IANA/20231218 LACNIC/20250127 LISP/20200318 RIPENCC/20250127, created: 20250128-070630 UTC)</pre>
<pre class="programlisting">External(BDB): IPv6 CountryCode    : ipv6calc-external-ipv6-countrycode.db    (EXTDB-4/AFRINIC/20250128 APNIC/20250127 ARIN/20250127 IANA/20241104 LACNIC/20250127 LISP/20200318 RIPENCC/20250127, created: 20250128-071031 UTC)</pre>
<pre class="programlisting">BuiltIn: features available/implemented: 0x0001c00f/0x0001c00f (100%)</pre>
<pre class="programlisting">BuiltIn: info of available databases</pre>
<pre class="programlisting">BuiltIn: ASN  : IANA/20250117</pre>
<pre class="programlisting">BuiltIn: CC   : AFRINIC/20250510 APNIC/20250509 ARIN/20250510 LACNIC/20250509 RIPENCC/20250509</pre>
<pre class="programlisting">BuiltIn: IPv4 : AFRINIC/20250510 APNIC/20250509 ARIN/20250510 IANA/20231218 LACNIC/20250509 LISP/20200318 RIPENCC/20250509 (created: 20250510-135700 UTC)</pre>
<pre class="programlisting">BuiltIn: IPv6 : AFRINIC/20250510 APNIC/20250509 ARIN/20250510 IANA/20241104 LACNIC/20250509 LISP/20200318 RIPENCC/20250509 (created: 20250510-140120 UTC)</pre>
<pre class="programlisting">BuiltIn: IEEE : IAB/20250510 OUI/20250510 OUI28/20250510 OUI36/20250510</pre>
<pre class="programlisting">Database selection or priorization ('-&gt;': subsequential calls)</pre>
<pre class="programlisting">Database priorization default: GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;IP2Location(MMDB)-&gt;db-ip.com(MMDB)-&gt;External(BDB)-&gt;BuiltIn</pre>
<pre class="programlisting">DB_AS_REG (AS-Number to Registry database): BuiltIn</pre>
<pre class="programlisting">DB_CC_REG (CountryCode to Registry database): BuiltIn</pre>
<pre class="programlisting">DB_IPV4_REG (IPv4 to Registry database): BuiltIn</pre>
<pre class="programlisting">DB_IPV6_REG (IPv6 to Registry database): BuiltIn</pre>
<pre class="programlisting">DB_IPV4_AS (IPv4 to AS database): GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;db-ip.com(MMDB)</pre>
<pre class="programlisting">DB_IPV6_AS (IPv6 to AS database): GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;db-ip.com(MMDB)</pre>
<pre class="programlisting">DB_IPV4_CC (IPv4 to CountryCode database): GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;IP2Location(MMDB)-&gt;db-ip.com(MMDB)-&gt;External(BDB)</pre>
<pre class="programlisting">DB_IPV6_CC (IPv6 to CountryCode database): GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;IP2Location(MMDB)-&gt;db-ip.com(MMDB)-&gt;External(BDB)</pre>
<pre class="programlisting">DB_IPV4_COUNTRY (IPv4 to Country database): GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;IP2Location(MMDB)-&gt;db-ip.com(MMDB)</pre>
<pre class="programlisting">DB_IPV6_COUNTRY (IPv6 to Country database): GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;IP2Location(MMDB)-&gt;db-ip.com(MMDB)</pre>
<pre class="programlisting">DB_IPV4_CITY (IPv4 to City database): GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;db-ip.com(MMDB)</pre>
<pre class="programlisting">DB_IPV6_CITY (IPv6 to City database): GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;db-ip.com(MMDB)</pre>
<pre class="programlisting">DB_IPV4_REGION (IPv4 to Region database): GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;db-ip.com(MMDB)</pre>
<pre class="programlisting">DB_IPV6_REGION (IPv6 to Region database): GeoIP(MMDB)-&gt;IP2Location(BIN)-&gt;db-ip.com(MMDB)</pre>
<pre class="programlisting">DB_IEEE (IEEE/OUI/OUI28/OUI36 Vendor database): BuiltIn</pre>
<pre class="programlisting">DB_IPV4_INFO (IPv4 additional information): External(BDB)-&gt;BuiltIn</pre>
<pre class="programlisting">DB_IPV6_INFO (IPv6 additional information): External(BDB)-&gt;BuiltIn</pre>
<pre class="programlisting">DB_IPV4_GEONAMEID (IPv4 GeonameID): GeoIP(MMDB)-&gt;IP2Location(MMDB)-&gt;db-ip.com(MMDB)</pre>
<pre class="programlisting">DB_IPV6_GEONAMEID (IPv6 GeonameID): GeoIP(MMDB)-&gt;IP2Location(MMDB)-&gt;db-ip.com(MMDB)</pre>
<pre class="programlisting">DB_IPV4_DUMP_CC (IPv4 Database Dump by CountryCode): External(BDB)</pre>
<pre class="programlisting">DB_IPV6_DUMP_CC (IPv6 Database Dump by CountryCode): External(BDB)</pre>
<p>Option &#8220;-v -h&#8221; (since 0.97.4) shows explanation of feature tokens</p>
<pre class="programlisting">$ ipv6calc -v -h</pre>
<pre class="programlisting">ipv6calc: version 4.3.1 GeoIP GeoIPv6 IP2Location IP2Location6 IP2Location2 IP2Location2v6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID DB_IPV4_DUMP_CC DB_IPV6_DUMP_CC ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID</pre>
<pre class="programlisting">Explanation of available(x)/possible(o) feature tokens</pre>
<pre class="programlisting">GeoIP                    x GeoIP(MMDB) IPv4 database (provided by GeoIP(MMDB))</pre>
<pre class="programlisting">GeoIPv6                  x GeoIP(MMDB) IPv6 database (provided by GeoIP(MMDB))</pre>
<pre class="programlisting">IP2Location              x IP2Location(BIN) IPv4 database (provided by IP2Location(BIN))</pre>
<pre class="programlisting">IP2Location6             x IP2Location(BIN) IPv6 database (provided by IP2Location(BIN))</pre>
<pre class="programlisting">IP2Location2             x IP2Location(MMDB) IPv4 database (provided by IP2Location(MMDB))</pre>
<pre class="programlisting">IP2Location2v6           x IP2Location(MMDB) IPv6 database (provided by IP2Location(MMDB))</pre>
<pre class="programlisting">DBIPv4                   x db-ip.com(MMDB) IPv4 database (provided by db-ip.com(MMDB))</pre>
<pre class="programlisting">DBIPv6                   x db-ip.com(MMDB) IPv6 database (provided by db-ip.com(MMDB))</pre>
<pre class="programlisting">DB_AS_REG                x AS-Number to Registry database (provided by BuiltIn)</pre>
<pre class="programlisting">DB_IPV4_REG              x IPv4 to Registry database (provided by External(BDB),BuiltIn)</pre>
<pre class="programlisting">DB_IPV6_REG              x IPv6 to Registry database (provided by External(BDB),BuiltIn)</pre>
<pre class="programlisting">DB_IPV4_AS               x IPv4 to AS database (provided by GeoIP(MMDB),IP2Location(BIN),IP2Location(MMDB),db-ip.com(MMDB))</pre>
<pre class="programlisting">DB_IPV6_AS               x IPv6 to AS database (provided by GeoIP(MMDB),IP2Location(BIN),IP2Location(MMDB),db-ip.com(MMDB))</pre>
<pre class="programlisting">DB_IPV4_CC               x IPv4 to CountryCode database (provided by GeoIP(MMDB),IP2Location(BIN),IP2Location(MMDB),db-ip.com(MMDB),External(BDB))</pre>
<pre class="programlisting">DB_IPV6_CC               x IPv6 to CountryCode database (provided by GeoIP(MMDB),IP2Location(BIN),IP2Location(MMDB),db-ip.com(MMDB),External(BDB))</pre>
<pre class="programlisting">DB_IPV4_COUNTRY          x IPv4 to Country database (provided by GeoIP(MMDB),IP2Location(BIN),IP2Location(MMDB),db-ip.com(MMDB))</pre>
<pre class="programlisting">DB_IPV6_COUNTRY          x IPv6 to Country database (provided by GeoIP(MMDB),IP2Location(BIN),IP2Location(MMDB),db-ip.com(MMDB))</pre>
<pre class="programlisting">DB_IPV4_CITY             x IPv4 to City database (provided by GeoIP(MMDB),IP2Location(BIN),IP2Location(MMDB),db-ip.com(MMDB))</pre>
<pre class="programlisting">DB_IPV6_CITY             x IPv6 to City database (provided by GeoIP(MMDB),IP2Location(BIN),IP2Location(MMDB),db-ip.com(MMDB))</pre>
<pre class="programlisting">DB_IPV4_REGION           x IPv4 to Region database (provided by GeoIP(MMDB),IP2Location(BIN),IP2Location(MMDB),db-ip.com(MMDB))</pre>
<pre class="programlisting">DB_IPV6_REGION           x IPv6 to Region database (provided by GeoIP(MMDB),IP2Location(BIN),IP2Location(MMDB),db-ip.com(MMDB))</pre>
<pre class="programlisting">DB_CC_REG                x CountryCode to Registry database (provided by BuiltIn)</pre>
<pre class="programlisting">DB_IEEE                  x IEEE/OUI/OUI28/OUI36 Vendor database (provided by BuiltIn)</pre>
<pre class="programlisting">DB_IPV4_INFO             x IPv4 additional information (provided by External(BDB),BuiltIn)</pre>
<pre class="programlisting">DB_IPV6_INFO             x IPv6 additional information (provided by External(BDB),BuiltIn)</pre>
<pre class="programlisting">DB_IPV4_GEONAMEID        x IPv4 GeonameID (provided by GeoIP(MMDB),IP2Location(MMDB),db-ip.com(MMDB))</pre>
<pre class="programlisting">DB_IPV6_GEONAMEID        x IPv6 GeonameID (provided by GeoIP(MMDB),IP2Location(MMDB),db-ip.com(MMDB))</pre>
<pre class="programlisting">DB_IPV4_DUMP_CC          x IPv4 Database Dump by CountryCode (provided by External(BDB))</pre>
<pre class="programlisting">DB_IPV6_DUMP_CC          x IPv6 Database Dump by CountryCode (provided by External(BDB))</pre>
<pre class="programlisting">ANON_ZEROISE             x Anonymization method 'zeroize'</pre>
<pre class="programlisting">ANON_ANONYMIZE           x Anonymization method 'anonymize'</pre>
<pre class="programlisting">ANON_KEEP-TYPE-ASN-CC    x Anonymization method 'keep-type-asn-cc'</pre>
<pre class="programlisting">ANON_KEEP-TYPE-GEONAMEID x Anonymization method 'keep-type-geonameid'</pre>
<p>Note: since version 0.95.0 the internal layer for database usage was abstracted and each database &#8220;plugin&#8221; is initialized reporting then its supporting features in binary representation. This makes implementation of other external databases easier in the future. Partially internal (built-in) databases can be overlayed by generated external databases replacing the need of recompilation for updated built-in databases.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1387"></a>Examples</h3></div></div></div>

<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1373"></a>Conversion</h4></div></div></div>

<p>A simple example is the conversion of an IPv6 address to a DNS PTR query string:</p>
<pre class="programlisting">$ ipv6calc --out revnibbles.arpa 2001:db8::1</pre>
<pre class="programlisting">No input type specified, try autodetection...found type: ipv6addr</pre>
<pre class="programlisting">1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.8.b.d.0.1.0.0.2.ip6.arpa.</pre>
<p>Like you see, input format was autodetected. And the given example can be extended because ipv6calc also understands netmask / prefix length values:</p>
<pre class="programlisting">$ ipv6calc -q --out revnibbles.arpa 2001:db8::1/64</pre>
<pre class="programlisting">0.0.0.0.0.0.0.0.8.b.d.0.1.0.0.2.ip6.arpa.</pre>
<p>Also you&#8217;ve also learnt now that switch &#8217;-q&#8217; (quiet) suppresses informational messages. You can use this now to start a DNS PTR query using:</p>
<pre class="programlisting">$ dig PTR `./ipv6calc -q --out revnibbles.arpa 2001:db8::1/64`</pre>
<p>But ipv6calc can do many more for you! Next example shows you the extraction of the IPv4 address contained in a 6to4 IPv6 address:</p>
<pre class="programlisting">$ ipv6calc -q --action conv6to4 --in ipv6 2002:c0a8:fb61::1 --out ipv4</pre>
<pre class="programlisting">192.168.251.97</pre>
<p>This also works vice-versa:</p>
<pre class="programlisting">$ ipv6calc -q --action conv6to4 --in ipv4 192.168.251.97 --out ipv6</pre>
<pre class="programlisting">2002:c0a8:fb61::</pre>
<p>There are many more features already implemented, if you miss one, send a note.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1384"></a>Information</h4></div></div></div>

<p>Depending on available databases output can vary.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="id1374"></a>Information about a simple IPv6 address:</h5></div></div></div>

<pre class="programlisting">$ ipv6calc -q -i 3ffe:ffff::210:a4ff:fe01:2345</pre>
<pre class="programlisting">Address type: unicast, 6bone, global-unicast, productive</pre>
<pre class="programlisting">Address type has SLA: 0000</pre>
<pre class="programlisting">Registry for address: reserved</pre>
<pre class="programlisting">Interface identifier: 0210:a4ff:fe01:2345</pre>
<pre class="programlisting">EUI-48/MAC address: 00:10:a4:01:23:45</pre>
<pre class="programlisting">MAC is a global unique one</pre>
<pre class="programlisting">MAC is an unicast one</pre>
<pre class="programlisting">OUI is: XIRCOM</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="id1375"></a>Information about a Teredo IPv6 address:</h5></div></div></div>

<pre class="programlisting">$ ipv6calc -q -i 3ffe:831f:ce49:7601:8000:efff:af4a:86BF</pre>
<pre class="programlisting">Address type: unicast, 6bone, global-unicast, teredo</pre>
<pre class="programlisting">Country Code: IT</pre>
<pre class="programlisting">Registry for address: 6BONE</pre>
<pre class="programlisting">IPv4 address: 80.181.121.64 (TEREDO-CLIENT)</pre>
<pre class="programlisting">IPv4 address type: unicast, global</pre>
<pre class="programlisting">Autonomous System Information for [80.181.121.64]: AS3269 ASN-IBSNAZ</pre>
<pre class="programlisting">Country Code for [80.181.121.64]: IT </pre>
<pre class="programlisting">...</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="id1376"></a>Information about a LISP address</h5></div></div></div>

<pre class="programlisting">$ ipv6calc -q -i 153.16.26.80</pre>
<pre class="programlisting">IPv4 address: 153.16.26.80</pre>
<pre class="programlisting">IPv4 address type: unicast, global, lisp</pre>
<pre class="programlisting">...</pre>
<pre class="programlisting">IPv4 registry: ARIN(LISP#cbc-xtr) </pre>
<pre class="programlisting">...</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="id1383"></a>Machine readable output</h5></div></div></div>

<p>There exists also a machine readable output (e.g. used by &#8217;ipv6calcweb.cgi&#8217;) - in addition, database related information can be displayed, if databases are located on the system and supported.</p>
<pre class="programlisting">$ ipv6calc -q -i -m 2a01:238:423d:8800:85b3:9e6b:3019:8909  </pre>
<pre class="programlisting">IPV6=2a01:0238:423d:8800:85b3:9e6b:3019:8909</pre>
<pre class="programlisting">IPV6_ANON=a909:16fa:9091:a448:a909:4941:0000:0007</pre>
<pre class="programlisting">IPV6_TYPE=ipv6,unicast,global-unicast,productive,iid-random,iid,iid-local</pre>
<pre class="programlisting">IPV6_COUNTRYCODE=DE</pre>
<pre class="programlisting">IPV6_COUNTRYCODE_SOURCE=GeoIP(MMDB)</pre>
<pre class="programlisting">IPV6_AS_NUM=6724</pre>
<pre class="programlisting">IPV6_AS_ORGNAME=Strato GmbH</pre>
<pre class="programlisting">IPV6_AS_SOURCE=GeoIP(MMDB)</pre>
<pre class="programlisting">IPV6_GEONAME_ID=2921044</pre>
<pre class="programlisting">IPV6_GEONAME_ID_SOURCE=GeoIP(MMDB)</pre>
<pre class="programlisting">IPV6_GEONAME_ID_TYPE=Country</pre>
<pre class="programlisting">IPV6_REGISTRY=RIPENCC</pre>
<pre class="programlisting">SLA=8800</pre>
<pre class="programlisting">IID=85b3:9e6b:3019:8909</pre>
<pre class="programlisting">EUI64_SCOPE=local-random</pre>
<pre class="programlisting">IP2LOCATION_COUNTRY_SHORT=DE</pre>
<pre class="programlisting">IP2LOCATION_COUNTRY_LONG=Germany</pre>
<pre class="programlisting">IP2LOCATION_REGION=Berlin</pre>
<pre class="programlisting">IP2LOCATION_CITY=Berlin</pre>
<pre class="programlisting">IP2LOCATION_ZIPCODE=10178</pre>
<pre class="programlisting">IP2LOCATION_LATITUDE=52.524525</pre>
<pre class="programlisting">IP2LOCATION_LONGITUDE=13.410037</pre>
<pre class="programlisting">IP2LOCATION_TIMEZONE=+01:00</pre>
<pre class="programlisting">IP2LOCATION2_CONTINENT_SHORT=EU</pre>
<pre class="programlisting">IP2LOCATION2_CONTINENT_LONG=Europe</pre>
<pre class="programlisting">IP2LOCATION2_COUNTRY_SHORT=DE</pre>
<pre class="programlisting">IP2LOCATION2_COUNTRY_LONG=Germany</pre>
<pre class="programlisting">IP2LOCATION2_GEONAME_ID_COUNTRY=2921044</pre>
<pre class="programlisting">IP2LOCATION2_GEONAME_ID_CONTINENT=6255148</pre>
<pre class="programlisting">GEOIP2_CONTINENT_SHORT=EU</pre>
<pre class="programlisting">GEOIP2_CONTINENT_LONG=Europe</pre>
<pre class="programlisting">GEOIP2_COUNTRY_SHORT=DE</pre>
<pre class="programlisting">GEOIP2_COUNTRY_LONG=Germany</pre>
<pre class="programlisting">GEOIP2_LATITUDE=51.299300</pre>
<pre class="programlisting">GEOIP2_LONGITUDE=9.491000</pre>
<pre class="programlisting">GEOIP2_RADIUS=200</pre>
<pre class="programlisting">GEOIP2_TIMEZONE_NAME=Europe/Berlin</pre>
<pre class="programlisting">GEOIP2_AS_NUM=6724</pre>
<pre class="programlisting">GEOIP2_AS_ORGNAME=Strato GmbH</pre>
<pre class="programlisting">GEOIP2_GEONAME_ID_COUNTRY=2921044</pre>
<pre class="programlisting">GEOIP2_GEONAME_ID_CONTINENT=6255148</pre>
<pre class="programlisting">DBIP2_CONTINENT_SHORT=EU</pre>
<pre class="programlisting">DBIP2_CONTINENT_LONG=Europe</pre>
<pre class="programlisting">DBIP2_COUNTRY_SHORT=DE</pre>
<pre class="programlisting">DBIP2_COUNTRY_LONG=Germany</pre>
<pre class="programlisting">DBIP2_REGION=Berlin</pre>
<pre class="programlisting">DBIP2_CITY=Berlin (Charlottenburg-Wilmersdorf)</pre>
<pre class="programlisting">DBIP2_LATITUDE=52.523400</pre>
<pre class="programlisting">DBIP2_LONGITUDE=13.322400</pre>
<pre class="programlisting">DBIP2_AS_NUM=6724</pre>
<pre class="programlisting">DBIP2_AS_ORGNAME=Strato AG</pre>
<pre class="programlisting">DBIP2_GEONAME_ID_COUNTRY=2921044</pre>
<pre class="programlisting">DBIP2_GEONAME_ID_CONTINENT=6255148</pre>
<pre class="programlisting">EXTERNAL_COUNTRY_SHORT=DE</pre>
<pre class="programlisting">IP2LOCATION_DATABASE_INFO=IP2L-DB11 IPv4 IPv6 20250115 Copyright (c) 2025 IP2Location All Rights Reserved</pre>
<pre class="programlisting">IP2LOCATION2_DATABASE_INFO=GeoLite2Country database Copyright (c) 2024 IP2Location All Rights Reserved, created: 20241228-235320 UTC / This site or product includes IP2Location LITE data available from https://lite.ip2location.com</pre>
<pre class="programlisting">GEOIP2_DATABASE_INFO=GeoLite2-City Copyright (c) 2025 MaxMind All Rights Reserved, created: 20250121-102358 UTC / GeoLite2-ASN Copyright (c) 2025 MaxMind All Rights Reserved, created: 20250121-081512 UTC</pre>
<pre class="programlisting">DBIP2_DATABASE_INFO=DBIP-City-Lite Copyright (c) 2025 db-ip.com All Rights Reserved, created: 20250201-022127 UTC / DBIP-ASN-Lite (compat=GeoLite2-ASN) Copyright (c) 2025 db-ip.com All Rights Reserved, created: 20250201-022141 UTC</pre>
<pre class="programlisting">EXTERNAL_DATABASE_INFO=EXTDB-4/AFRINIC/20250128 APNIC/20250127 ARIN/20250127 IANA/20241104 LACNIC/20250127 LISP/20200318 RIPENCC/20250127, created: 20250128-071031 UTC</pre>
<pre class="programlisting">BUILTIN_DATABASE_INFO=IPv6-REG:AFRINIC/20250510 APNIC/20250509 ARIN/20250510 IANA/20241104 LACNIC/20250509 LISP/20200318 RIPENCC/20250509</pre>
<pre class="programlisting">IPV6CALC_NAME=ipv6calc</pre>
<pre class="programlisting">IPV6CALC_VERSION=4.3.1</pre>
<pre class="programlisting">IPV6CALC_COPYRIGHT="(P) &amp; (C) 2001-2025 by Peter Bieringer &lt;pb (at) bieringer.de&gt;"</pre>
<pre class="programlisting">IPV6CALC_OUTPUT_VERSION=23</pre>
<pre class="programlisting">IPV6CALC_SETTINGS_ANON="set=keep-type-asn-cc,mask-ipv6=56,mask-ipv4=24,mask-eui64=40,mask-mac=24,method=keep-type-asn-cc"</pre>
<pre class="programlisting">IPV6CALC_FEATURES="GeoIP GeoIPv6 IP2Location IP2Location6 IP2Location2 IP2Location2v6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID DB_IPV4_DUMP_CC DB_IPV6_DUMP_CC ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID"</pre>
<pre class="programlisting">IPV6CALC_CAPABILITIES="GeoIP2(linked/MMDB) IP2Location(linked/BIN) DBIP2(linked/MMDB) IP2Location2(linked/MMDB) ExternalDatabase DB_AS_REG(BuiltIn) DB_CC_REG(BuiltIn) DB_IPV4_REG(BuiltIn) DB_IPV6_REG(BuiltIn) DB_IEEE(BuiltIn)"</pre>
<h5><a id="id1448"></a>Special machine readable output options (&gt;= 0.99.0)</h5>
<div class="section"><div class="titlepage"><div><div><h6 class="title"><a id="id1377"></a>Output filter by selecting a token (&gt;= 0.99.0)</h6></div></div></div>

<p>Using option --mrst &lt;TOKEN&gt; (Machine Readable Select Token) can be used to display only a selected token</p>
<pre class="programlisting">$ ipv6calc -q -i --mrst IPV6_TYPE 2a01:238:423d:8800:85b3:9e6b:3019:8909 </pre>
<pre class="programlisting">IPV6_TYPE=unicast,global-unicast,productive,iid-random,iid,iid-local</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h6 class="title"><a id="id1378"></a>Output filter by matching token (&gt;= 0.99.0)</h6></div></div></div>

<p>Using option --mrmt &lt;TOKEN&gt; (Machine Readable Match Token) can be used to display only matching tokens</p>
<pre class="programlisting">$ ipv6calc -q -i --mrmt IP2LOCATION 2a01:238:423d:8800:85b3:9e6b:3019:8909 </pre>
<pre class="programlisting">IP2LOCATION_COUNTRY_SHORT=DE</pre>
<pre class="programlisting">IP2LOCATION_COUNTRY_LONG=Germany</pre>
<pre class="programlisting">IP2LOCATION_REGION=Berlin</pre>
<pre class="programlisting">IP2LOCATION_CITY=Berlin</pre>
<pre class="programlisting">IP2LOCATION_ZIPCODE=10178</pre>
<pre class="programlisting">IP2LOCATION_LATITUDE=52.524368</pre>
<pre class="programlisting">IP2LOCATION_LONGITUDE=13.410530</pre>
<pre class="programlisting">IP2LOCATION_TIMEZONE_NAME=+01:00</pre>
<pre class="programlisting">IP2LOCATION_DATABASE_INFO=IP2L-DB11 IPv6 20181226 Copyright (c) 2018 IP2Location All Rights Reserved</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h6 class="title"><a id="id1379"></a>Output filter by selecting a value of a token token (&gt;= 0.99.0)</h6></div></div></div>

<p>Using option --mrtvo &lt;TOKEN&gt; (Machine Readable Token Value Only) can be used to display only thevalue of a selected token</p>
<pre class="programlisting">$ ipv6calc -q -i --mrtvo IPV6_TYPE 2a01:238:423d:8800:85b3:9e6b:3019:8909 </pre>
<pre class="programlisting">unicast,global-unicast,productive,iid-random,iid,iid-local</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h6 class="title"><a id="id1380"></a>Output adjustment by unconditional quoting of values (&gt;= 0.99.0)</h6></div></div></div>

<p>Using option --mrqva (Machine Readable Quote Values Always) can be used to quote values always of a selected token</p>
<pre class="programlisting">$ ipv6calc -q -i --mrqva --mrtvo IPV6_TYPE 2a01:238:423d:8800:85b3:9e6b:3019:8909 </pre>
<pre class="programlisting">"unicast,global-unicast,productive,iid-random,iid,iid-local"</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h6 class="title"><a id="id1381"></a>Output adjustment by unconditional disabling quoted values (&gt;= 0.99.0)</h6></div></div></div>

<p>Using option --mrqvn (Machine Readable Quote Values Never) can be used to never quote values of a selected token</p>
<pre class="programlisting">$ ipv6calc -q -i --mrqvn --mrst IPV6_AS_TEXT 2a01:238:423d:8800:85b3:9e6b:3019:8909 </pre>
<pre class="programlisting">IPV6_AS_TEXT=AS6724 STRATO AG</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h6 class="title"><a id="id1382"></a>Output adjustment by unconditional print token in case of empty value (&gt;= 0.99.0)</h6></div></div></div>

<p>Using option --mrstpq (Machine Readable Select Token Print Always) can be used to print always token/value regardless it&#8217;s contained</p>
<pre class="programlisting">$ ipv6calc -q -i --mrqva --mrstpa IPV4 2a01:238:423d:8800:85b3:9e6b:3019:8909 </pre>
<pre class="programlisting">IPV4=""</pre>
<pre class="programlisting">$ ipv6calc -q -i --mrqva --mrst IPV4 2a01:238:423d:8800:85b3:9e6b:3019:8909 </pre>
<pre class="programlisting">(no output)</pre>
</div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1385"></a>Filter mode</h4></div></div></div>

<p>&#8220;ipv6calc&#8221; can run in filter mode to be able to extract from a huge list of IPv4/IPv6 addresses ones which are interesting or ones which are not interesting (see printout of online help below).</p>
<p>Filter tokens are the ones which are listed on &#8220;TYPE&#8221; lines shown in &#8220;-m -i&#8221; information mode.</p>
<p>Example for searching for Teredo addresses:</p>
<pre class="programlisting">$ cat ip.bieringer.de-log.201310 | awk '{ print $1 }' | sort | uniq | ipv6calc -A filter -E teredo</pre>
<pre class="programlisting">2001:0:9d38:90d7:34f7:1a26:8599:e079</pre>
<p>For more information see below</p>
<p>Note: since version 0.95.0 &#8217;-A filter&#8217; is optional if option &#8217;-E &lt;filter expression&gt;&#8217; is given (autoselected action).</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1386"></a>Test mode</h4></div></div></div>

<p>Since 0.99.2 a test mode (&#8217;-A test&#8217;, autoselected in case &#8217;test_*&#8217; options are given) is implemented for address prefix or range</p>
<p>For more information see below</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1388"></a>Option style</h3></div></div></div>

<p>Since version 0.40 new-style option handling was introduced, using</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>--in &lt;inputtype&gt;</p>
</li><li class="listitem">
<p>--out &lt;outputtype&gt;</p>
</li><li class="listitem">
<p>--action &lt;actiontype&gt;</p>
</li></ul></div>
<p>and many more conversions were added. A built-in check matrix should prevent misconversions.</p>
<p>Up to version 0.39, only old-style options (aka &#8220;shortcut&#8221; options). They are one-in-all options, specifying input/action/output in one token. Internally this options will be converted into new-style options.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1399"></a>Online help</h3></div></div></div>

<p>Online help always shows the currently implemented features.</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1389"></a>Main online help:</h4></div></div></div>

<p>External database options only appear if compiled with related support.</p>
<pre class="programlisting">$ ipv6calc -h</pre>
<pre class="programlisting">ipv6calc: version 4.3.0 GeoIP GeoIPv6 IP2Location IP2Location6 IP2Location2 IP2Location2v6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID DB_IPV4_DUMP_CC DB_IPV6_DUMP_CC ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID</pre>
<pre class="programlisting">(P) &amp; (C) 2001-2025 by Peter Bieringer &lt;pb (at) bieringer.de&gt;</pre>
<pre class="programlisting">This program formats and calculates IPv6/IPv4/MAC addresses and can do many more tricky things</pre>
<pre class="programlisting">  [-d|--debug &lt;debug value&gt;] : debug value (bitwise like)</pre>
<pre class="programlisting">                                can also be set by IPV6CALC_DEBUG environment value</pre>
<pre class="programlisting">  [-v|--version [-v [-v]]]   : version information (2 optional detail levels)</pre>
<pre class="programlisting">  [-v|--version -h]          : explanation of feature tokens</pre>
<pre class="programlisting">  [-V|--verbose]             : be more verbose</pre>
<pre class="programlisting">  [-h|--help|-?]             : this online help</pre>
<pre class="programlisting">  [--disable-ip2location           ] : IP2Location(BIN) support disabled</pre>
<pre class="programlisting">  [--db-ip2location-disable        ] : IP2Location(BIN) support disabled</pre>
<pre class="programlisting">  [--db-ip2location-dir &lt;directory&gt;] : IP2Location(BIN) database directory (default: /var/local/share/IP2Location)</pre>
<pre class="programlisting">  [--db-ip2location-only-type &lt;TYPE&gt;]: IP2Location(BIN) database only selected type (1-666)</pre>
<pre class="programlisting">  [--db-ip2location-allow-softlinks] : IP2Location(BIN) database softlinks allowed</pre>
<pre class="programlisting">     by default they are ignored because it is hard to autodetect COMM/LITE/SAMPLE</pre>
<pre class="programlisting">  [--db-ip2location-lite-to-sample-autoswitch-max-delta-months &lt;MONTHS&gt;]:</pre>
<pre class="programlisting">     autoswitch from LITE to SAMPLE databases if possible and delta is not more than 12 months (0=disabled)</pre>
<pre class="programlisting">  [--db-ip2location-comm-to-lite-switch-min-delta-months &lt;MONTHS&gt;]:</pre>
<pre class="programlisting">     switch from COMM to LITE databases if possible and delta more than 12 months (0=disabled)</pre>
<pre class="programlisting">  [--disable-ip2location2           ] : IP2Location(MMDB) support disabled</pre>
<pre class="programlisting">  [--db-ip2location2-disable        ] : IP2Location(MMDB) support disabled</pre>
<pre class="programlisting">  [--db-ip2location2-dir &lt;directory&gt;] : IP2Location(MMDB) database directory (default: /var/local/share/IP2Location)</pre>
<pre class="programlisting">  [--db-ip2location2-only-type &lt;TYPE&gt;]: IP2Location(MMDB) database only selected type (1-666)</pre>
<pre class="programlisting">  [--db-ip2location2-allow-softlinks] : IP2Location(MMDB) database softlinks allowed</pre>
<pre class="programlisting">     by default they are ignored because it is hard to autodetect COMM/LITE/SAMPLE</pre>
<pre class="programlisting">  [--db-ip2location2-lite-to-sample-autoswitch-max-delta-months &lt;MONTHS&gt;]:</pre>
<pre class="programlisting">     autoswitch from LITE to SAMPLE databases if possible and delta is not more than 12 months (0=disabled)</pre>
<pre class="programlisting">  [--db-ip2location-comm-to-lite-switch-min-delta-months &lt;MONTHS&gt;]:</pre>
<pre class="programlisting">     switch from COMM to LITE databases if possible and delta more than 12 months (0=disabled)</pre>
<pre class="programlisting">  [--disable-geoip2                ] : GeoIP(MaxMindDB) support disabled</pre>
<pre class="programlisting">  [--db-geoip2-disable             ] : GeoIP(MaxMindDB) support disabled</pre>
<pre class="programlisting">  [--db-geoip2-dir      &lt;directory&gt;] : GeoIP(MaxMindDB) database directory (default: /var/local/share/GeoIP)</pre>
<pre class="programlisting">  [--disable-dbip2                 ] : db-ip.com(MaxMindDB) support disabled</pre>
<pre class="programlisting">  [--db-dbip2-disable              ] : db-ip.com(MaxMindDB) support disabled</pre>
<pre class="programlisting">  [--db-dbip2-dir       &lt;directory&gt;] : db-ip.com(MaxMindDB) database directory (default: /var/local/share/DBIP)</pre>
<pre class="programlisting">  [--db-dbip2-only-type &lt;TYPE&gt;]      : db-ip.com(MaxMindDB) database only selected type (1-6)</pre>
<pre class="programlisting">  [--db-dbip2-comm-to-free-switch-min-delta-months &lt;MONTHS&gt;]:</pre>
<pre class="programlisting">     switch from COMM to FREE databases if possible and delta more than 12 months (0=disabled)</pre>
<pre class="programlisting">  [--disable-external              ] : External support disabled</pre>
<pre class="programlisting">  [--db-external-disable           ] : External support disabled</pre>
<pre class="programlisting">  [--db-external-dir    &lt;directory&gt;] : External database directory (default: /var/local/share/ipv6calc)</pre>
<pre class="programlisting">  [--disable-builtin               ] : BuiltIn support disabled</pre>
<pre class="programlisting">  [--db-builtin-disable            ] : BuiltIn support disabled</pre>
<pre class="programlisting">  [--db-priorization &lt;entry1&gt;[:...]] : Database priorization order list (overwrites default)</pre>
<pre class="programlisting">                                         colon separated: GeoIP2 IP2Location DBIP2 External BuiltIn IP2Location2</pre>
<pre class="programlisting"> Hint: all long options can be predefined from environment by using</pre>
<pre class="programlisting">  prefix: IPV6CALC_ and  conversion: '-' -&gt; '_' and lowercase -&gt; uppercase</pre>
<pre class="programlisting">  example for options with values   : --db-dbip2-dir=&lt;DIR&gt;  -&gt;  environment: IPV6CALC_DB_DBIP2_DIR=&lt;DIR&gt;</pre>
<pre class="programlisting">  example for options without values: --db-dbip2-disable    -&gt;  environment: IPV6CALC_DB_DBIP2_DISABLE=1</pre>
<pre class="programlisting">                                                                              on|off|0|1 is supported</pre>
<pre class="programlisting">  [-q|--quiet]               : be more quiet (auto-enabled in pipe mode)</pre>
<pre class="programlisting">  [-f|--flush]               : flush each line in pipe mode</pre>
<pre class="programlisting"> Usage with new style options:</pre>
<pre class="programlisting">  [--in|-I &lt;input type&gt;]   : specify input  type</pre>
<pre class="programlisting">                             (default: autodetect)</pre>
<pre class="programlisting">  [--out|-O &lt;output type&gt;] : specify output type</pre>
<pre class="programlisting">                             (sometimes: autodetect)</pre>
<pre class="programlisting">  [--action|-A &lt;action&gt;]   : specify action</pre>
<pre class="programlisting">                             (default: format conversion, sometimes: autodetect)</pre>
<pre class="programlisting">  [&lt;format option&gt; ...] : specify format options</pre>
<pre class="programlisting">  &lt;input data&gt; [...]    : input data</pre>
<pre class="programlisting">  Available input  types:  [-m] -I|--in     -?|-h|--help</pre>
<pre class="programlisting">  Available output types:  [-m] -O|--out    -?|-h|--help</pre>
<pre class="programlisting">  Available action types:  [-m] -A|--action -?|-h|--help</pre>
<pre class="programlisting">  Special filter action :  -E -?|-h|--help</pre>
<pre class="programlisting"> Other usage:</pre>
<pre class="programlisting">  --showinfo|-i [--machine_readable|-m] : show information about input data</pre>
<pre class="programlisting">  --showinfo|-i --mrqva                 : Machine Readable Quote Values Always</pre>
<pre class="programlisting">  --showinfo|-i --mrqvn                 : Machine Readable Quote Values Never</pre>
<pre class="programlisting">  --showinfo|-i --mrst &lt;TOKEN&gt;          : Machine Readable Select Token</pre>
<pre class="programlisting">  --showinfo|-i --mrstpa &lt;TOKEN&gt;        : Machine Readable Select Token Print Always</pre>
<pre class="programlisting">  --showinfo|-i --mrmt &lt;TOKENPREFIX&gt;    : Machine Readable Match Token Prefix</pre>
<pre class="programlisting">  --showinfo|-i --mrmts &lt;TOKENSUFFIX&gt;   : Machine Readable Match Token Suffix</pre>
<pre class="programlisting">  --showinfo|-i --mrtvo &lt;TOKEN&gt;         : Machine Readable Token Value Only</pre>
<pre class="programlisting">  --showinfo|-i --show-tokens           : show available tokens (aka types) on '-m'</pre>
<pre class="programlisting"> Usage with shortcut options: &lt;shortcut option&gt; [&lt;format option&gt; ...] &lt;input data&gt;</pre>
<pre class="programlisting">  for more information and available format options use: &lt;shortcut option&gt; -?|-h|--help</pre>
<pre class="programlisting">  -r|--addr2ip6_int (-O revnibbles.int)</pre>
<pre class="programlisting">  -r|--addr_to_ip6int (-O revnibbles.int)</pre>
<pre class="programlisting">  -a|--addr2ip6_arpa (-O revnibbles.arpa)</pre>
<pre class="programlisting">  -a|--addr_to_ip6arpa (-O revnibbles.arpa)</pre>
<pre class="programlisting">  -b|--addr_to_bitstring (-O bitstring)</pre>
<pre class="programlisting">     --addr2compaddr (--printcompressed)</pre>
<pre class="programlisting">     --addr_to_compressed (--printcompressed)</pre>
<pre class="programlisting">     --addr2uncompaddr (--printuncompressed)</pre>
<pre class="programlisting">     --addr_to_uncompressed (--printuncompressed)</pre>
<pre class="programlisting">     --addr_to_base85 (-I ipv6addr -O base85)</pre>
<pre class="programlisting">     --base85_to_addr (-I base85 -O ipv6addr)</pre>
<pre class="programlisting">     --mac_to_eui64 (-I mac -O eui64)</pre>
<pre class="programlisting">     --addr2fulluncompaddr (--printfulluncompressed)</pre>
<pre class="programlisting">     --addr_to_fulluncompressed (--printfulluncompressed)</pre>
<pre class="programlisting">     --addr2if_inet6 (-I ipv6addr -O ifinet6)</pre>
<pre class="programlisting">     --addr_to_ifinet6 (-I ipv6addr -O ifinet6)</pre>
<pre class="programlisting">     --if_inet62addr (-I ifinet6 -O ipv6addr --printcompressed)</pre>
<pre class="programlisting">     --ifinet6_to_compressed (-I ifinet6 -O ipv6addr --printcompressed)</pre>
<pre class="programlisting">     --eui64_to_privacy (-I iid_token -O iid_token -A genprivacyiid)</pre>
<pre class="programlisting">     --ipv4_to_6to4addr (-I ipv4 -O ipv6addr -A conv6to4)</pre>
<pre class="programlisting">     --addr2cc (-A addr2cc)</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1391"></a>Database options</h4></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>each internal/external database can be disabled by option</p>
</li><li class="listitem">
<p>directory of database files can be given via related option</p>
</li><li class="listitem">
<p>databases requiring external library the library file can be given in case of dynamic load and linking</p>
</li><li class="listitem">
<p>for geolocation databases specific file can be selected (see --db-&lt;PROVIDER&gt;-only-type &lt;TYPE&gt;)</p>
</li></ul></div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="id1390"></a>IP2Location(BIN)</h5></div></div></div>

<p>IP2location database directory can contain a bunch of files, the best ones are selected automatically (since 0.99.0). &#8220;Best&#8221; can be controlled via two options:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>--db-ip2location-lite-to-sample-autoswitch-max-delta-months &lt;MONTHS&gt;: switches from LITE to SAMPLE databases in case of</p>
</li><li class="listitem">
<p>--db-ip2location2-lite-to-sample-autoswitch-max-delta-months &lt;MONTHS&gt;: switches from LITE to SAMPLE databases in case of</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<p>existing SAMPLE database</p>
</li><li class="listitem">
<p>SAMPLE database not older than default/given MONTHS than the LITE database</p>
</li><li class="listitem">
<p>IP address is in range of SAMPLE database (IPv4: 0.0.0.0-99.255.255.255, IPv6: 2a04::/16)</p>
</li><li class="listitem">
<p>autoswitch can be disabled by using MONTHS=0</p>
</li><li class="listitem">
<p>reason for implementation: show maximum possible IP2Location features</p>
</li></ul></div>
</li><li class="listitem">
<p>--db-ip2location-comm-to-lite-switch-min-delta-months &lt;MONTHS&gt;: switches from COMMercial to LITE databases in case of</p>
</li><li class="listitem">
<p>--db-ip2location2-comm-to-lite-switch-min-delta-months &lt;MONTHS&gt;: switches from COMMercial to LITE databases in case of</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<p>existing LITE database</p>
</li><li class="listitem">
<p>COMMercial database is default/given MONTHS older than the LITE database</p>
</li><li class="listitem">
<p>switch can be disabled by using MONTHS=0</p>
</li><li class="listitem">
<p>reason for implementation: avoid using old COMMercial databases</p>
</li></ul></div>
</li><li class="listitem">
<p>--db-ip2location-only-type &lt;TYPE&gt;: only selects databases of given type</p>
</li><li class="listitem">
<p>--db-ip2location2-only-type &lt;TYPE&gt;: only selects databases of given type</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<p>reason for implementation: be able to select a specific database type</p>
</li></ul></div>
</li><li class="listitem">
<p>--db-ip2location-allow-softlinks: allow softlinked IP2Location database files</p>
</li><li class="listitem">
<p>--db-ip2location-allow-softlinks: allow softlinked IP2Location database files</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<p>by default, softlinked database files are skipped, because it&#8217;s hard to detect whether one is COMMercial, LITE or SAMPLE</p>
</li></ul></div>
</li></ul></div>
<p>use &#8220;ipv6calc -vv&#8221; or &#8220;ipv6calc -vvv&#8221; for verification, which databases are selected finally.</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1392"></a>Input-type options</h4></div></div></div>

<pre class="programlisting">$ ipv6calc --in -?</pre>
<pre class="programlisting">ipv6calc: version 4.2.0 GeoIP GeoIPv6 IP2Location IP2Location6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID DB_IPV4_DUMP_CC ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID</pre>
<pre class="programlisting">(P) &amp; (C) 2001-2023 by Peter Bieringer &lt;pb (at) bieringer.de&gt;</pre>
<pre class="programlisting"> Available input types:</pre>
<pre class="programlisting">  auto            : automatic detection</pre>
<pre class="programlisting">  revnibbles.int  : dot separated nibbles reverse, ending with ip6.int.</pre>
<pre class="programlisting">  revnibbles.arpa : dot separated nibbles reverse, ending with ip6.arpa.</pre>
<pre class="programlisting">  bitstring       : bitstring labes, ending with ip6.arpa.</pre>
<pre class="programlisting">  ipv6addr        : IPv6 address</pre>
<pre class="programlisting">  ipv6literal     : IPv6 address in literal</pre>
<pre class="programlisting">  ipv4addr        : IPv4 address</pre>
<pre class="programlisting">  ipv4hex         : IPv4 in hexadecimal format</pre>
<pre class="programlisting">  ipv4revhex      : IPv4 in byte-reversed hexadecimal format</pre>
<pre class="programlisting">  mac             : MAC address (48 bits)</pre>
<pre class="programlisting">  eui64           : EUI-64 identifier (64 bits)</pre>
<pre class="programlisting">  base85          : Base-85 string</pre>
<pre class="programlisting">  ifinet6         : Like line in /proc/net/if_inet6</pre>
<pre class="programlisting">  iid+token       : Interface identifier and token</pre>
<pre class="programlisting">  ipv6logconv     : ipv6logconv (currently not supported)</pre>
<pre class="programlisting">  prefix+mac      : IPv6 prefix and a MAC address</pre>
<pre class="programlisting">  asn             : Autonomous System Number</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1393"></a>Output-type options:</h4></div></div></div>

<pre class="programlisting">$ ipv6calc --out -?</pre>
<pre class="programlisting">ipv6calc: version 4.2.0 GeoIP GeoIPv6 IP2Location IP2Location6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID DB_IPV4_DUMP_CC ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID</pre>
<pre class="programlisting">(P) &amp; (C) 2001-2023 by Peter Bieringer &lt;pb (at) bieringer.de&gt;</pre>
<pre class="programlisting"> Available output types:</pre>
<pre class="programlisting">  revnibbles.int  : dot separated nibbles reverse, ending with ip6.int.</pre>
<pre class="programlisting">  revnibbles.arpa : dot separated nibbles reverse, ending with ip6.arpa.</pre>
<pre class="programlisting">  bitstring       : bitstring labes, ending with ip6.arpa.</pre>
<pre class="programlisting">  ipv6addr        : IPv6 address</pre>
<pre class="programlisting">  ipv4addr        : IPv4 address</pre>
<pre class="programlisting">  mac             : MAC address (48 bits)</pre>
<pre class="programlisting">  eui64           : EUI-64 identifier (64 bits)</pre>
<pre class="programlisting">  base85          : Base-85 string</pre>
<pre class="programlisting">  ifinet6         : Like line in /proc/net/if_inet6</pre>
<pre class="programlisting">  iid             : Interface identifier</pre>
<pre class="programlisting">  iid+token       : Interface identifier and token</pre>
<pre class="programlisting">  addrtype        : Address type</pre>
<pre class="programlisting">  ouitype         : OUI (IEEE) type</pre>
<pre class="programlisting">  ipv6addrtype    : IPv6 address type</pre>
<pre class="programlisting">  any             : any type (currently not supported)</pre>
<pre class="programlisting">  revipv4         : reverse IPv4, ending with in-addr.arpa</pre>
<pre class="programlisting">  ipv4hex         : IPv4 in hexadecimal format</pre>
<pre class="programlisting">  octal           : IP address in escaped octal format</pre>
<pre class="programlisting">  hex             : IP address in hexadecimal format</pre>
<pre class="programlisting">  ipv6literal     : IPv6 address in literal</pre>
<pre class="programlisting">  ipv6to4         : IPv6 address based on 6to4 converted IPv4 address</pre>
<pre class="programlisting">For examples and available format options use:</pre>
<pre class="programlisting">    -O|--out &lt;type&gt; --examples</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1394"></a>Action-type options: </h4></div></div></div>

<pre class="programlisting">$ ipv6calc --action -?</pre>
<pre class="programlisting">ipv6calc: version 4.2.0 GeoIP GeoIPv6 IP2Location IP2Location6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID DB_IPV4_DUMP_CC ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID</pre>
<pre class="programlisting">(P) &amp; (C) 2001-2023 by Peter Bieringer &lt;pb (at) bieringer.de&gt;</pre>
<pre class="programlisting"> Available action types:</pre>
<pre class="programlisting">  auto             : Automatic selection of action (default)</pre>
<pre class="programlisting">  geneui64         : Converts a MAC address to an EUI-64 address</pre>
<pre class="programlisting">  conv6to4         : Converts IPv4 address &lt;-&gt; 6to4 IPv6 address (prefix)</pre>
<pre class="programlisting">  convnat64        : Converts IPv4 address &lt;-&gt; NAT64 IPv6 address</pre>
<pre class="programlisting">  ipv6tomac        : Extracts MAC of an IPv6 address (if detected)</pre>
<pre class="programlisting">  ipv6toeui64      : Extracts EUI64 of an IPv6 address (if detected)</pre>
<pre class="programlisting">  genprivacyiid    : Generates a privacy interface ID out of a given one (arg1) and a token (arg2)</pre>
<pre class="programlisting">  prefixmac2ipv6   : Generates an IPv6 address out of a prefix and a MAC address</pre>
<pre class="programlisting">  anonymize        : Anonymize IPv4/IPv6 address without loosing much information</pre>
<pre class="programlisting">  6rd_local_prefix : Calculate the 6rd prefix from given IPv6 prefix (&amp; relay prefix) and IPv4</pre>
<pre class="programlisting">                      Options:</pre>
<pre class="programlisting">                       --6rd_prefix ... (required)</pre>
<pre class="programlisting">                       --6rd_relay_prefix ... (optional)</pre>
<pre class="programlisting">  6rd_extract_ipv4 : Extract from 6rd address the include IPv4 address</pre>
<pre class="programlisting">                      Options:</pre>
<pre class="programlisting">                       --6rd_prefixlength ... (required)</pre>
<pre class="programlisting">  filter           : Filter addresses related to filter options</pre>
<pre class="programlisting">  test             : Test address against given prefix or address</pre>
<pre class="programlisting">                      Options:</pre>
<pre class="programlisting">                       --test_prefix ... (optional)</pre>
<pre class="programlisting">                       --test_gt ... (optional)</pre>
<pre class="programlisting">                       --test_ge ... (optional)</pre>
<pre class="programlisting">                       --test_lt ... (optional)</pre>
<pre class="programlisting">                       --test_le ... (optional)</pre>
<pre class="programlisting">  addr2cc          : Converts IPv4/IPv6 address into Country Code</pre>
<pre class="programlisting">  dbdump           : Dump Database</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1395"></a>Special action &#8220;filter&#8221;:</h4></div></div></div>

<p>Special action &#8220;filter&#8221; can be used especially in pipe mode to filter IP addresses related to their type and since 0.99.0 also related to database results (CountryCode, ASN or Registry).</p>
<pre class="programlisting">$ ipv6calc --action filter -h</pre>
<pre class="programlisting">ipv6calc: version 4.2.0 GeoIP GeoIPv6 IP2Location IP2Location6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID DB_IPV4_DUMP_CC ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID</pre>
<pre class="programlisting"> Filter given addresses from stdin by filter expression, e.g.</pre>
<pre class="programlisting">  echo '2001:db8::1' | ipv6calc [-A filter] -E iid-local</pre>
<pre class="programlisting">  echo '2001:db8::1' | ipv6calc [-A filter] -E iid-local,global-unicast</pre>
<pre class="programlisting">  echo '2001:db8::1' | ipv6calc [-A filter] -E ^iid-random</pre>
<pre class="programlisting"> (note: since version 0.95.0 '-A filter' is autoselected if option '-E &lt;filter expression&gt;' is given)</pre>
<pre class="programlisting"> negation of filter expression with prefix: ^</pre>
<pre class="programlisting">  IPv6 address filter tokens:</pre>
<pre class="programlisting">   ipv6  unknown unicast multicast anycast loopback link-local site-local compat-v4 mapped reserved unique-local-unicast anonymized-iid anonymized-prefix 6to4 6bone global-unicast unspecified solicited-node productive 6to4-microsoft teredo orchid link-local-teredo nat64 iid-random iid iid-local iid-global iid-teredo iid-eui48 iid-eui64 iid-isatap iid-includes-ipv4</pre>
<pre class="programlisting">  IPv4 address filter tokens:</pre>
<pre class="programlisting">   ipv4  any unicast multicast anycast broadcast loopback unspecified unknown reserved zeroconf site-local anonymized anonymized-geonameid global 6to4relay lisp lisp-proxyegresstunnelrouter-anycast lisp-mapresolver-anycast</pre>
<pre class="programlisting">  IPv4/v6 address filter tokens based on databases:</pre>
<pre class="programlisting">   [^][ipv4.|ipv6.]db.cc=&lt;CC&gt;|unknown (Country Code [2 chars])</pre>
<pre class="programlisting">   [^][ipv4.|ipv6.]db.asn=&lt;ASN&gt;|unknown (Autonomous System Number)</pre>
<pre class="programlisting">   [^][ipv4.|ipv6.]db.reg=&lt;REGISTRY&gt;</pre>
<pre class="programlisting">    Registry tokens: 6BONE IANA APNIC ARIN RIPENCC LACNIC AFRINIC 6TO4 reserved unknown</pre>
<pre class="programlisting">  IPv4/v6 address filter tokens based on address/mask:</pre>
<pre class="programlisting">   [^]ipv4.addr=&lt;IPV4-ADDRESS&gt;[&lt;PREFIX-LENGTH&gt;]</pre>
<pre class="programlisting">   [^]ipv6.addr=&lt;IPV6-ADDRESS&gt;[&lt;PREFIX-LENGTH&gt;]</pre>
<pre class="programlisting">  IPv4/v6 address filter tokens based on address ranges (&lt;=|&lt;|&gt;|&gt;=):</pre>
<pre class="programlisting">   [^]ipv4.addr(&lt;=|&lt;|&gt;|&gt;=)&lt;IPV4-ADDRESS&gt;</pre>
<pre class="programlisting">   [^]ipv6.addr(&lt;=|&lt;|&gt;|&gt;=)&lt;IPV6-ADDRESS&gt;</pre>
<pre class="programlisting">   as alternative in case &lt;|&gt; creating problems also supported: =(le|lt|gt|ge)=:</pre>
<pre class="programlisting">   [^]ipv4.addr=(le|lt|gt|ge)=&lt;IPV4-ADDRESS&gt;</pre>
<pre class="programlisting">   [^]ipv6.addr=(le|lt|gt|ge)=&lt;IPV6-ADDRESS&gt;</pre>
<pre class="programlisting">  EUI-48/MAC address filter tokens:</pre>
<pre class="programlisting">    IMPLEMENTATION MISSING</pre>
<pre class="programlisting">  EUI-64 address filter tokens:</pre>
<pre class="programlisting">    IMPLEMENTATION MISSING</pre>
<p>Example for some filter expressions:</p>
<pre class="programlisting">$ cat ip.bieringer.de-log.201504 | ipv6calc -E ipv6.db.cc=DE | wc -l</pre>
<pre class="programlisting">5068</pre>
<pre class="programlisting">$ cat ip.bieringer.de-log.201504 | ipv6calc -E ipv6.db.cc=US | wc -l</pre>
<pre class="programlisting">305</pre>
<pre class="programlisting">$ cat ip.bieringer.de-log.201504 | ipv6calc -E ipv6.db.reg=ARIN | wc -l</pre>
<pre class="programlisting">306</pre>
<pre class="programlisting">$ cat ip.bieringer.de-log.201504 | ipv6calc -E iid-random | wc -l</pre>
<pre class="programlisting">4806</pre>
<pre class="programlisting">$ cat ip.bieringer.de-log.201504 | ipv6calc -E ipv6.db.cc=US,iid-random | wc -l</pre>
<pre class="programlisting">16</pre>
<pre class="programlisting">$ cat ip.bieringer.de-log.201504 | ipv6calc -A filter -E ipv6.db.cc=US,iid-random,ipv4.db.cc=US | wc -l</pre>
<pre class="programlisting">1842</pre>
<pre class="programlisting">$ cat ip.bieringer.de-log.201504 | ipv6calc -A filter -E db.asn=8767 | wc -l</pre>
<pre class="programlisting">2363</pre>
<pre class="programlisting">$ cat ip.bieringer.de-log.201504 | ipv6calc -A filter -E ipv6.db.asn=8767 | wc -l</pre>
<pre class="programlisting">1452</pre>
<pre class="programlisting">$ cat ip.bieringer.de-log.201504 | ipv6calc -A filter -E ipv4.db.asn=8767 | wc -l</pre>
<pre class="programlisting">911</pre>
<p>Example for searching for addresses in a specific range (supported since 0.99.2):</p>
<pre class="programlisting">$ cat ip.bieringer.de-log.201609 | awk '{ print $1 }' | sort | uniq | ipv6calc -E ipv6.addr=ge=2002::,ipv6.addr=lt=2003::</pre>
<pre class="programlisting">2002:2518:0:1:2:3:4:5</pre>
<pre class="programlisting">...</pre>
<pre class="programlisting">2002:d950:0:1:2:3:4:5</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1396"></a>Special action &#8220;test&#8221;:</h4></div></div></div>

<p>Special action &#8220;test&#8221; (since 0.99.2) can be used in command line or pipe mode (single address only) to test IP addresses related to a given prefix or range .</p>
<pre class="programlisting">$ ipv6calc -A test -?</pre>
<pre class="programlisting">ipv6calc: version 2.1.1 GeoIP GeoIPv6 IP2Location IP2Location6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID</pre>
<pre class="programlisting"> Test given address(es) against supported tests:</pre>
<pre class="programlisting">  --test_prefix &lt;PREFIX&gt;       : inside a prefix</pre>
<pre class="programlisting">  --test_gt|--test_ge &lt;ADDRESS&gt;: greater(/equal) than an address</pre>
<pre class="programlisting">  --test_lt|--test_le &lt;ADDRESS&gt;: less(/equal) than an address</pre>
<pre class="programlisting"> Test given address(es) from stdin, e.g.</pre>
<pre class="programlisting">  echo '2001:db8::1' | ipv6calc [-A test] --test_prefix 2001:db8::/32</pre>
<pre class="programlisting">  echo '2001:db8::1' | ipv6calc [-A test] --test_prefix 2001:db9::/32</pre>
<pre class="programlisting"> Single address test, return code: 0=inside/matching 1=outside/not-matching 2=uncomparable</pre>
<pre class="programlisting">  ipv6calc [-A test] --test_prefix 2001:db8::/32 2001:db8::1</pre>
<pre class="programlisting">  ipv6calc [-A test] --test_prefix 2001:db9::/32 2001:db8::1</pre>
<pre class="programlisting">  ipv6calc [-A test] --test_ge 2001:db8:: --test_le 2001:db8:ffff:ffff:ffff:ffff:ffff:ffff 2001:db8::1</pre>
<pre class="programlisting">  ipv6calc [-A test] --test_ge 2001:db9:: --test_le 2001:db9:ffff:ffff:ffff:ffff:ffff:ffff 2001:db8::1</pre>
<pre class="programlisting">  ipv6calc [-A test] --test_ge 2001:db9:: --test_lt 2001:dba:: 2001:db8::1</pre>
<pre class="programlisting">  ipv6calc [-A test] --test_ge 2001:db8:: --test_lt 2001:db9:: 2001:db8::1</pre>
<p>Example for command line mode:</p>
<pre class="programlisting">$ ipv6calc --test_ge 2001:db8:: --test_le 2001:db8:ffff:ffff:ffff:ffff:ffff:ffff 2001:db8::1; echo $?</pre>
<pre class="programlisting">no input type specified, try autodetection...found type: ipv6addr</pre>
<pre class="programlisting">no output type specified, try autodetection...found type: ipv6addr</pre>
<pre class="programlisting">2001:db8::1   greater/equal than 2001:db8::  less/equal than 2001:db8:ffff:ffff:ffff:ffff:ffff:ffff</pre>
<pre class="programlisting">0</pre>
<p>Example for command line mode (quiet):</p>
<pre class="programlisting">$ ipv6calc -q --test_ge 2001:db8:: --test_le 2001:db8:ffff:ffff:ffff:ffff:ffff:ffff 2001:db8::1; echo $?</pre>
<pre class="programlisting">2001:db8::1   greater/equal than 2001:db8::  less/equal than 2001:db8:ffff:ffff:ffff:ffff:ffff:ffff</pre>
<pre class="programlisting">0</pre>
<p>Example for pipe mode:</p>
<pre class="programlisting">$ echo -e "1.2.3.4\n1.2.4.4" | ipv6calc --test_prefix 1.2.3.0/24</pre>
<pre class="programlisting">1.2.3.4   inside 1.2.3.0/24</pre>
<pre class="programlisting">1.2.4.4   NOT inside 1.2.3.0/24</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1397"></a>Special action &#8220;conv6to4&#8221;:</h4></div></div></div>

<p>Special action &#8220;conv6to4&#8221; (since at least 0.99.1) can be used in command line or pipe mode to convert 6to4-IPv6 in IPv4 addresses and vice versa.</p>
<pre class="programlisting">$ ipv6calc: version 3.2.1 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO ANON_ZEROISE ANON_ANONYMIZE</pre>
<pre class="programlisting">  Convert IPv4 to 6to4 prefix / extract IPv4 from 6to4 prefix</pre>
<pre class="programlisting">   ipv6calc -A conv6to4 192.0.2.1          -&gt; 2002:c000:201::</pre>
<pre class="programlisting">   ipv6calc -A conv6to4 192.0.2.1/24       -&gt; 2002:c000:200::/40</pre>
<pre class="programlisting">   ipv6calc -A conv6to4 192.0.2.0/24       -&gt; 2002:c000:200::/40</pre>
<pre class="programlisting">   ipv6calc -A conv6to4 2002:c000:201::    -&gt; 192.0.2.1</pre>
<pre class="programlisting">   ipv6calc -A conv6to4 2002:c000:201::/40 -&gt; 192.0.2.0/24</pre>
<pre class="programlisting">  See '-O ipv4 -h' or '-O ipv6 -h' for optional output modifications</pre>
<pre class="programlisting">  Can also be used in PIPE mode to convert a list of IP addresses/networks</pre>
<p>Example for command line mode:</p>
<pre class="programlisting">$ ipv6calc -q -A conv6to4 192.0.2.1</pre>
<pre class="programlisting">2002:c000:201::</pre>
<p>Example for pipe mode:</p>
<pre class="programlisting">echo -e "1.2.3.4\n1.2.4.4" | ipv6calc -A conv6to4</pre>
<pre class="programlisting">2002:102:304::</pre>
<pre class="programlisting">2002:102:404::</pre>
<pre class="programlisting">$ echo -e "1.2.3.0/24\n1.2.4.0/24" | ipv6calc -A conv6to4</pre>
<pre class="programlisting">2002:102:300::/40</pre>
<pre class="programlisting">2002:102:400::/40</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1398"></a>Special action &#8220;dbdump&#8221;:</h4></div></div></div>

<p>Since version 3.3.0, action &#8220;dbdump&#8221; is provided</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>Version &gt;= 3.3.0: database &#8220;External&#8221;, type: IPv4/IPv6 addresses, suppported filter: CountryCode</p>
</li></ul></div>
<p>Precondition: created/updated &#8220;External&#8221; database</p>
<pre class="programlisting">$ /usr/share/ipv6calc/tools/ipv6calc-db-update.sh</pre>
<pre class="programlisting">...</pre>
<p>Precondition: active &#8220;database dump&#8221; support</p>
<pre class="programlisting">$ ipv6calc -vv 2&gt;&amp;1 | grep -E '(DB_IPV4_DUMP_CC|DB_IPV6_DUMP_CC)'</pre>
<pre class="programlisting">ipv6calc: version 3.3.0 GeoIP GeoIPv6 IP2Location IP2Location6 DBIPv4 DBIPv6 DB_AS_REG DB_IPV4_REG DB_IPV6_REG DB_IPV4_AS DB_IPV6_AS DB_IPV4_CC DB_IPV6_CC DB_IPV4_COUNTRY DB_IPV6_COUNTRY DB_IPV4_CITY DB_IPV6_CITY DB_IPV4_REGION DB_IPV6_REGION DB_CC_REG DB_IEEE DB_IPV4_INFO DB_IPV6_INFO DB_IPV4_GEONAMEID DB_IPV6_GEONAMEID DB_IPV4_DUMP_CC DB_IPV6_DUMP_CC ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID </pre>
<pre class="programlisting">DB_IPV4_DUMP_CC (IPv4 Database Dump by CountryCode): External</pre>
<pre class="programlisting">DB_IPV6_DUMP_CC (IPv6 Database Dump by CountryCode): External </pre>
<p>Precondition: recognized &#8220;External&#8221; database</p>
<pre class="programlisting">$ ipv6calc -vv 2&gt;&amp;1 | grep -E '(External: IPv. CountryCode)'</pre>
<pre class="programlisting">External: IPv4 CountryCode    : ipv6calc-external-ipv4-countrycode.db    (EXTDB-3/AFRINIC/20210919 APNIC/20210917 ARIN/20210919 IANA/20210205 LACNIC/20210918 LISP/20200318 RIPENCC/20210918, created: 20210919-152957 UTC)</pre>
<pre class="programlisting">External: IPv6 CountryCode    : ipv6calc-external-ipv6-countrycode.db    (EXTDB-4/AFRINIC/20210919 APNIC/20210917 ARIN/20210919 IANA/20191106 LACNIC/20210918 LISP/20200318 RIPENCC/20210918, created: 20210919-155049 UTC) </pre>
<p>Usage Example: dump all IPv4 networks which have not &#8220;unknown&#8221; CountryCode</p>
<pre class="programlisting">$ ipv6calc -A dbdump -E ^ipv4.db.cc=unknown</pre>
<pre class="programlisting"># 'External' database dump (with 121894 entries) start with filter IPv4 &amp;&amp; CountryCode(s): ^unknown (suppress this line with option '-q')</pre>
<pre class="programlisting">1.0.0.0/24</pre>
<pre class="programlisting">1.0.1.0/24</pre>
<pre class="programlisting">...</pre>
<pre class="programlisting"># 'External' database dump finished displaying 121894 entries with filter IPv4 &amp;&amp; CountryCode(s): ^unknown (suppress this line with option '-q') </pre>
<p>Usage Example: dump all IPv6 networks of a given CountryCode </p>
<pre class="programlisting">$ ipv6calc -A dbdump -E ipv6.db.cc=VN</pre>
<pre class="programlisting"># 'External' database dump (with 56097 entries) start with filter IPv6 &amp;&amp; CountryCode(s): VN (suppress this line with option '-q')</pre>
<pre class="programlisting">2001:7fa:6::/28</pre>
<pre class="programlisting">2001:dc8::/28 </pre>
<pre class="programlisting">...</pre>
<pre class="programlisting"># 'External' database dump finished displaying 344 entries with filter IPv6 &amp;&amp; CountryCode(s): VN (suppress this line with option '-q') </pre>
<p>Usage Example: dump all IPv4 networks of two given CountryCodes</p>
<pre class="programlisting">$ ipv6calc -A dbdump -E ipv4.db.cc=VN,ipv4.db.cc=CN</pre>
<pre class="programlisting"># 'External' database dump (with 121894 entries) start with filter IPv4 &amp;&amp; CountryCode(s): VN CN (suppress this line with option '-q')</pre>
<pre class="programlisting">1.0.1.0/24</pre>
<pre class="programlisting">1.0.2.0/23 </pre>
<pre class="programlisting">...</pre>
<pre class="programlisting"># 'External' database dump finished displaying 4631 entries with filter IPv4 &amp;&amp; CountryCode(s): VN CN (suppress this line with option '-q') </pre>
<p>Usage Example: dump all IPv4 networks of a given CountryCode incl. automatic conversion into 6to4 addresses</p>
<pre class="programlisting">$ ipv6calc -A dbdump -E ipv4.db.cc=VN -I ipv4 -O ipv6to4</pre>
<pre class="programlisting"># 'External' database dump (with 121894 entries) start with filter IPv4 &amp;&amp; CountryCode(s): VN (output format: 6to4) (suppress this line with option '-q')</pre>
<pre class="programlisting">2002:134::/30</pre>
<pre class="programlisting">2002:e00:1000::/36 </pre>
<pre class="programlisting">...</pre>
<pre class="programlisting"># 'External' database dump finished displaying 569 entries with filter IPv4 &amp;&amp; CountryCode(s): VN (output format: 6to4) (suppress this line with option '-q') </pre>
<p>Usage Example: dump all IPv6to4 networks of a given CountryCode in &#8220;ipset restore&#8221; compatible format and create/update &#8220;ipset&#8221; (related &#8220;sudo&#8221; command whitelist have to be created in advance)</p>
<pre class="programlisting">$ ipv6calc -A dbdump -E ipv4.db.cc=VN -I ipv4 -O ipv6to4 -q --print-ipset Net_VN_IPv6to4 &gt;/path/to/ipset-Net_VN_IPv6to4.txt</pre>
<pre class="programlisting">$ sudo ipset restore -f /path/to/ipset-Net_VN_IPv6to4.txt</pre>
<pre class="programlisting">$ sudo ipset list Net_VN_IPv6to4 -t</pre>
<pre class="programlisting">Name: Net_VN_IPv6to4</pre>
<pre class="programlisting">Type: hash:net</pre>
<pre class="programlisting">Revision: 7</pre>
<pre class="programlisting">Header: family inet6 hashsize 1024 maxelem 65536 bucketsize 12 initval 0x30b0bdaf</pre>
<pre class="programlisting">Size in memory: 41344</pre>
<pre class="programlisting">References: 0</pre>
<pre class="programlisting">Number of entries: 723 </pre>
<p>Hint: try also helper script for &#8217;ipset&#8217; management</p>
<pre class="programlisting">$ tools/ipv6calc-create-update-ipset.sh</pre>
</div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id1404"></a>Webserver log conversion helper program "ipv6logconv"</h2></div></div></div>

<p>This program parses address tokens of a given webserver logfile and converts them to special strings, useful for statistics (e.g. created by using "analog").</p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1401"></a>Supported options</h3></div></div></div>

<pre class="programlisting">$ ipv6logconv -h</pre>
<pre class="programlisting">ipv6logconv: version 4.3.0 CONV_REG CONV_IEEE</pre>
<pre class="programlisting">(P) &amp; (C) 2002-2025 by Peter Bieringer &lt;pb (at) bieringer.de&gt;</pre>
<pre class="programlisting">This program converts IPv4/IPv6 addresses in HTTP server log files</pre>
<pre class="programlisting">  [-d|--debug &lt;debug value&gt;] : debug value (bitwise like)</pre>
<pre class="programlisting">                                can also be set by IPV6CALC_DEBUG environment value</pre>
<pre class="programlisting">  [-v|--version [-v [-v]]]   : version information (2 optional detail levels)</pre>
<pre class="programlisting">  [-v|--version -h]          : explanation of feature tokens</pre>
<pre class="programlisting">  [-V|--verbose]             : be more verbose</pre>
<pre class="programlisting">  [-h|--help|-?]             : this online help</pre>
<pre class="programlisting"> Hint: all long options can be predefined from environment by using</pre>
<pre class="programlisting">  prefix: IPV6CALC_ and  conversion: '-' -&gt; '_' and lowercase -&gt; uppercase</pre>
<pre class="programlisting">  example for options with values   : --db-dbip2-dir=&lt;DIR&gt;  -&gt;  environment: IPV6CALC_DB_DBIP2_DIR=&lt;DIR&gt;</pre>
<pre class="programlisting">  example for options without values: --db-dbip2-disable    -&gt;  environment: IPV6CALC_DB_DBIP2_DISABLE=1</pre>
<pre class="programlisting">                                                                              on|off|0|1 is supported</pre>
<pre class="programlisting"> Performance options:</pre>
<pre class="programlisting">  [-n|--nocache]            : disable caching</pre>
<pre class="programlisting">  [-c|--cachelimit &lt;value&gt;] : set cache limit</pre>
<pre class="programlisting">                               default: 20</pre>
<pre class="programlisting">                               maximum: 200</pre>
<pre class="programlisting"> Output options:</pre>
<pre class="programlisting">  [--out &lt;output type&gt;] : specify output type</pre>
<pre class="programlisting">   addrtype       : Address type</pre>
<pre class="programlisting">   ouitype        : OUI (IEEE) type</pre>
<pre class="programlisting">   ipv6addrtype   : IPv6 address type</pre>
<pre class="programlisting">   any            : any type</pre>
<pre class="programlisting"> Takes data from stdin, proceed it to stdout</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1402"></a>Examples</h3></div></div></div>

<p>A demonstration about which kind of statistics are possible to produce is shown at <a class="ulink" href="http://www.ipv6.bieringer.de/" target="_top">http://www.ipv6.bieringer.de/</a> (IPv6 only).</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1403"></a>Usage</h3></div></div></div>

<p>Example:</p>
<pre class="programlisting">$ echo "2002:50b5:7940:0000:0000:0000:50b5:7940 - -" | ipv6logconv -q --out any</pre>
<pre class="programlisting">RIPENCC.6to4.global-unicast.ipv6-addr.addrtype.ipv6calc</pre>
<p>See more examples inside the package.</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id1415"></a>Webserver log anonymization helper program "ipv6loganon"</h2></div></div></div>

<p>On autoconfiguration, the interface part of an IPv6 address is based on the MAC address of the network interface card (NIC). This address is used for outgoing requests, if privacy option (RFC3041 / RFC4941) is not enabled. This results in many privacy related information on web- or mail-server log files. Administrators, which won&#8217;t (be allowed to) store such information over time, but still do not want to loose information about address type distribution should use &#8217;ipv6loganon&#8217; to anonymize their log files.</p>
<p>Since version 0.94.0 internally also IID anonymization is possible without loosing any information for &#8220;ipv6logstats&#8221;.</p>
<p>Since version 0.95.0 internally also prefix anonymization is possible without loosing any information for &#8220;ipv6logstats&#8221;.</p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1409"></a>Anonymization details</h3></div></div></div>

<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1405"></a>Method &#8220;zeroize&#8221;</h4></div></div></div>

<p>The anonymizer would keep as much information as possible for IPv6 address types.</p>
<p>Client-side IID would be anonymized by</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>EUI-48 based: serial number would be zero&#8217;ed, keeping OID</p>
</li><li class="listitem">
<p>EUI-64 based: serial number would be zero&#8217;ed, keeping OID</p>
</li><li class="listitem">
<p>ISATAP: client IPv4 address would be anonymized by given IPv4 mask</p>
</li><li class="listitem">
<p>TEREDO: client IPv4 address would be anonymized by given IPv4 mask, client port would be zero&#8217;ed</p>
</li><li class="listitem">
<p>6to4(Microsoft): client IPv4 address would be anonymized by given IPv4 mask</p>
</li><li class="listitem">
<p>local: whole IID would be zero&#8217;ed</p>
</li></ul></div>
<p>Client-side SLA would be anonymized by </p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>SLA would be zero&#8217;ed</p>
</li></ul></div>
<p>Prefix would be anonymized by</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>6to4: client IPv4 address would be anonymized by given IPv4 mask</p>
</li></ul></div>
<p>Compat/Mapped IPv4 addresses would be anonymized by</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>IPv4 address would be anonymized by given IPv4 mask</p>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1406"></a>Method &#8220;anonmize&#8221;</h4></div></div></div>

<p>The anonymizer would keep as much information as possible for the IID of an IPv6 address.</p>
<p>Description from libipv6addr.h:</p>
<pre class="programlisting"> * IID anonymization is done by replacing with related information (64-bit)</pre>
<pre class="programlisting"> * xxxx:xxxx:xxxx:xxxC  (C = 4-bit checksum)</pre>
<pre class="programlisting"> *</pre>
<pre class="programlisting"> * a9p9 4941 0000 000C  -&gt; RFC 4941 anonymized privacy extension Interface ID</pre>
<pre class="programlisting"> *</pre>
<pre class="programlisting"> * a9p9 4291 4xxx xxxC  -&gt; RFC 4291 anonymized EUI-48 Interface ID, xxx xxx = converted OUI</pre>
<pre class="programlisting"> * a9p9 4291 5xxx xxxC  -&gt; RFC 4291 anonymized EUI-48 Interface ID, xxx xxx = converted mapped IAB/OUI-36</pre>
<pre class="programlisting"> * a9p9 4291 6xxx xxxC  -&gt; RFC 4291 anonymized EUI-64 Interface ID, xxx xxx = converted OUI</pre>
<pre class="programlisting"> * a9p9 4291 7xxx xxxC  -&gt; RFC 4291 anonymized EUI-64 Interface ID, xxx xxx = converted mapped IAB/OUI-36</pre>
<pre class="programlisting"> * a9p9 4291 8xxx xxxC  -&gt; RFC 4291 embedded anonymized IPv4 address, xxx xxx = first 24 bit of included (anonymized) IPv4 address</pre>
<pre class="programlisting"> * a9p9 4291 c02d 5d1C  -&gt; RFC 4291 Chapter 2.5.1 anonymized static Interface ID</pre>
<pre class="programlisting"> *</pre>
<pre class="programlisting"> * a9p9 5214 4xxx xxxC  -&gt; RFC 5214 anonymized ISATAP Interface ID, xxx xxx = first 24 bit of included (anonymized) IPv4 address (local scope)</pre>
<pre class="programlisting"> * a9p9 5214 5xxx xxxC  -&gt; RFC 5214 anonymized ISATAP Interface ID, xxx xxx = first 24 bit of included (anonymized) IPv4 address (global scope)</pre>
<pre class="programlisting"> * a9p9 5214 cxx0 000C  -&gt; RFC 5214 anonymized ISATAP Interface ID, xx      = first  8 bit of included vendor ID (local scope)</pre>
<pre class="programlisting"> * a9p9 5214 dxx0 000C  -&gt; RFC 5214 anonymized ISATAP Interface ID, xx      = first  8 bit of included vendor ID (global scope)</pre>
<pre class="programlisting"> * a9p9 5214 exxx xxxC  -&gt; RFC 5214 anonymized ISATAP Interface ID, xxx xxx = first 24 bit of included extension ID (local scope)</pre>
<pre class="programlisting"> * a9p9 5214 fxxx xxxC  -&gt; RFC 5214 anonymized ISATAP Interface ID, xxx xxx = first 24 bit of included extension ID (global scope)</pre>
<pre class="programlisting"> *</pre>
<pre class="programlisting"> * a9p9 4843 0000 000C  -&gt; RFC 4843 anonymized ORCHID hash</pre>
<p>Depending on given mask, the part of the prefix will be replaced:</p>
<pre class="programlisting"> * SLA/NLA prefix part anonymization is done by replacing with pattern a909a909</pre>
<pre class="programlisting"> *   p = number of nibbles anonymized</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1407"></a>Method &#8220;keep-type-asn-cc&#8221;</h4></div></div></div>

<p>In addition to &#8220;anonymize&#8221; (of IID) this method anonymizes also the prefix of an IPv6 address or a whole IPv4 address by keeping ASN (Autonomous System Number, Country Code and Type).</p>
<p>Description from libipv6addr.h:</p>
<pre class="programlisting"> * Prefix anonymization in case of method=kp: p=0x0f</pre>
<pre class="programlisting"> * a909:ccca:aaaa:aaaC  (C = 4-bit checksum)</pre>
<pre class="programlisting"> *                      ccc      -&gt; 10-bit Country Code mapping [A-Z]*[A-Z0-9] (936)</pre>
<pre class="programlisting"> *                                   0x3FD = LISP</pre>
<pre class="programlisting"> *                                   0x3FE = unknown country</pre>
<pre class="programlisting"> *                                   0x3FF - 16 + REGISTRY_6BONE &amp;&amp; ASN=0 = 6bone </pre>
<pre class="programlisting"> *                                   0x000-0x3A7: c1= c / 36, c2 = c % 36</pre>
<pre class="programlisting"> *                      aaaaaaaa -&gt; 32-bit ASN</pre>
<p>Description from libipv4addr.h:</p>
<pre class="programlisting"> *  Global IPv4 addresses are anoymized by storing country code and AS number</pre>
<pre class="programlisting"> *   and using prefix of experimental range (240-255.x.y.z)</pre>
<pre class="programlisting"> *</pre>
<pre class="programlisting"> *  3 3 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1 </pre>
<pre class="programlisting"> *  1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0</pre>
<pre class="programlisting"> *  1 1 1 1</pre>
<pre class="programlisting"> * |p p p p|</pre>
<pre class="programlisting"> *  Prefix                </pre>
<pre class="programlisting"> *    0xF</pre>
<pre class="programlisting"> *</pre>
<pre class="programlisting"> * Pariy Bit (odd parity)</pre>
<pre class="programlisting"> *         |P|</pre>
<pre class="programlisting"> *</pre>
<pre class="programlisting"> * Mapping of Country Code</pre>
<pre class="programlisting"> *           |c c c c c c c c c c|</pre>
<pre class="programlisting"> *            10-bit Country Code mapping [A-Z]*[A-Z0-9] (936)</pre>
<pre class="programlisting"> *            0x3FF = unknown country</pre>
<pre class="programlisting"> *            0x000-0x3A7: c1= c / 36, c2 = c % 36</pre>
<pre class="programlisting"> *</pre>
<pre class="programlisting"> * Mapping of ASN &lt;= 65535</pre>
<pre class="programlisting"> *                                0|a a a a a a a a a a a a a a a a|</pre>
<pre class="programlisting"> *                                    16-bit ASN</pre>
<pre class="programlisting"> *</pre>
<pre class="programlisting"> * Mapping of ASN &gt;= 65536, ASN &amp; 0xE000 == 0 (12-bit LSB is ok) </pre>
<pre class="programlisting"> *                                1|r r r|0|l l l l l l l l l l l l|</pre>
<pre class="programlisting"> *                                           13-bit LSB of ASN</pre>
<pre class="programlisting"> *</pre>
<pre class="programlisting"> * Mapping of ASN &gt;= 65536, ASN &amp; 0xE000 != 0 (12-bit LSB overflow) =&gt; unspecified</pre>
<pre class="programlisting"> *                                1|r r r|1|0 0 0 0 0 0 0 0 0 0 0 0|</pre>
<pre class="programlisting"> *</pre>
<pre class="programlisting"> * Mapping of ASN registry for ASN &gt;= 65536</pre>
<pre class="programlisting"> *                                  0 0 0 = "unknown ASN registry"</pre>
<pre class="programlisting"> *                                  0 1 0 = APNIC</pre>
<pre class="programlisting"> *                                  0 1 1 = RIPE</pre>
<pre class="programlisting"> *                                  1 0 0 = LACNIC</pre>
<pre class="programlisting"> *                                  1 0 1 = AFRINIC</pre>
<pre class="programlisting"> *                                  1 1 0 = ARIN</pre>
<pre class="programlisting"> * Mapping of LISP</pre>
<pre class="programlisting"> *                                1|r r r|1|1|0 0 0 0 0 0 0 0 0 0 0| </pre>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1408"></a>Method &#8220;keep-type-geonameid&#8221;</h4></div></div></div>

<p>In difference to keep-type-asn-cc this method anonymizes the prefix of an IPv6 address or a whole IPv4 address by keeping the GeonameID and Type.</p>
<p>Description from libipv6addr.h:</p>
<pre class="programlisting"> * a909:sssg:gggg:gggC  (C = 4-bit checksum)</pre>
<pre class="programlisting"> *                      sss      -&gt; 10-bit source mapping</pre>
<pre class="programlisting"> *                                   GeonameID source information</pre>
<pre class="programlisting"> *                                   0x000 = unknown</pre>
<pre class="programlisting"> *                                   0x001 = continent  (prio: lowest)</pre>
<pre class="programlisting"> *                                   0x002 = country</pre>
<pre class="programlisting"> *                                   0x003 = state/prov</pre>
<pre class="programlisting"> *                                   0x004 = district</pre>
<pre class="programlisting"> *                                   0x005 = city       (prio: highest)</pre>
<pre class="programlisting"> *                                   0x006 = (reserved)</pre>
<pre class="programlisting"> *                                   0x007 = LISP</pre>
<pre class="programlisting"> *                                   0x0r. = registry</pre>
<pre class="programlisting"> *                               -&gt; 2 leftmost bit are |0 1|</pre>
<pre class="programlisting"> *                      gggggggg -&gt; 32-bit GeonameID</pre>
<pre class="programlisting"> *                                   0x11800 = LISP</pre>
<p>Description from libipv4addr.h:</p>
<pre class="programlisting"> * IPv4 address anonymization type "keep-type-geonameid"</pre>
<pre class="programlisting"> *  Global IPv4 addresses are anonymized by storing GeonameID</pre>
<pre class="programlisting"> *   and using prefix of experimental range (240-255.x.y.z)</pre>
<pre class="programlisting"> *</pre>
<pre class="programlisting"> *  3 3 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1</pre>
<pre class="programlisting"> *  1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0</pre>
<pre class="programlisting"> *  1 1 1 1</pre>
<pre class="programlisting"> * |p p p p|</pre>
<pre class="programlisting"> *  Prefix</pre>
<pre class="programlisting"> *    0xF</pre>
<pre class="programlisting"> *</pre>
<pre class="programlisting"> * Parity Bit (even parity)</pre>
<pre class="programlisting"> *         |P|</pre>
<pre class="programlisting"> *</pre>
<pre class="programlisting"> * Mapping of GeonameID source</pre>
<pre class="programlisting"> *           |s s s|</pre>
<pre class="programlisting"> *            3-bit GeonameID source information</pre>
<pre class="programlisting"> *            0 0 0 (0x0) = unknown</pre>
<pre class="programlisting"> *            0 0 1 (0x1) = continent  (prio: lowest)</pre>
<pre class="programlisting"> *            0 1 0 (0x2) = country</pre>
<pre class="programlisting"> *            0 1 1 (0x3) = state/prov</pre>
<pre class="programlisting"> *            1 0 0 (0x4) = district</pre>
<pre class="programlisting"> *            1 0 1 (0x5) = city       (prio: highest)</pre>
<pre class="programlisting"> *            1 1 0 (0x6) = (reserved)</pre>
<pre class="programlisting"> *            1 1 1 (0x7) = LISP</pre>
<pre class="programlisting"> *</pre>
<pre class="programlisting"> * Mapping of GeonameID (limited to IDs &lt; 2^24, in worst case ID from source with lower prio is used)</pre>
<pre class="programlisting"> *                 |g g g g g g g g g g g g g g g g g g g g g g g g|</pre>
<pre class="programlisting"> *</pre>
<pre class="programlisting"> * Mapping of LISP registry</pre>
<pre class="programlisting"> *                                  0 0 0 = "unknown ASN registry"</pre>
<pre class="programlisting"> *                                  0 1 0 = APNIC</pre>
<pre class="programlisting"> *                                  0 1 1 = RIPE</pre>
<pre class="programlisting"> *                                  1 0 0 = LACNIC</pre>
<pre class="programlisting"> *                                  1 0 1 = AFRINIC</pre>
<pre class="programlisting"> *                                  1 1 0 = ARIN</pre>
<pre class="programlisting"> *                 |0 0 0 0 0 0 0 1 r r r 1 1 0 0 0 0 0 0 0 0 0 0 0|</pre>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1410"></a>Supported log file formats</h3></div></div></div>

<p>Currently native supported log files:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>Apache log file format, 1st token is IPv4 or IPv6 address</p>
</li></ul></div>
<p>There are plans to support also mail server log files sometimes in the future, but because of different formats, this would be probably done by a Perl program which parses the log file and a (cached) &#8217;ip6calc&#8217; call with action &#8217;anonymize&#8217;.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1411"></a>Supported options</h3></div></div></div>

<pre class="programlisting">$ ipv6loganon -h</pre>
<pre class="programlisting">ipv6loganon: version 4.3.0 ANON_ZEROISE ANON_ANONYMIZE ANON_KEEP-TYPE-ASN-CC ANON_KEEP-TYPE-GEONAMEID</pre>
<pre class="programlisting">(P) &amp; (C) 2007-2025 by Peter Bieringer &lt;pb (at) bieringer.de&gt;</pre>
<pre class="programlisting">This program anonymizes IPv4/IPv6 addresses in e.g. HTTP server log files</pre>
<pre class="programlisting">  [-d|--debug &lt;debug value&gt;] : debug value (bitwise like)</pre>
<pre class="programlisting">                                can also be set by IPV6CALC_DEBUG environment value</pre>
<pre class="programlisting">  [-v|--version [-v [-v]]]   : version information (2 optional detail levels)</pre>
<pre class="programlisting">  [-v|--version -h]          : explanation of feature tokens</pre>
<pre class="programlisting">  [-V|--verbose]             : be more verbose</pre>
<pre class="programlisting">  [-h|--help|-?]             : this online help</pre>
<pre class="programlisting">  [-q|--quiet]               : be more quiet</pre>
<pre class="programlisting">  [--disable-ip2location           ] : IP2Location(BIN) support disabled</pre>
<pre class="programlisting">  [--db-ip2location-disable        ] : IP2Location(BIN) support disabled</pre>
<pre class="programlisting">  [--db-ip2location-dir &lt;directory&gt;] : IP2Location(BIN) database directory (default: /var/local/share/IP2Location)</pre>
<pre class="programlisting">  [--db-ip2location-only-type &lt;TYPE&gt;]: IP2Location(BIN) database only selected type (1-666)</pre>
<pre class="programlisting">  [--db-ip2location-allow-softlinks] : IP2Location(BIN) database softlinks allowed</pre>
<pre class="programlisting">     by default they are ignored because it is hard to autodetect COMM/LITE/SAMPLE</pre>
<pre class="programlisting">  [--db-ip2location-lite-to-sample-autoswitch-max-delta-months &lt;MONTHS&gt;]:</pre>
<pre class="programlisting">     autoswitch from LITE to SAMPLE databases if possible and delta is not more than 12 months (0=disabled)</pre>
<pre class="programlisting">  [--db-ip2location-comm-to-lite-switch-min-delta-months &lt;MONTHS&gt;]:</pre>
<pre class="programlisting">     switch from COMM to LITE databases if possible and delta more than 12 months (0=disabled)</pre>
<pre class="programlisting">  [--disable-ip2location2           ] : IP2Location(MMDB) support disabled</pre>
<pre class="programlisting">  [--db-ip2location2-disable        ] : IP2Location(MMDB) support disabled</pre>
<pre class="programlisting">  [--db-ip2location2-dir &lt;directory&gt;] : IP2Location(MMDB) database directory (default: /var/local/share/IP2Location)</pre>
<pre class="programlisting">  [--db-ip2location2-only-type &lt;TYPE&gt;]: IP2Location(MMDB) database only selected type (1-666)</pre>
<pre class="programlisting">  [--db-ip2location2-allow-softlinks] : IP2Location(MMDB) database softlinks allowed</pre>
<pre class="programlisting">     by default they are ignored because it is hard to autodetect COMM/LITE/SAMPLE</pre>
<pre class="programlisting">  [--db-ip2location2-lite-to-sample-autoswitch-max-delta-months &lt;MONTHS&gt;]:</pre>
<pre class="programlisting">     autoswitch from LITE to SAMPLE databases if possible and delta is not more than 12 months (0=disabled)</pre>
<pre class="programlisting">  [--db-ip2location-comm-to-lite-switch-min-delta-months &lt;MONTHS&gt;]:</pre>
<pre class="programlisting">     switch from COMM to LITE databases if possible and delta more than 12 months (0=disabled)</pre>
<pre class="programlisting">  [--disable-geoip2                ] : GeoIP(MaxMindDB) support disabled</pre>
<pre class="programlisting">  [--db-geoip2-disable             ] : GeoIP(MaxMindDB) support disabled</pre>
<pre class="programlisting">  [--db-geoip2-dir      &lt;directory&gt;] : GeoIP(MaxMindDB) database directory (default: /var/local/share/GeoIP)</pre>
<pre class="programlisting">  [--disable-dbip2                 ] : db-ip.com(MaxMindDB) support disabled</pre>
<pre class="programlisting">  [--db-dbip2-disable              ] : db-ip.com(MaxMindDB) support disabled</pre>
<pre class="programlisting">  [--db-dbip2-dir       &lt;directory&gt;] : db-ip.com(MaxMindDB) database directory (default: /var/local/share/DBIP)</pre>
<pre class="programlisting">  [--db-dbip2-only-type &lt;TYPE&gt;]      : db-ip.com(MaxMindDB) database only selected type (1-6)</pre>
<pre class="programlisting">  [--db-dbip2-comm-to-free-switch-min-delta-months &lt;MONTHS&gt;]:</pre>
<pre class="programlisting">     switch from COMM to FREE databases if possible and delta more than 12 months (0=disabled)</pre>
<pre class="programlisting">  [--disable-external              ] : External support disabled</pre>
<pre class="programlisting">  [--db-external-disable           ] : External support disabled</pre>
<pre class="programlisting">  [--db-external-dir    &lt;directory&gt;] : External database directory (default: /var/local/share/ipv6calc)</pre>
<pre class="programlisting">  [--disable-builtin               ] : BuiltIn support disabled</pre>
<pre class="programlisting">  [--db-builtin-disable            ] : BuiltIn support disabled</pre>
<pre class="programlisting">  [--db-priorization &lt;entry1&gt;[:...]] : Database priorization order list (overwrites default)</pre>
<pre class="programlisting">                                         colon separated: GeoIP2 IP2Location DBIP2 External BuiltIn IP2Location2</pre>
<pre class="programlisting"> Hint: all long options can be predefined from environment by using</pre>
<pre class="programlisting">  prefix: IPV6CALC_ and  conversion: '-' -&gt; '_' and lowercase -&gt; uppercase</pre>
<pre class="programlisting">  example for options with values   : --db-dbip2-dir=&lt;DIR&gt;  -&gt;  environment: IPV6CALC_DB_DBIP2_DIR=&lt;DIR&gt;</pre>
<pre class="programlisting">  example for options without values: --db-dbip2-disable    -&gt;  environment: IPV6CALC_DB_DBIP2_DISABLE=1</pre>
<pre class="programlisting">                                                                              on|off|0|1 is supported</pre>
<pre class="programlisting">  [-w|--write]               : write output to file instead of stdout</pre>
<pre class="programlisting">  [-a|--append]              : append output to file instead of stdout</pre>
<pre class="programlisting">  [-f|--flush]               : flush output after each line</pre>
<pre class="programlisting">  [-V|--verbose]             : be verbose</pre>
<pre class="programlisting">  [-n|--nocache]             : disable caching</pre>
<pre class="programlisting">  [-c|--cachelimit &lt;value&gt;]  : set cache limit</pre>
<pre class="programlisting">                               default: 20</pre>
<pre class="programlisting">                               maximum: 200</pre>
<pre class="programlisting">  Shortcut for anonymization presets:</pre>
<pre class="programlisting">   --anonymize-standard (default)</pre>
<pre class="programlisting">   --anonymize-careful</pre>
<pre class="programlisting">   --anonymize-paranoid</pre>
<pre class="programlisting">  Supported methods [--anonymize-method METHOD]:</pre>
<pre class="programlisting">   anonymize : reliable anonymization, keep as much type information as possible</pre>
<pre class="programlisting">   zeroize   : simple zeroizing according to given masks, probably loose type information</pre>
<pre class="programlisting">   keep-type-asn-cc: special reliable anonymization, keep type &amp; Autonomous System Number and CountryCode</pre>
<pre class="programlisting">   keep-type-geonameid: special reliable anonymization, keep type &amp; GeonameID</pre>
<pre class="programlisting">  Available presets (shortcut names) [--anonymize-preset|ap PRESET-NAME]:</pre>
<pre class="programlisting">   anonymize-standard   (as): mask-ipv6= 56 mask-ipv4=24 mask-eui64=40 mask-mac=24 mask-autoadjust=yes method=anonymize</pre>
<pre class="programlisting">   anonymize-careful    (ac): mask-ipv6= 48 mask-ipv4=20 mask-eui64=24 mask-mac=24 mask-autoadjust=yes method=anonymize</pre>
<pre class="programlisting">   anonymize-paranoid   (ap): mask-ipv6= 40 mask-ipv4=16 mask-eui64= 0 mask-mac=24 mask-autoadjust=no  method=anonymize</pre>
<pre class="programlisting">   zeroize-standard     (zs): mask-ipv6= 56 mask-ipv4=24 mask-eui64=40 mask-mac=24 mask-autoadjust=yes method=zeroize</pre>
<pre class="programlisting">   zeroize-careful      (zc): mask-ipv6= 48 mask-ipv4=20 mask-eui64=24 mask-mac=24 mask-autoadjust=yes method=zeroize</pre>
<pre class="programlisting">   zeroize-paranoid     (zp): mask-ipv6= 40 mask-ipv4=16 mask-eui64= 0 mask-mac=24 mask-autoadjust=no  method=zeroize</pre>
<pre class="programlisting">   keep-type-asn-cc     (kp): mask-ipv6= 56 mask-ipv4=24 mask-eui64=40 mask-mac=24 mask-autoadjust=yes method=keep-type-asn-cc</pre>
<pre class="programlisting">   keep-type-geonameid  (kg): mask-ipv6= 56 mask-ipv4=24 mask-eui64=40 mask-mac=24 mask-autoadjust=yes method=keep-type-geonameid</pre>
<pre class="programlisting">  Custom control:</pre>
<pre class="programlisting">  --mask-ipv4  &lt;bits&gt;     : mask IPv4 address [0-32] (even if occurs in IPv6 address)</pre>
<pre class="programlisting">  --mask-ipv6  &lt;bits&gt;     : mask IPv6 prefix [0-64] (only applied to related address types)</pre>
<pre class="programlisting">  --mask-eui64 &lt;bits&gt;     : mask EUI-64 address or IPv6 interface identifier [0-64]</pre>
<pre class="programlisting">  --mask-mac   &lt;bits&gt;     : mask MAC address [0-48]</pre>
<pre class="programlisting">  --mask-autoadjust yes|no: autoadjust mask to keep type/vendor information regardless of less given mask</pre>
<pre class="programlisting"> Takes data from stdin, outputs the processed data to stdout (default)</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1414"></a>Usage</h3></div></div></div>

<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1412"></a>Offline anonymization</h4></div></div></div>

<pre class="programlisting">$ cat /path/to/http_log | ./ipv6loganon &gt;/path/to/http_log_anonymized</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1413"></a>On-the-fly online anonymization for Apache Webserver</h4></div></div></div>

<div class="blockquote"><blockquote class="blockquote">
<p>Note: since 0.91.1 also a module for Apache Webserver is available (see below) supporting anonymized logging</p>
</blockquote></div>
<p>(Supported since 0.90.0)</p>
<p>Adjust or add (note: more than one CustomLog directive is supported by Apache) httpd.conf like following:</p>
<pre class="programlisting">CustomLog "|/usr/local/bin/ipv6loganon -a -f /var/log/httpd/access_log" combined</pre>
<p>In case of &#8220;cronolog&#8221; is used on the system, configure like this:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>Apache version &lt; 2.4:</p>
</li></ul></div>
<pre class="programlisting">CustomLog "|/usr/bin/ipv6loganon -f |/usr/sbin/cronolog /var/log/httpd/access.log-%Y%m%d" combined </pre>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>Apache version &gt;= 2.4:</p>
</li></ul></div>
<pre class="programlisting">CustomLog "|$/usr/bin/ipv6loganon -f |/usr/sbin/cronolog /var/log/httpd/access.log-%Y%m%d" combined </pre>
</div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id1420"></a>External database update helper scripts</h2></div></div></div>

<p>The &#8220;tools&#8221; subdirectory contains helper scripts for updating external databases.</p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1416"></a>IP2Location</h3></div></div></div>

<p>Since 4.3.0 script also supports download of MMDB files</p>
<pre class="programlisting">$ /usr/share/ipv6calc/tools/IP2Location-update.sh -h</pre>
<pre class="programlisting">Usage: IP2Location-update.sh [-D &lt;dir&gt;] [-n] [-s] [-T] [-v] [-R [-r]]</pre>
<pre class="programlisting">	-D &lt;dir&gt;	database destination directory (optional)</pre>
<pre class="programlisting">	-n		no action (dry-run)</pre>
<pre class="programlisting">	-s		skip already successfully downloaded files</pre>
<pre class="programlisting">	-T		enforce use of 'token' instead of using 'login' &amp; 'password'</pre>
<pre class="programlisting">	-v		verbose</pre>
<pre class="programlisting">	-S &lt;selector&gt;	download only sample file given by selector IPv4:&lt;num&gt; or IPv6:&lt;num&gt;</pre>
<pre class="programlisting">	-R		restart services (having open but replaced database files)</pre>
<pre class="programlisting">			    requires "sudo" in case of non-root:</pre>
<pre class="programlisting">				/usr/bin/systemctl restart *</pre>
<pre class="programlisting">				/usr/bin/systemctl is-active *</pre>
<pre class="programlisting">				/usr/bin/lsof *</pre>
<pre class="programlisting">	-r		test-run for services restart</pre>
<pre class="programlisting">	database directory: /var/local/share/IP2Location (default: /usr/share/IP2Location)</pre>
<pre class="programlisting">	it honors externally defined environment value:</pre>
<pre class="programlisting">		prio 1: IP2LOCATION_DAT_DIR</pre>
<pre class="programlisting">		prio 2: IPV6CALC_DB_IP2LOCATION_DIR</pre>
<pre class="programlisting"> this script will download data from ip2location.com</pre>
<pre class="programlisting">  into given/set database directory</pre>
<pre class="programlisting"> Sample databases:</pre>
<pre class="programlisting">  IP2LOCATION_DAT_FILES_SAMPLE="IPv4:26 IPv6:26"</pre>
<pre class="programlisting">  IP2LOCATION_MMDB_FILES_SAMPLE=""</pre>
<pre class="programlisting"> Lite (free) databases:</pre>
<pre class="programlisting">  IP2LOCATION_DAT_FILES_LITE_FREE=""</pre>
<pre class="programlisting">  IP2LOCATION_MMDB_FILES_LITE_FREE="IPv4:1"</pre>
<pre class="programlisting"> With authentication (requires login/password or token in HOME/.ip2location) and a valid subscription</pre>
<pre class="programlisting">  IP2LOCATION_DAT_FILES_LITE=""</pre>
<pre class="programlisting">  IP2LOCATION_DAT_FILES=""</pre>
<pre class="programlisting">  IP2LOCATION_MMDB_FILES_LITE=""</pre>
<pre class="programlisting">  IP2LOCATION_MMDB_FILES=""</pre>
<pre class="programlisting"> Credentials or token must be defined in $HOME/.ip2location by</pre>
<pre class="programlisting">  login=IP2LOCATION-LOGIN       found: pb...</pre>
<pre class="programlisting">  password=IP2LOCATION-PASSWORD found: D6...</pre>
<pre class="programlisting">  token=IP2LOCATION-TOKEN       found: 2q...</pre>
<pre class="programlisting"> In addition settings from above can be overwritten by setting related variables</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1417"></a>GeoIP</h3></div></div></div>

<p>Just note that old database format (version 1) is no longer supported for free download, ipv6calc &gt;= 2.0.0 supports also MaxMindDB format, ipv6calc &gt;= 3.0.0 drops legacy download capability</p>
<pre class="programlisting">$ /usr/share/ipv6calc/tools/GeoIP-update.sh -h</pre>
<pre class="programlisting">Usage: GeoIP-update.sh [-D &lt;dir&gt;] [-v] [-R [-r]]</pre>
<pre class="programlisting">	-D &lt;dir&gt;	database directory (optional)</pre>
<pre class="programlisting">	-v		verbose</pre>
<pre class="programlisting">	-n		no action (dry-run)</pre>
<pre class="programlisting">	-R		restart services (having open but replaced database files)</pre>
<pre class="programlisting">			    requires "sudo" in case of non-root:</pre>
<pre class="programlisting">				/usr/bin/systemctl restart *</pre>
<pre class="programlisting">				/usr/bin/systemctl is-active *</pre>
<pre class="programlisting">				/usr/bin/lsof *</pre>
<pre class="programlisting">	-r		test-run for services restart</pre>
<pre class="programlisting">	database directory: /var/local/share/GeoIP (default: /usr/share/GeoIP)</pre>
<pre class="programlisting">	it honors externally defined environment value:</pre>
<pre class="programlisting">		prio 1: GEOIP_DAT_DIR</pre>
<pre class="programlisting">		prio 2: IPV6CALC_DB_GEOIP2_DIR</pre>
<pre class="programlisting"> adjust /etc/GeoIP.conf in advance:</pre>
<pre class="programlisting">   EditionIDs GeoLite2-Country GeoLite2-City GeoLite2-ASN</pre>
<pre class="programlisting">   (in case a valid license key exists, add key and extend EditionIDs related)</pre>
<pre class="programlisting">   see also https://dev.maxmind.com/geoip/geoipupdate/</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1418"></a>DB-IP.com</h3></div></div></div>

<p>Since ipv6calc &gt;= 2.0.0 supports also MaxMindDB format, so download of CSV files and converting them into BerkeleyDB format is no longer required. Since ipv6calc &gt;= 4.3.1 support for &#8220;IP to ASN lite&#8221; is available.</p>
<pre class="programlisting">$ /usr/share/ipv6calc/tools/DBIP-update.sh -h</pre>
<pre class="programlisting">INFO  : found and sourced: ./tools/ipv6calc-db-update-support.sh</pre>
<pre class="programlisting">Usage: DBIP-update.sh [-v] [-s] [-c] [-D &lt;dir&gt;] [-C &lt;days&gt;] [-U &lt;url&gt;] [-T &lt;type&gt;] [-R [-r]]</pre>
<pre class="programlisting">	-s		skip download</pre>
<pre class="programlisting">	-c		skip decompress</pre>
<pre class="programlisting">	-v		verbose</pre>
<pre class="programlisting">	-D &lt;dir&gt;	database directory (optional)</pre>
<pre class="programlisting">	-C &lt;days&gt;	cleanup files older than given days (optional)</pre>
<pre class="programlisting">	-U &lt;url&gt;	use URL to download full database</pre>
<pre class="programlisting">	-T &lt;type&gt;	set type of via URL downloaded file</pre>
<pre class="programlisting">                          MMDB: country|isp|location|*location-isp*</pre>
<pre class="programlisting">			  CSV : isp|location|*full*</pre>
<pre class="programlisting">	-R		restart services (having open but replaced database files)</pre>
<pre class="programlisting">			    requires "sudo" in case of non-root:</pre>
<pre class="programlisting">				/usr/bin/systemctl restart *</pre>
<pre class="programlisting">				/usr/bin/systemctl is-active *</pre>
<pre class="programlisting">				/usr/bin/lsof *</pre>
<pre class="programlisting">	-r		test-run for services restart</pre>
<pre class="programlisting">	database directory: /var/local/share/DBIP (default: /usr/share/DBIP)</pre>
<pre class="programlisting"> it honors externally defined environment value:</pre>
<pre class="programlisting">	prio 1: DBIP_DAT_DIR</pre>
<pre class="programlisting">	prio 2: IPV6CALC_DB_DBIP2_DIR</pre>
<pre class="programlisting"> this script will download data from</pre>
<pre class="programlisting"> DB-IP.com (default: free versions) the MaxMindDB (mmdb) files DB files for ipv6calc</pre>
<pre class="programlisting"> "DBIP" database support</pre>
<pre class="programlisting"> DBIP_DAT_URL_BASE=http://download.db-ip.com/free/</pre>
<pre class="programlisting"> DBIP_DAT_FILES=dbip-country-lite-%Y-%m.mmdb.gz dbip-city-lite-%Y-%m.mmdb.gz dbip-asn-lite-%Y-%m.mmdb.gz</pre>
<pre class="programlisting"> in case -U &lt;url&gt; (take URL from subscription e-mail) is provided, it downloads the database</pre>
<pre class="programlisting">  use -T &lt;type&gt; in case it's not "location-isp"</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1419"></a>External</h3></div></div></div>

<pre class="programlisting">$ /usr/share/ipv6calc/tools/ipv6calc-db-update.sh -h</pre>
<pre class="programlisting">Usage: ipv6calc-db-update.sh [-s] [-u] [-D &lt;dir&gt;] [-R [-r]]</pre>
<pre class="programlisting">	-s		skip download</pre>
<pre class="programlisting">	-u		unconditional update</pre>
<pre class="programlisting">	-D &lt;dir&gt;        database directory (optional)</pre>
<pre class="programlisting">	-R		restart services (having open but replaced database files)</pre>
<pre class="programlisting">			    requires "sudo" in case of non-root:</pre>
<pre class="programlisting">				/usr/bin/systemctl restart *</pre>
<pre class="programlisting">				/usr/bin/systemctl is-active *</pre>
<pre class="programlisting">				/usr/bin/lsof *</pre>
<pre class="programlisting">	-r		test-run for services restart</pre>
<pre class="programlisting">	database directory: /var/local/share/ipv6calc (default: /usr/share/ipv6calc/db)</pre>
<pre class="programlisting">	it honors externally defined environment values:</pre>
<pre class="programlisting">		prio 1: IPV6CALC_DAT_DIR</pre>
<pre class="programlisting">		prio 2: IPV6CALC_DB_EXTERNAL_DIR</pre>
<pre class="programlisting">	this script (and its helper scripts) will download data from</pre>
<pre class="programlisting">	registries and generate Berkeley DB files for ipv6calc</pre>
<pre class="programlisting">	"external" database support</pre>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id1422"></a>Perl CGI wrapper program "ipv6calcweb.cgi"</h2></div></div></div>

<p>Because calling C programs directly as CGI isn&#8217;t really recommended (too much security troubles all the time), I wrote a small wrapper utility which calls "ipv6calc" to get information about client and server address for displaying on a web page. </p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1421"></a>Examples</h3></div></div></div>

<p>A demonstration about which kind of output is possible to produce is shown at</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p><a class="ulink" href="http://ip.bieringer.net/" target="_top">http://ip.bieringer.net/</a> (IPv4/IPv6)</p>
</li><li class="listitem">
<p><a class="ulink" href="http://www.ipv6.bieringer.de/" target="_top">http://www.ipv6.bieringer.de/</a> (IPv6 only)</p>
</li><li class="listitem">
<p><a class="ulink" href="http://mirrors.bieringer.de/" target="_top">http://mirrors.bieringer.de/</a> (IPv4/IPv6)</p>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id1428"></a>Webserver log statistics helper program "ipv6logstats"</h2></div></div></div>

<p>This program parses a given webserver logfile and count addresses, useful for time period statistics.</p>
<p>Since version 0.95.0 it has extended output, adding a date/time line and statistics by Country Code and ASN (if required databases are available).</p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1423"></a>Supported options</h3></div></div></div>

<pre class="programlisting">$ ipv6logstats -h</pre>
<pre class="programlisting">ipv6logstats: version 4.3.0 STAT_REG STAT_CC STAT_AS</pre>
<pre class="programlisting">(P) &amp; (C) 2003-2025 by Peter Bieringer &lt;pb (at) bieringer.de&gt;</pre>
<pre class="programlisting"> Takes web server log data (or any other data which has IPv4/v6 address in first column)</pre>
<pre class="programlisting">   from stdin and print statistics table/list (depending on option) to stdout</pre>
<pre class="programlisting">  [-d|--debug &lt;debug value&gt;] : debug value (bitwise like)</pre>
<pre class="programlisting">                                can also be set by IPV6CALC_DEBUG environment value</pre>
<pre class="programlisting">  [-v|--version [-v [-v]]]   : version information (2 optional detail levels)</pre>
<pre class="programlisting">  [-v|--version -h]          : explanation of feature tokens</pre>
<pre class="programlisting">  [-V|--verbose]             : be more verbose</pre>
<pre class="programlisting">  [-h|--help|-?]             : this online help</pre>
<pre class="programlisting">  [-q|--quiet]               : be more quiet</pre>
<pre class="programlisting">  [--disable-ip2location           ] : IP2Location(BIN) support disabled</pre>
<pre class="programlisting">  [--db-ip2location-disable        ] : IP2Location(BIN) support disabled</pre>
<pre class="programlisting">  [--db-ip2location-dir &lt;directory&gt;] : IP2Location(BIN) database directory (default: /var/local/share/IP2Location)</pre>
<pre class="programlisting">  [--db-ip2location-only-type &lt;TYPE&gt;]: IP2Location(BIN) database only selected type (1-666)</pre>
<pre class="programlisting">  [--db-ip2location-allow-softlinks] : IP2Location(BIN) database softlinks allowed</pre>
<pre class="programlisting">     by default they are ignored because it is hard to autodetect COMM/LITE/SAMPLE</pre>
<pre class="programlisting">  [--db-ip2location-lite-to-sample-autoswitch-max-delta-months &lt;MONTHS&gt;]:</pre>
<pre class="programlisting">     autoswitch from LITE to SAMPLE databases if possible and delta is not more than 12 months (0=disabled)</pre>
<pre class="programlisting">  [--db-ip2location-comm-to-lite-switch-min-delta-months &lt;MONTHS&gt;]:</pre>
<pre class="programlisting">     switch from COMM to LITE databases if possible and delta more than 12 months (0=disabled)</pre>
<pre class="programlisting">  [--disable-ip2location2           ] : IP2Location(MMDB) support disabled</pre>
<pre class="programlisting">  [--db-ip2location2-disable        ] : IP2Location(MMDB) support disabled</pre>
<pre class="programlisting">  [--db-ip2location2-dir &lt;directory&gt;] : IP2Location(MMDB) database directory (default: /var/local/share/IP2Location)</pre>
<pre class="programlisting">  [--db-ip2location2-only-type &lt;TYPE&gt;]: IP2Location(MMDB) database only selected type (1-666)</pre>
<pre class="programlisting">  [--db-ip2location2-allow-softlinks] : IP2Location(MMDB) database softlinks allowed</pre>
<pre class="programlisting">     by default they are ignored because it is hard to autodetect COMM/LITE/SAMPLE</pre>
<pre class="programlisting">  [--db-ip2location2-lite-to-sample-autoswitch-max-delta-months &lt;MONTHS&gt;]:</pre>
<pre class="programlisting">     autoswitch from LITE to SAMPLE databases if possible and delta is not more than 12 months (0=disabled)</pre>
<pre class="programlisting">  [--db-ip2location-comm-to-lite-switch-min-delta-months &lt;MONTHS&gt;]:</pre>
<pre class="programlisting">     switch from COMM to LITE databases if possible and delta more than 12 months (0=disabled)</pre>
<pre class="programlisting">  [--disable-geoip2                ] : GeoIP(MaxMindDB) support disabled</pre>
<pre class="programlisting">  [--db-geoip2-disable             ] : GeoIP(MaxMindDB) support disabled</pre>
<pre class="programlisting">  [--db-geoip2-dir      &lt;directory&gt;] : GeoIP(MaxMindDB) database directory (default: /var/local/share/GeoIP)</pre>
<pre class="programlisting">  [--disable-dbip2                 ] : db-ip.com(MaxMindDB) support disabled</pre>
<pre class="programlisting">  [--db-dbip2-disable              ] : db-ip.com(MaxMindDB) support disabled</pre>
<pre class="programlisting">  [--db-dbip2-dir       &lt;directory&gt;] : db-ip.com(MaxMindDB) database directory (default: /var/local/share/DBIP)</pre>
<pre class="programlisting">  [--db-dbip2-only-type &lt;TYPE&gt;]      : db-ip.com(MaxMindDB) database only selected type (1-6)</pre>
<pre class="programlisting">  [--db-dbip2-comm-to-free-switch-min-delta-months &lt;MONTHS&gt;]:</pre>
<pre class="programlisting">     switch from COMM to FREE databases if possible and delta more than 12 months (0=disabled)</pre>
<pre class="programlisting">  [--disable-external              ] : External support disabled</pre>
<pre class="programlisting">  [--db-external-disable           ] : External support disabled</pre>
<pre class="programlisting">  [--db-external-dir    &lt;directory&gt;] : External database directory (default: /var/local/share/ipv6calc)</pre>
<pre class="programlisting">  [--disable-builtin               ] : BuiltIn support disabled</pre>
<pre class="programlisting">  [--db-builtin-disable            ] : BuiltIn support disabled</pre>
<pre class="programlisting">  [--db-priorization &lt;entry1&gt;[:...]] : Database priorization order list (overwrites default)</pre>
<pre class="programlisting">                                         colon separated: GeoIP2 IP2Location DBIP2 External BuiltIn IP2Location2</pre>
<pre class="programlisting"> Hint: all long options can be predefined from environment by using</pre>
<pre class="programlisting">  prefix: IPV6CALC_ and  conversion: '-' -&gt; '_' and lowercase -&gt; uppercase</pre>
<pre class="programlisting">  example for options with values   : --db-dbip2-dir=&lt;DIR&gt;  -&gt;  environment: IPV6CALC_DB_DBIP2_DIR=&lt;DIR&gt;</pre>
<pre class="programlisting">  example for options without values: --db-dbip2-disable    -&gt;  environment: IPV6CALC_DB_DBIP2_DISABLE=1</pre>
<pre class="programlisting">                                                                              on|off|0|1 is supported</pre>
<pre class="programlisting">  [-u|--unknown]             : print unknown IP addresses to stderr</pre>
<pre class="programlisting">  [-c|--columns]             : print statistics in columns (1)</pre>
<pre class="programlisting">  [-N|--column-numbers]      : print column numbers</pre>
<pre class="programlisting">  [-n|--noheader]            : don't print header in columns mode (1)</pre>
<pre class="programlisting">  [-o|--onlyheader]          : print only header in columns mode (1)</pre>
<pre class="programlisting">  [-p|--prefix &lt;token&gt;]      : print token as prefix (1)</pre>
<pre class="programlisting">  [-s|--simple]              : disable extended statistic (CountryCode/ASN)</pre>
<pre class="programlisting"> (1) unsupported for CountryCode &amp; ASN statistics</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1426"></a>Usage</h3></div></div></div>

<p>There are a README and some helper scripts available in the package how to use this program and how to generate a graph using Gnuplot.</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1424"></a>Line-by-line output</h4></div></div></div>

<p>The example shows output version 4.0, which </p>
<pre class="programlisting">$ cat ip.bieringer.de-log.202401 | ipv6logstats</pre>
<p>Header section, since output version 3.0 (&gt;= 0.95.0) additional lines starting with &#8217;*3*&#8217; and &#8217;*DateTime&#8217; and &#8217;*UnixTime&#8217; included</p>
<pre class="programlisting">*Version             4.0</pre>
<pre class="programlisting">*DateTime: 2024:01:21 08:07:59+0000 GMT</pre>
<pre class="programlisting">*UnixTime: 1705824479</pre>
<pre class="programlisting">*3*DB-Info: DB features: 0xff1fffff</pre>
<pre class="programlisting">*3*DB-Info: GeoIP(MaxMindDB): features available/implemented: 0x03063ff0/0x03063ff0</pre>
<pre class="programlisting">*3*DB-Info: GeoIP2: info of available databases in directory: /var/local/share/GeoIP</pre>
<pre class="programlisting">*3*DB-Info: GeoIP2: IPv4/v6 CountryCode (FREE)    : [1] GeoLite2-Country.mmdb          (GeoLite2-Country Copyright (c) 2024 MaxMind All Rights Reserved, created: 20240112-201408 UTC)</pre>
<pre class="programlisting">*3*DB-Info: GeoIP2: IPv4/v6 City (FREE)           : [2] GeoLite2-City.mmdb             (GeoLite2-City Copyright (c) 2024 MaxMind All Rights Reserved, created: 20240112-195220 UTC)</pre>
<pre class="programlisting">*3*DB-Info: GeoIP2: IPv4/v6 ASN (FREE)            : [3] GeoLite2-ASN.mmdb              (GeoLite2-ASN Copyright (c) 2024 MaxMind All Rights Reserved, created: 20240112-193300 UTC)</pre>
<pre class="programlisting">*3*DB-Info: IP2Location: features available/implemented: 0x0c003fc0/0x0c003ff0</pre>
<pre class="programlisting">*3*DB-Info: IP2Location: info of available databases in directory: /var/local/share/IP2Location</pre>
<pre class="programlisting">*3*DB-Info: IP2Location: Copyright (c) IP2Location All Rights Reserved</pre>
<pre class="programlisting">*3*DB-Info: IP2Location: IPv4 Co/Re/Ci/LaLo/ZI/TZ/IS/Do/Ne/Ar/We/Mo      :[220] IP-COUNTRY-REGION-CITY-LATITUDE-LONGITUDE-ZIPCODE-TIMEZONE-ISP-DOMAIN-NETSPEED-AREACODE-WEATHER-MOBILE-SAMPLE.BIN (IP2L-DB20 IPv4 IPv6 SAMPLE 20240101)</pre>
<pre class="programlisting">*3*DB-Info: IP2Location: IPv4 Co/Re/Ci/LaLo/ZI/TZ/IS/Do/Ne/Ar/We/Mo/El/Us:[224] IP-COUNTRY-REGION-CITY-LATITUDE-LONGITUDE-ZIPCODE-TIMEZONE-ISP-DOMAIN-NETSPEED-AREACODE-WEATHER-MOBILE-ELEVATION-USAGETYPE-SAMPLE.BIN (IP2L-DB24 IPv4 IPv6 SAMPLE 20240101)</pre>
<pre class="programlisting">*3*DB-Info: IP2Location: IPv6 Co/Re/Ci/LaLo/ZI/TZ/IS/Do/Ne/Ar/We/Mo      :[320] IPV6-COUNTRY-REGION-CITY-LATITUDE-LONGITUDE-ZIPCODE-TIMEZONE-ISP-DOMAIN-NETSPEED-AREACODE-WEATHER-MOBILE.SAMPLE.BIN (IP2L-DB20 IPv4 IPv6 SAMPLE 20240101)</pre>
<pre class="programlisting">*3*DB-Info: IP2Location: IPv6 Co/Re/Ci/LaLo/ZI/TZ/IS/Do/Ne/Ar/We/Mo/El/Us:[324] IPV6-COUNTRY-REGION-CITY-LATITUDE-LONGITUDE-ZIPCODE-TIMEZONE-ISP-DOMAIN-NETSPEED-AREACODE-WEATHER-MOBILE-ELEVATION-USAGETYPE.SAMPLE.BIN (IP2L-DB24 IPv4 IPv6 SAMPLE 20240101)</pre>
<pre class="programlisting">*3*DB-Info: IP2Location: IPv4 Country                                    :[401] IP2LOCATION-LITE-DB1.BIN            (IP2L-DB1 IPv4 IPv6 LITE 20231215)</pre>
<pre class="programlisting">*3*DB-Info: IP2Location: IPv4 Co/Re/Ci/LattLong/ZIP/TZ                   :[411] IP2LOCATION-LITE-DB11.BIN           (IP2L-DB11 IPv4 IPv6 LITE 20231215)</pre>
<pre class="programlisting">*3*DB-Info: IP2Location: IPvx Country                                    :[501] IP2LOCATION-LITE-DB1.IPV6.BIN       (IP2L-DB1 IPv4 IPv6 LITE 20231215)</pre>
<pre class="programlisting">*3*DB-Info: IP2Location: IPvx Co/Re/Ci/LattLong/ZIP/TZ                   :[511] IP2LOCATION-LITE-DB11.IPV6.BIN      (IP2L-DB11 IPv4 IPv6 LITE 20231215)</pre>
<pre class="programlisting">*3*DB-Info: IP2Location: IPvx Co/Re/Ci/LattLong/ZIP/TZ                   :[111] IPV6-COUNTRY-REGION-CITY-LATITUDE-LONGITUDE-ZIPCODE-TIMEZONE.BIN (IP2L-DB11 IPv4 IPv6 20231215)</pre>
<pre class="programlisting">*3*DB-Info: db-ip.com(MaxMindDB): features available/implemented: 0x30063ff0/0x30063ff0</pre>
<pre class="programlisting">*3*DB-Info: DBIP2: info of available databases in directory: /var/local/share/DBIP</pre>
<pre class="programlisting">*3*DB-Info: DBIP2: IPv4/v6 CountryCode (FREE)    : [1] dbip-country-lite.mmdb         (DBIP-Country-Lite Copyright (c) 2024 db-ip.com All Rights Reserved, created: 20240101-231423 UTC)</pre>
<pre class="programlisting">*3*DB-Info: DBIP2: IPv4/v6 City (FREE)           : [2] dbip-city-lite.mmdb            (DBIP-City-Lite Copyright (c) 2024 db-ip.com All Rights Reserved, created: 20240101-231818 UTC)</pre>
<pre class="programlisting">*3*DB-Info: DBIP2: IPv4/v6 Location+ISP (COMM)   : [6] dbip-location-isp.mmdb         (DBIP-Location-ISP (compat=Enterprise) Copyright (c) 2024 db-ip.com All Rights Reserved, created: 20240102-010801 UTC)</pre>
<pre class="programlisting">*3*DB-Info: External: features available/implemented: 0xc01980cc/0xc01980cc</pre>
<pre class="programlisting">*3*DB-Info: External: info of available databases in directory: /var/local/share/ipv6calc</pre>
<pre class="programlisting">*3*DB-Info: External: IPv4 Registry       : ipv6calc-external-ipv4-registry.db       (EXTDB-1/AFRINIC/20240107 APNIC/20240106 ARIN/20240107 IANA/20231218 LACNIC/20240105 LISP/20200318 RIPENCC/20240106, created: 20240107-161126 UTC)</pre>
<pre class="programlisting">*3*DB-Info: External: IPv6 Registry       : ipv6calc-external-ipv6-registry.db       (EXTDB-2/AFRINIC/20240107 APNIC/20240106 ARIN/20240107 IANA/20191106 LACNIC/20240105 LISP/20200318 RIPENCC/20240106, created: 20240107-162146 UTC)</pre>
<pre class="programlisting">*3*DB-Info: External: IPv4 CountryCode    : ipv6calc-external-ipv4-countrycode.db    (EXTDB-3/AFRINIC/20240107 APNIC/20240106 ARIN/20240107 IANA/20231218 LACNIC/20240105 LISP/20200318 RIPENCC/20240106, created: 20240107-161126 UTC)</pre>
<pre class="programlisting">*3*DB-Info: External: IPv6 CountryCode    : ipv6calc-external-ipv6-countrycode.db    (EXTDB-4/AFRINIC/20240107 APNIC/20240106 ARIN/20240107 IANA/20191106 LACNIC/20240105 LISP/20200318 RIPENCC/20240106, created: 20240107-162146 UTC)</pre>
<pre class="programlisting">*3*DB-Info: BuiltIn: features available/implemented: 0x0001c00f/0x0001c00f</pre>
<pre class="programlisting">*3*DB-Info: BuiltIn: info of available databases</pre>
<pre class="programlisting">*3*DB-Info: BuiltIn: ASN  : IANA/20230810</pre>
<pre class="programlisting">*3*DB-Info: BuiltIn: CC   : AFRINIC/20240119 APNIC/20240119 ARIN/20240119 LACNIC/20240119 RIPENCC/20240119</pre>
<pre class="programlisting">*3*DB-Info: BuiltIn: IPv4 : AFRINIC/20240119 APNIC/20240119 ARIN/20240119 IANA/20231218 LACNIC/20240119 LISP/20200318 RIPENCC/20240119 (created: 20240120-044633 UTC)</pre>
<pre class="programlisting">*3*DB-Info: BuiltIn: IPv6 : AFRINIC/20240119 APNIC/20240119 ARIN/20240119 IANA/20191106 LACNIC/20240119 LISP/20200318 RIPENCC/20240119 (created: 20240120-050328 UTC)</pre>
<pre class="programlisting">*3*DB-Info: BuiltIn: IEEE : IAB/20240120 OUI/20240120 OUI28/20240120 OUI36/20240120</pre>
<pre class="programlisting">*3*DB-Info: Database selection or priorization ('-&gt;': subsequential calls)</pre>
<pre class="programlisting">*3*DB-Info: Database priorization default: GeoIP(MaxMindDB)-&gt;IP2Location-&gt;db-ip.com(MaxMindDB)-&gt;GeoIP-&gt;db-ip.com-&gt;External-&gt;BuiltIn</pre>
<pre class="programlisting">*3*DB-Info: DB_AS_REG (AS-Number to Registry database): BuiltIn</pre>
<pre class="programlisting">*3*DB-Info: DB_CC_REG (CountryCode to Registry database): BuiltIn</pre>
<pre class="programlisting">*3*DB-Info: DB_IPV4_REG (IPv4 to Registry database): BuiltIn</pre>
<pre class="programlisting">*3*DB-Info: DB_IPV6_REG (IPv6 to Registry database): BuiltIn</pre>
<pre class="programlisting">*3*DB-Info: DB_IPV4_AS (IPv4 to AS database): GeoIP(MaxMindDB)-&gt;db-ip.com(MaxMindDB)</pre>
<pre class="programlisting">*3*DB-Info: DB_IPV6_AS (IPv6 to AS database): GeoIP(MaxMindDB)-&gt;db-ip.com(MaxMindDB)</pre>
<pre class="programlisting">*3*DB-Info: DB_IPV4_CC (IPv4 to CountryCode database): GeoIP(MaxMindDB)-&gt;IP2Location-&gt;db-ip.com(MaxMindDB)-&gt;External</pre>
<pre class="programlisting">*3*DB-Info: DB_IPV6_CC (IPv6 to CountryCode database): GeoIP(MaxMindDB)-&gt;IP2Location-&gt;db-ip.com(MaxMindDB)-&gt;External</pre>
<pre class="programlisting">*3*DB-Info: DB_IPV4_COUNTRY (IPv4 to Country database): GeoIP(MaxMindDB)-&gt;IP2Location-&gt;db-ip.com(MaxMindDB)</pre>
<pre class="programlisting">*3*DB-Info: DB_IPV6_COUNTRY (IPv6 to Country database): GeoIP(MaxMindDB)-&gt;IP2Location-&gt;db-ip.com(MaxMindDB)</pre>
<pre class="programlisting">*3*DB-Info: DB_IPV4_CITY (IPv4 to City database): GeoIP(MaxMindDB)-&gt;IP2Location-&gt;db-ip.com(MaxMindDB)</pre>
<pre class="programlisting">*3*DB-Info: DB_IPV6_CITY (IPv6 to City database): GeoIP(MaxMindDB)-&gt;IP2Location-&gt;db-ip.com(MaxMindDB)</pre>
<pre class="programlisting">*3*DB-Info: DB_IPV4_REGION (IPv4 to Region database): GeoIP(MaxMindDB)-&gt;IP2Location-&gt;db-ip.com(MaxMindDB)</pre>
<pre class="programlisting">*3*DB-Info: DB_IPV6_REGION (IPv6 to Region database): GeoIP(MaxMindDB)-&gt;IP2Location-&gt;db-ip.com(MaxMindDB)</pre>
<pre class="programlisting">*3*DB-Info: DB_IEEE (IEEE/OUI/OUI28/OUI36 Vendor database): BuiltIn</pre>
<pre class="programlisting">*3*DB-Info: DB_IPV4_INFO (IPv4 additional information): External-&gt;BuiltIn</pre>
<pre class="programlisting">*3*DB-Info: DB_IPV6_INFO (IPv6 additional information): External-&gt;BuiltIn</pre>
<pre class="programlisting">*3*DB-Info: DB_IPV4_GEONAMEID (IPv4 GeonameID): GeoIP(MaxMindDB)-&gt;db-ip.com(MaxMindDB)</pre>
<pre class="programlisting">*3*DB-Info: DB_IPV6_GEONAMEID (IPv6 GeonameID): GeoIP(MaxMindDB)-&gt;db-ip.com(MaxMindDB)</pre>
<pre class="programlisting">*3*DB-Info: DB_IPV4_DUMP_CC (IPv4 Database Dump by CountryCode): External</pre>
<pre class="programlisting">*3*DB-Info: DB_IPV6_DUMP_CC (IPv6 Database Dump by CountryCode): External</pre>
<p>Simple statistics section</p>
<pre class="programlisting">ALL                  68612</pre>
<pre class="programlisting">IPv4                 57311</pre>
<pre class="programlisting">IPv6                 11301</pre>
<pre class="programlisting">UNKNOWN              0</pre>
<pre class="programlisting">IPv4/APNIC           4154</pre>
<pre class="programlisting">IPv4/ARIN            27873</pre>
<pre class="programlisting">IPv4/RIPE            24889</pre>
<pre class="programlisting">IPv4/LACNIC          305</pre>
<pre class="programlisting">IPv4/AFRINIC         90</pre>
<pre class="programlisting">IPv4/UNKNOWN         0</pre>
<pre class="programlisting">IPv6/6bone           0</pre>
<pre class="programlisting">IPv6/IANA            0</pre>
<pre class="programlisting">IPv6/APNIC           506</pre>
<pre class="programlisting">IPv6/ARIN            1475</pre>
<pre class="programlisting">IPv6/RIPE            9103</pre>
<pre class="programlisting">IPv6/LACNIC          216</pre>
<pre class="programlisting">IPv6/AFRINIC         0</pre>
<pre class="programlisting">IPv6/RESERVED        0</pre>
<pre class="programlisting">IPv6/UNKNOWN         0</pre>
<pre class="programlisting">IPv6/6to4/IANA       0</pre>
<pre class="programlisting">IPv6/6to4/APNIC      0</pre>
<pre class="programlisting">IPv6/6to4/ARIN       0</pre>
<pre class="programlisting">IPv6/6to4/RIPE       1</pre>
<pre class="programlisting">IPv6/6to4/LACNIC     0</pre>
<pre class="programlisting">IPv6/6to4/AFRINIC    0</pre>
<pre class="programlisting">IPv6/6to4/RESERVED   0</pre>
<pre class="programlisting">IPv6/6to4/UNKNOWN    0</pre>
<pre class="programlisting">IPv6/Teredo/IANA     0</pre>
<pre class="programlisting">IPv6/Teredo/APNIC    0</pre>
<pre class="programlisting">IPv6/Teredo/ARIN     0</pre>
<pre class="programlisting">IPv6/Teredo/RIPE     0</pre>
<pre class="programlisting">IPv6/Teredo/LACNIC   0</pre>
<pre class="programlisting">IPv6/Teredo/AFRINIC  0</pre>
<pre class="programlisting">IPv6/Teredo/RESERVED 0</pre>
<pre class="programlisting">IPv6/Teredo/UNKNOWN  0</pre>
<pre class="programlisting">IPv6/NAT64/IANA      0</pre>
<pre class="programlisting">IPv6/NAT64/APNIC     0</pre>
<pre class="programlisting">IPv6/NAT64/ARIN      0</pre>
<pre class="programlisting">IPv6/NAT64/RIPE      0</pre>
<pre class="programlisting">IPv6/NAT64/LACNIC    0</pre>
<pre class="programlisting">IPv6/NAT64/AFRINIC   0</pre>
<pre class="programlisting">IPv6/NAT64/RESERVED  0</pre>
<pre class="programlisting">IPv6/NAT64/UNKNOWN   0</pre>
<pre class="programlisting">IPv6/IID/Global      2581</pre>
<pre class="programlisting">IPv6/IID/Random      6880</pre>
<pre class="programlisting">IPv6/IID/Manual      1839</pre>
<pre class="programlisting">IPv6/IID/ISATAP      0</pre>
<pre class="programlisting">IPv6/IID/Unknown     0</pre>
<p>External database supported output since output version 3.0 (&gt;= 0.95.0)</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>Country Code / Proto</p>
</li></ul></div>
<pre class="programlisting">...</pre>
<pre class="programlisting">*3*CC-code-proto/DE/ALL   9126</pre>
<pre class="programlisting">*3*CC-code-proto/DE/IPv4  5381</pre>
<pre class="programlisting">*3*CC-code-proto/DE/IPv6  3745</pre>
<pre class="programlisting">*3*CC-code-proto-list/DE  9126 5381 3745</pre>
<pre class="programlisting">...</pre>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>Proto / Country Code (&#8220;ALL&#8221; line contains: ALL IPv4 IPv6)</p>
</li></ul></div>
<pre class="programlisting">...</pre>
<pre class="programlisting">*3*CC-proto-code/ALL/DE   96450</pre>
<pre class="programlisting">*3*CC-proto-code/IPv4/DE  36486</pre>
<pre class="programlisting">*3*CC-proto-code/IPv6/DE  59964</pre>
<pre class="programlisting">...</pre>
<pre class="programlisting">*3*CC-proto-code-list/ALL  108525 46483 62042</pre>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>Autonomous System number / Proto</p>
</li></ul></div>
<pre class="programlisting">...</pre>
<pre class="programlisting">*3*AS-num-proto/8767/ALL   6054</pre>
<pre class="programlisting">*3*AS-num-proto/8767/IPv4  2705</pre>
<pre class="programlisting">*3*AS-num-proto/8767/IPv6  3349</pre>
<pre class="programlisting">*3*AS-num-proto-list/8767  6054 2705 3349</pre>
<pre class="programlisting">...</pre>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>Proto / Autonomous System number (&#8220;ALL&#8221; line contains: ALL IPv4 IPv6)</p>
</li></ul></div>
<pre class="programlisting">...</pre>
<pre class="programlisting">*3*AS-proto-num/ALL/8767   6054</pre>
<pre class="programlisting">*3*AS-proto-num/IPv4/8767  2705</pre>
<pre class="programlisting">*3*AS-proto-num/IPv6/8767  3349</pre>
<pre class="programlisting">...</pre>
<pre class="programlisting">*3*AS-proto-num-list/ALL  108525 46483 62042</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1425"></a>Column output</h4></div></div></div>

<p>Column output does not support version 3 extension, only simple statistics with a header line:</p>
<pre class="programlisting">$ zcat ip.bieringer.de-log.201*.gz | ipv6logstats -q -c </pre>
<pre class="programlisting"> IPv4 IPv6 UNKNOWN IPv4/APNIC IPv4/ARIN IPv4/RIPE IPv4/LACNIC IPv4/UNKNOWN IPv6/6bone IPv6/IANA IPv6/APNIC IPv6/ARIN IPv6/RIPE IPv6/LACNIC IPv6/RESERVED IPv6/UNKNOWN IPv6/6to4/IANA IPv6/6to4/APNIC IPv6/6to4/ARIN IPv6/6to4/RIPE IPv6/6to4/LACNIC IPv6/6to4/RESERVED IPv6/6to4/UNKNOWN IPv6/Teredo/IANA IPv6/Teredo/APNIC IPv6/Teredo/ARIN IPv6/Teredo/RIPE IPv6/Teredo/LACNIC IPv6/Teredo/RESERVED IPv6/Teredo/UNKNOWN IPv6/NAT64/IANA IPv6/NAT64/APNIC IPv6/NAT64/ARIN IPv6/NAT64/RIPE IPv6/NAT64/LACNIC IPv6/NAT64/RESERVED IPv6/NAT64/UNKNOWN IPv6/IID/Global IPv6/IID/Random IPv6/IID/Manual IPv6/IID/ISATAP IPv6/IID/Unknown</pre>
<pre class="programlisting"> 46233 62292 0 2397 3525 40198 97 16 0 0 129 839 61074 0 0 0 0 0 16 51 0 0 0 0 63 0 90 30 0 0 0 0 0 0 0 0 0 1436 58198 2055 353 0</pre>
<p>An optional prefix token can be given (&#8220;-p &lt;prefix&gt;&#8221;) to create e.g. in a for-loop one line per month and put month in front of statistics, also the header line can be suppressed (&#8220;-n&#8221;).</p>
<pre class="programlisting">$ zcat ip.bieringer.de-log.201*.gz | ipv6logstats -q -c -n -p ALL</pre>
<pre class="programlisting">ALL  46233 62292 0 2397 3525 40198 97 16 0 0 129 839 61074 0 0 0 0 0 16 51 0 0 0 0 63 0 90 30 0 0 0 0 0 0 0 0 0 1436 58198 2055 353 0 </pre>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1427"></a>Examples</h3></div></div></div>

<p>A demonstration with real data is available at <a class="ulink" href="http://mirrors.bieringer.de/stats/timeline.html" target="_top">http://mirrors.bieringer.de/stats/timeline.html</a>.</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id1433"></a>Apache web server module &#8220;mod_ipv6calc&#8221;</h2></div></div></div>

<p>This Apache web server module (since version 0.99.1, released 2015) interfaces with internal ipv6calc library to support</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>Client IP address anonymization &#8220;on-the-fly&#8221;, exported to IPV6CALC_CLIENT_IP_ANON
</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<p>depending on the configured anonymization method 3rd party database is required</p>
</li></ul></div>
</li><li class="listitem">
<p>Country code of client IP address, exported to IPV6CALC_CLIENT_COUNTRYCODE
</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<p>requires 3rd party database: GeoIP or IP2Location or DB-IP.com</p>
</li></ul></div>
</li><li class="listitem">
<p>Autonomous System Number (ASN) of client IP address, exported to IPV6CALC_CLIENT_ASN
</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<p>requires 3rd party database: GeoIP</p>
</li></ul></div>
</li><li class="listitem">
<p>Registry of client IP address, exported to IPV6CALC_CLIENT_REGISTRY
</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<p>requires internal or &#8220;external&#8221; database</p>
</li></ul></div>
</li><li class="listitem">
<p>Configured IP address anonymization method, exported to IPV6CALC_ANON_METHOD</p>
</li></ul></div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1429"></a>Installation</h3></div></div></div>

<p>Install compiled Apache module &#8220;mod_ipv6calc&#8221; to Apache&#8217;s module directory</p>
<p>Install included default configuration file &#8220;ipv6calc.conf&#8221; to Apache&#8217;s config directory (usually conf.d)</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1430"></a>Configuration</h3></div></div></div>

<p>Enable in &#8220;ipv6calc.conf&#8221; loading of module</p>
<pre class="programlisting">LoadModule ipv6calc_module modules/mod_ipv6calc.so</pre>
<p>Enable module itself </p>
<pre class="programlisting">ipv6calcEnable                         on</pre>
<p>Adjust configuration settings, if needed (see examples in &#8220;ipv6calc.conf&#8221;)</p>
<p>Review predefined log format</p>
<pre class="programlisting">LogFormat "%{IPV6CALC_CLIENT_IP_ANON}e \"%{IPV6CALC_CLIENT_COUNTRYCODE}e/%{IPV6CALC_CLIENT_ASN}e/%{IPV6CALC_CLIENT_REGISTRY}e/%{IPV6CALC_ANON_METHOD}e\" %u %t \"%r\" %&gt;s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined_anon</pre>
<p>Enable custom log with anonymized information, using the predefined LogFormat</p>
<pre class="programlisting">CustomLog logs/access_anon_log combined_anon</pre>
<p>Restart Apache web server, check error_log for any issues</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1431"></a>Result</h3></div></div></div>

<p>The new log file contains anonymized requests like</p>
<pre class="programlisting">252.176.92.172 "CN/23724/APNIC/keep-type-asn-cc" - [25/Jul/2015:13:20:25 +0200] "GET / HTTP/1.1" 200 3569 "-" "Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)"</pre>
<pre class="programlisting">a909:390a:909a:81d9:a909:4291:c02d:5d1d "CZ/43037/RIPENCC/keep-type-asn-cc" - [25/Jul/2015:12:59:00 +0200] "GET /robots.txt HTTP/1.1" 200 33 "-" "Mozilla/5.0 (compatible; SeznamBot/3.2; +http://fulltext.sblog.cz/)" </pre>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1432"></a>Post-analysis in case of anonymization method &#8220;keep-type-asn-cc&#8221;</h3></div></div></div>

<p>In case &#8220;keep-type-asn-cc&#8221; is configured and also working (required databases are available), related information of anonymized IP addresses can be retrieved using &#8220;ipv6calc&#8221; or &#8220;ipv6logstats&#8221;.</p>
<pre class="programlisting">$ ipv6calc -q -m -i 252.176.92.172</pre>
<pre class="programlisting">IPV4=252.176.92.172</pre>
<pre class="programlisting">IPV4_TYPE=unicast,anonymized,global</pre>
<pre class="programlisting">IPV4_AS_NUM=23724</pre>
<pre class="programlisting">IPV4_COUNTRYCODE=CN</pre>
<pre class="programlisting">IPV4_REGISTRY=APNIC </pre>
<pre class="programlisting">...</pre>
<pre class="programlisting">$ ipv6calc -q -m -i a909:390a:909a:81d9:a909:4291:c02d:5d1d</pre>
<pre class="programlisting">IPV6=a909:390a:909a:81d9:a909:4291:c02d:5d1d</pre>
<pre class="programlisting">IPV6_TYPE=unicast,anonymized-iid,anonymized-prefix,global-unicast,productive,iid,iid-local</pre>
<pre class="programlisting">IPV6_COUNTRYCODE=CZ</pre>
<pre class="programlisting">IPV6_AS_NUM=43037</pre>
<pre class="programlisting">IPV6_REGISTRY=RIPENCC</pre>
<pre class="programlisting">...</pre>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id1447"></a>History</h2></div></div></div>

<p>Major extensions/changes are listed here</p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1434"></a>2025</h3></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>add support for MaxMindDB (IP2Location) (&gt;= 4.3.0)</p>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1435"></a>2023</h3></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>add support for using MD5 from libmd (&gt;= 4.2.0)</p>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1436"></a>2021</h3></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>add support for compressed IPv4 addresses like 10/8 (&gt;= 3.1.0)</p>
</li><li class="listitem">
<p>add support for octal representation of IPv4 addresses (&gt;= 3.3.0)</p>
</li><li class="listitem">
<p>add Database Dump action (&gt;= 3.3.0)</p>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1437"></a>2020</h3></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>drop GeoIP(legacy) support (&gt;= 3.0.0)</p>
</li><li class="listitem">
<p>drop db-ip.com(BerkeleyDB) support (&gt;= 3.0.0)</p>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1438"></a>2019</h3></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>add OUI-28 support (&gt;= 2.2.0)</p>
</li><li class="listitem">
<p>add action &#8220;addr2cc&#8221; (can be used as replacement for geoiplookup) (&gt;= 2.1.0)</p>
</li><li class="listitem">
<p>enable &#8220;geonameid&#8221; also in mod_ipv6calc (&gt;= 2.1.0)</p>
</li><li class="listitem">
<p>add anonymization method &#8220;keep-type-geonameid&#8221; (&gt;= 2.1.0)</p>
</li><li class="listitem">
<p>add support for MaxMindDB (GeoIP, db-ip.com) (&gt;= 2.0.0)</p>
</li><li class="listitem">
<p>drop support of IP2Location libraries &lt; 7.0.1 (&gt;= 2.0.0)</p>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1439"></a>2017</h3></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>add support for LISP detection</p>
</li><li class="listitem">
<p>add support for non-free versions <a class="ulink" href="http://www.db-ip.com/" target="_top">DB-IP.com</a> databases</p>
</li><li class="listitem">
<p>finally release 1.0.0 after 16 year of development</p>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1440"></a>2016</h3></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>implement action &#8217;test&#8217; and extend action &#8217;filter&#8217; with support of address ranges (&gt;= 0.99.2)</p>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1441"></a>2015</h3></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>Introduce mod_ipv6calc for Apache web server (&gt;= 0.99.1)</p>
</li><li class="listitem">
<p>Add support for <a class="ulink" href="http://www.db-ip.com/" target="_top">DB-IP.com</a> databases (by generated Berkeley DB files) (&gt;= 0.98.0)</p>
</li><li class="listitem">
<p>Add support for &#8220;External&#8221; database files (generated Berkeley DB files), superseeding (if newer) built-in IPv4/IPv6-&gt;Registry and adding IPv4/IPv6-&gt;CountryCode support (&gt;= 0.98.0)</p>
</li><li class="listitem">
<p>Extend filter options with support of CountryCode, ASN or Registry (&gt;= 0.99.0)</p>
</li><li class="listitem">
<p>Add support for <a class="ulink" href="http://lite.ip2location.com/" target="_top">IP2Location LITE</a> databases (&gt;= 0.99.0), add configurable IP2Location database autoselection support</p>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1442"></a>2014</h3></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>Shared library mode supported (reduces size of binaries)</p>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1443"></a>2013</h3></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>Prefix and IID anonymization methods</p>
</li><li class="listitem">
<p>Support of dynamic load of GeoIP and IP2Location libraries</p>
</li><li class="listitem">
<p>Specifying dedicated GeoIP and IP2Location database files is now replaced by specifying dedicated database directories to make especially for GeoIP use of more database files.</p>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1444"></a>2011</h3></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>ipv6calc/ipv6calcweb.cgi: enable included GeoIP support with IPv6 (usable with GeoIP &gt;= 1.4.5)</p>
</li><li class="listitem">
<p>ipv6calc: extend for 6rd support (--action 6rd_local_prefix --6rd_prefix &lt;PREFIX&gt; --6rd_relay_prefix &lt;RELAY_PREFIX&gt;)</p>
</li><li class="listitem">
<p>ipv6calc: enable stdin support for bulk transformation</p>
</li><li class="listitem">
<p>ipv6calc: add support for NAT64 address type</p>
</li><li class="listitem">
<p>ipv6calc: add option &#8220;forceprefix &lt;LENGTH&gt;&#8221; to print prefix of an address without a given prefix length</p>
</li><li class="listitem">
<p>ipv6loganon: extend for pipe usage (e.g. in Apache log file directive) and write/append to specified file</p>
</li><li class="listitem">
<p>General: add configure options to disable built-in databases (reduce binary size a lot, e.g. for embedded devices)</p>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1445"></a>2002-2010</h3></div></div></div>

<p>See <a class="ulink" href="https://raw.githubusercontent.com/pbiering/ipv6calc/master/ChangeLog" target="_top">ChangeLog@GitHub</a> for now</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1446"></a>2001</h3></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p>Start of development</p>
</li></ul></div>
</div>
</div>
</div></body></html>